<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>python-cheatsheet-4</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h2 id="contents">Contents</h2>
<p><strong>   </strong> <strong>1. Collections:</strong> <strong> </strong> <strong><a href="#list"><code>List</code></a></strong>__,<strong> <strong><a href="#dictionary"><code>Dictionary</code></a></strong></strong>,<strong> <strong><a href="#set"><code>Set</code></a></strong></strong>,<strong> <strong><a href="#tuple"><code>Tuple</code></a></strong></strong>,<strong> <strong><a href="#range"><code>Range</code></a></strong></strong>,<strong> <strong><a href="#enumerate"><code>Enumerate</code></a></strong></strong>,<strong> <strong><a href="#iterator"><code>Iterator</code></a></strong></strong>,<strong> <strong><a href="#generator"><code>Generator</code></a></strong></strong>.<strong><br />
<strong>   </strong> <strong>2. Types:</strong> <strong>          </strong> <strong><a href="#type"><code>Type</code></a></strong></strong>,<strong> <strong><a href="#string"><code>String</code></a></strong></strong>,<strong> <strong><a href="#regex"><code>Regular_Exp</code></a></strong></strong>,<strong> <strong><a href="#format"><code>Format</code></a></strong></strong>,<strong> <strong><a href="#numbers"><code>Numbers</code></a></strong></strong>,<strong> <strong><a href="#combinatorics"><code>Combinatorics</code></a></strong></strong>,<strong> <strong><a href="#datetime"><code>Datetime</code></a></strong></strong>.<strong><br />
<strong>   </strong> <strong>3. Syntax:</strong> <strong>         </strong> <strong><a href="#arguments"><code>Args</code></a></strong></strong>,<strong> <strong><a href="#inline"><code>Inline</code></a></strong></strong>,<strong> <strong><a href="#closure"><code>Closure</code></a></strong></strong>,<strong> <strong><a href="#decorator"><code>Decorator</code></a></strong></strong>,<strong> <strong><a href="#class"><code>Class</code></a></strong></strong>,<strong> <strong><a href="#duck-types"><code>Duck_Type</code></a></strong></strong>,<strong> <strong><a href="#enum"><code>Enum</code></a></strong></strong>,<strong> <strong><a href="#exceptions"><code>Exception</code></a></strong></strong>.<strong><br />
<strong>   </strong> <strong>4. System:</strong> <strong>        </strong> <strong><a href="#exit"><code>Exit</code></a></strong></strong>,<strong> <strong><a href="#print"><code>Print</code></a></strong></strong>,<strong> <strong><a href="#input"><code>Input</code></a></strong></strong>,<strong> <strong><a href="#command-line-arguments"><code>Command_Line_Arguments</code></a></strong></strong>,<strong> <strong><a href="#open"><code>Open</code></a></strong></strong>,<strong> <strong><a href="#path"><code>Path</code></a></strong></strong>,<strong> <strong><a href="#oscommands"><code>OS_Commands</code></a></strong></strong>.<strong><br />
<strong>   </strong> <strong>5. Data:</strong> <strong>             </strong> <strong><a href="#json"><code>JSON</code></a></strong></strong>,<strong> <strong><a href="#pickle"><code>Pickle</code></a></strong></strong>,<strong> <strong><a href="#csv"><code>CSV</code></a></strong></strong>,<strong> <strong><a href="#sqlite"><code>SQLite</code></a></strong></strong>,<strong> <strong><a href="#bytes"><code>Bytes</code></a></strong></strong>,<strong> <strong><a href="#struct"><code>Struct</code></a></strong></strong>,<strong> <strong><a href="#array"><code>Array</code></a></strong></strong>,<strong> <strong><a href="#memory-view"><code>Memory_View</code></a></strong></strong>,<strong> <strong><a href="#deque"><code>Deque</code></a></strong></strong>.<strong><br />
<strong>   </strong> <strong>6. Advanced:</strong> <strong>   </strong> <strong><a href="#threading"><code>Threading</code></a></strong></strong>,<strong> <strong><a href="#operator"><code>Operator</code></a></strong></strong>,<strong> <strong><a href="#introspection"><code>Introspection</code></a></strong></strong>,<strong> <strong><a href="#metaprograming"><code>Metaprograming</code></a></strong></strong>,<strong> <strong><a href="#eval"><code>Eval</code></a></strong></strong>,<strong> <strong><a href="#coroutines"><code>Coroutines</code></a></strong></strong>.<strong><br />
<strong>   </strong> <strong>7. Libraries:</strong> <strong>      </strong> <strong><a href="#progress-bar"><code>Progress_Bar</code></a></strong></strong>,<strong> <strong><a href="#plot"><code>Plot</code></a></strong></strong>,<strong> <strong><a href="#table"><code>Table</code></a></strong></strong>,<strong> <strong><a href="#curses"><code>Curses</code></a></strong></strong>,<strong> <strong><a href="#logging"><code>Logging</code></a></strong></strong>,<strong> <strong><a href="#scraping"><code>Scraping</code></a></strong></strong>,<strong> <strong><a href="#web"><code>Web</code></a></strong></strong>,<strong> <strong><a href="#profiling"><code>Profile</code></a></strong></strong>,<strong><br />
<strong>                                 </strong> <strong><a href="#numpy"><code>NumPy</code></a></strong></strong>,<strong> <strong><a href="#image"><code>Image</code></a></strong></strong>,<strong> <strong><a href="#audio"><code>Audio</code></a></strong></strong>,<strong> <strong><a href="#pygame"><code>Games</code></a></strong></strong>,<strong> <strong><a href="#pandas"><code>Data</code></a></strong></strong>,<strong> <strong><a href="#cython"><code>Cython</code></a></strong></strong>.__</p>
<h2 id="main">Main</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" title="1"><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:     <span class="co"># Runs main() if file wasn&#39;t imported.</span></a>
<a class="sourceLine" id="cb1-2" title="2">    main()</a></code></pre></div>
<h2 id="list">List</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb2-1" title="1"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>[from_inclusive : to_exclusive : ±step_size]</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb3-1" title="1"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>.append(<span class="op">&lt;</span>el<span class="op">&gt;</span>)            <span class="co"># Or: &lt;list&gt; += [&lt;el&gt;]</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>.extend(<span class="op">&lt;</span>collection<span class="op">&gt;</span>)    <span class="co"># Or: &lt;list&gt; += &lt;collection&gt;</span></a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb4-1" title="1"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>.sort()</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>.reverse()</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">sorted</span>(<span class="op">&lt;</span>collection<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">reversed</span>(<span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb5-1" title="1">sum_of_elements  <span class="op">=</span> <span class="bu">sum</span>(<span class="op">&lt;</span>collection<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb5-2" title="2">elementwise_sum  <span class="op">=</span> [<span class="bu">sum</span>(pair) <span class="cf">for</span> pair <span class="kw">in</span> <span class="bu">zip</span>(list_a, list_b)]</a>
<a class="sourceLine" id="cb5-3" title="3">sorted_by_second <span class="op">=</span> <span class="bu">sorted</span>(<span class="op">&lt;</span>collection<span class="op">&gt;</span>, key<span class="op">=</span><span class="kw">lambda</span> el: el[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb5-4" title="4">sorted_by_both   <span class="op">=</span> <span class="bu">sorted</span>(<span class="op">&lt;</span>collection<span class="op">&gt;</span>, key<span class="op">=</span><span class="kw">lambda</span> el: (el[<span class="dv">1</span>], el[<span class="dv">0</span>]))</a>
<a class="sourceLine" id="cb5-5" title="5">flatter_list     <span class="op">=</span> <span class="bu">list</span>(itertools.chain.from_iterable(<span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>))</a>
<a class="sourceLine" id="cb5-6" title="6">product_of_elems <span class="op">=</span> functools.<span class="bu">reduce</span>(<span class="kw">lambda</span> out, el: out <span class="op">*</span> el, <span class="op">&lt;</span>collection<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb5-7" title="7">list_of_chars    <span class="op">=</span> <span class="bu">list</span>(<span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>)</a></code></pre></div>
<ul>
<li><strong>Module <a href="#operator">operator</a> provides functions itemgetter() and mul() that offer the same functionality as <a href="#lambda">lambda</a> expressions above.</strong></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb6-1" title="1"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>.count(<span class="op">&lt;</span>el<span class="op">&gt;</span>)     <span class="co"># Returns number of occurrences. Also works on strings.</span></a>
<a class="sourceLine" id="cb6-2" title="2">index <span class="op">=</span> <span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>.index(<span class="op">&lt;</span>el<span class="op">&gt;</span>)     <span class="co"># Returns index of first occurrence or raises ValueError.</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>.insert(index, <span class="op">&lt;</span>el<span class="op">&gt;</span>)     <span class="co"># Inserts item at index and moves the rest to the right.</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="op">&lt;</span>el<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>.pop([index])     <span class="co"># Removes and returns item at index or from the end.</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>.remove(<span class="op">&lt;</span>el<span class="op">&gt;</span>)            <span class="co"># Removes first occurrence of item or raises ValueError.</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>.clear()                 <span class="co"># Removes all items. Also works on dictionary and set.</span></a></code></pre></div>
<h2 id="dictionary">Dictionary</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb7-1" title="1"><span class="op">&lt;</span>view<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span>.keys()                          <span class="co"># Coll. of keys that reflects changes.</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="op">&lt;</span>view<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span>.values()                        <span class="co"># Coll. of values that reflects changes.</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="op">&lt;</span>view<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span>.items()                         <span class="co"># Coll. of key-value tuples that reflects chgs.</span></a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb8-1" title="1">value  <span class="op">=</span> <span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span>.get(key, default<span class="op">=</span><span class="va">None</span>)          <span class="co"># Returns default if key is missing.</span></a>
<a class="sourceLine" id="cb8-2" title="2">value  <span class="op">=</span> <span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span>.setdefault(key, default<span class="op">=</span><span class="va">None</span>)   <span class="co"># Returns and writes default if key is missing.</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span> <span class="op">=</span> collections.defaultdict(<span class="op">&lt;</span><span class="bu">type</span><span class="op">&gt;</span>)        <span class="co"># Creates a dict with default value of type.</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span> <span class="op">=</span> collections.defaultdict(<span class="kw">lambda</span>: <span class="dv">1</span>)     <span class="co"># Creates a dict with default value 1.</span></a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb9-1" title="1"><span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">dict</span>(<span class="op">&lt;</span>collection<span class="op">&gt;</span>)                     <span class="co"># Creates a dict from coll. of key-value pairs.</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(keys, values))                <span class="co"># Creates a dict from two collections.</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">dict</span>.fromkeys(keys [, value])          <span class="co"># Creates a dict from collection of keys.</span></a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb10-1" title="1"><span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span>.update(<span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span>)                           <span class="co"># Adds items. Replaces ones with matching keys.</span></a>
<a class="sourceLine" id="cb10-2" title="2">value <span class="op">=</span> <span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span>.pop(key)                         <span class="co"># Removes item or raises KeyError.</span></a>
<a class="sourceLine" id="cb10-3" title="3">{k <span class="cf">for</span> k, v <span class="kw">in</span> <span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span>.items() <span class="cf">if</span> v <span class="op">==</span> value}    <span class="co"># Returns set of keys that point to the value.</span></a>
<a class="sourceLine" id="cb10-4" title="4">{k: v <span class="cf">for</span> k, v <span class="kw">in</span> <span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span>.items() <span class="cf">if</span> k <span class="kw">in</span> keys}  <span class="co"># Returns a dictionary, filtered by keys.</span></a></code></pre></div>
<h3 id="counter">Counter</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb11-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> collections <span class="im">import</span> Counter</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="op">&gt;&gt;&gt;</span> colors <span class="op">=</span> [<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;red&#39;</span>, <span class="st">&#39;red&#39;</span>]</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="op">&gt;&gt;&gt;</span> counter <span class="op">=</span> Counter(colors)</a>
<a class="sourceLine" id="cb11-4" title="4"><span class="op">&gt;&gt;&gt;</span> counter[<span class="st">&#39;yellow&#39;</span>] <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb11-5" title="5">Counter({<span class="st">&#39;blue&#39;</span>: <span class="dv">3</span>, <span class="st">&#39;red&#39;</span>: <span class="dv">2</span>, <span class="st">&#39;yellow&#39;</span>: <span class="dv">1</span>})</a>
<a class="sourceLine" id="cb11-6" title="6"><span class="op">&gt;&gt;&gt;</span> counter.most_common()[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb11-7" title="7">(<span class="st">&#39;blue&#39;</span>, <span class="dv">3</span>)</a></code></pre></div>
<h2 id="set">Set</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb12-1" title="1"><span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">set</span>()</a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb13-1" title="1"><span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span>.add(<span class="op">&lt;</span>el<span class="op">&gt;</span>)                                 <span class="co"># Or: &lt;set&gt; |= {&lt;el&gt;}</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span>.update(<span class="op">&lt;</span>collection<span class="op">&gt;</span>)                      <span class="co"># Or: &lt;set&gt; |= &lt;set&gt;</span></a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb14-1" title="1"><span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span>.union(<span class="op">&lt;</span>coll.<span class="op">&gt;</span>)                   <span class="co"># Or: &lt;set&gt; | &lt;set&gt;</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span>.intersection(<span class="op">&lt;</span>coll.<span class="op">&gt;</span>)            <span class="co"># Or: &lt;set&gt; &amp; &lt;set&gt;</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span>.difference(<span class="op">&lt;</span>coll.<span class="op">&gt;</span>)              <span class="co"># Or: &lt;set&gt; - &lt;set&gt;</span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span>.symmetric_difference(<span class="op">&lt;</span>coll.<span class="op">&gt;</span>)    <span class="co"># Or: &lt;set&gt; ^ &lt;set&gt;</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="op">&lt;</span><span class="bu">bool</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span>.issubset(<span class="op">&lt;</span>coll.<span class="op">&gt;</span>)                <span class="co"># Or: &lt;set&gt; &lt;= &lt;set&gt;</span></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="op">&lt;</span><span class="bu">bool</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span>.issuperset(<span class="op">&lt;</span>coll.<span class="op">&gt;</span>)              <span class="co"># Or: &lt;set&gt; &gt;= &lt;set&gt;</span></a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb15-1" title="1"><span class="op">&lt;</span>el<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span>.pop()                              <span class="co"># Raises KeyError if empty.</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span>.remove(<span class="op">&lt;</span>el<span class="op">&gt;</span>)                              <span class="co"># Raises KeyError if missing.</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span>.discard(<span class="op">&lt;</span>el<span class="op">&gt;</span>)                             <span class="co"># Doesn&#39;t raise an error.</span></a></code></pre></div>
<h3 id="frozen-set">Frozen Set</h3>
<ul>
<li><strong>Is immutable and hashable.</strong></li>
<li><strong>That means it can be used as a key in a dictionary or as an element in a set.</strong></li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb16-1" title="1"><span class="op">&lt;</span><span class="bu">frozenset</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">frozenset</span>(<span class="op">&lt;</span>collection<span class="op">&gt;</span>)</a></code></pre></div>
<h2 id="tuple">Tuple</h2>
<p><strong>Tuple is an immutable and hashable list.</strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb17-1" title="1"><span class="op">&lt;</span><span class="bu">tuple</span><span class="op">&gt;</span> <span class="op">=</span> ()</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="op">&lt;</span><span class="bu">tuple</span><span class="op">&gt;</span> <span class="op">=</span> (<span class="op">&lt;</span>el<span class="op">&gt;</span>, )</a>
<a class="sourceLine" id="cb17-3" title="3"><span class="op">&lt;</span><span class="bu">tuple</span><span class="op">&gt;</span> <span class="op">=</span> (<span class="op">&lt;</span>el_1<span class="op">&gt;</span>, <span class="op">&lt;</span>el_2<span class="op">&gt;</span> [, ...])</a></code></pre></div>
<h3 id="named-tuple">Named Tuple</h3>
<p><strong>Tuple’s subclass with named elements.</strong></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb18-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> collections <span class="im">import</span> namedtuple</a>
<a class="sourceLine" id="cb18-2" title="2"><span class="op">&gt;&gt;&gt;</span> Point <span class="op">=</span> namedtuple(<span class="st">&#39;Point&#39;</span>, <span class="st">&#39;x y&#39;</span>)</a>
<a class="sourceLine" id="cb18-3" title="3"><span class="op">&gt;&gt;&gt;</span> p <span class="op">=</span> Point(<span class="dv">1</span>, y<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-4" title="4">Point(x<span class="op">=</span><span class="dv">1</span>, y<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-5" title="5"><span class="op">&gt;&gt;&gt;</span> p[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb18-6" title="6"><span class="dv">1</span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="op">&gt;&gt;&gt;</span> p.x</a>
<a class="sourceLine" id="cb18-8" title="8"><span class="dv">1</span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="op">&gt;&gt;&gt;</span> <span class="bu">getattr</span>(p, <span class="st">&#39;y&#39;</span>)</a>
<a class="sourceLine" id="cb18-10" title="10"><span class="dv">2</span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="op">&gt;&gt;&gt;</span> p._fields  <span class="co"># Or: Point._fields</span></a>
<a class="sourceLine" id="cb18-12" title="12">(<span class="st">&#39;x&#39;</span>, <span class="st">&#39;y&#39;</span>)</a></code></pre></div>
<h2 id="range">Range</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb19-1" title="1"><span class="op">&lt;</span><span class="bu">range</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">range</span>(to_exclusive)</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="op">&lt;</span><span class="bu">range</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">range</span>(from_inclusive, to_exclusive)</a>
<a class="sourceLine" id="cb19-3" title="3"><span class="op">&lt;</span><span class="bu">range</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">range</span>(from_inclusive, to_exclusive, ±step_size)</a></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb20-1" title="1">from_inclusive <span class="op">=</span> <span class="op">&lt;</span><span class="bu">range</span><span class="op">&gt;</span>.start</a>
<a class="sourceLine" id="cb20-2" title="2">to_exclusive   <span class="op">=</span> <span class="op">&lt;</span><span class="bu">range</span><span class="op">&gt;</span>.stop</a></code></pre></div>
<h2 id="enumerate">Enumerate</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb21-1" title="1"><span class="cf">for</span> i, el <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="op">&lt;</span>collection<span class="op">&gt;</span> [, i_start]):</a>
<a class="sourceLine" id="cb21-2" title="2">    ...</a></code></pre></div>
<h2 id="iterator">Iterator</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb22-1" title="1"><span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">iter</span>(<span class="op">&lt;</span>collection<span class="op">&gt;</span>)                 <span class="co"># `iter(&lt;iter&gt;)` returns unmodified iterator.</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">iter</span>(<span class="op">&lt;</span>function<span class="op">&gt;</span>, to_exclusive)     <span class="co"># A sequence of return values until &#39;to_exclusive&#39;.</span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="op">&lt;</span>el<span class="op">&gt;</span>   <span class="op">=</span> <span class="bu">next</span>(<span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span> [, default])           <span class="co"># Raises StopIteration or returns &#39;default&#39; on end.</span></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">list</span>(<span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span>)                       <span class="co"># Returns a list of iterator&#39;s remaining elements.</span></a></code></pre></div>
<h3 id="itertools">Itertools</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb23-1" title="1"><span class="im">from</span> itertools <span class="im">import</span> count, repeat, cycle, chain, islice</a></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb24-1" title="1"><span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span> <span class="op">=</span> count(start<span class="op">=</span><span class="dv">0</span>, step<span class="op">=</span><span class="dv">1</span>)             <span class="co"># Returns updated value endlessly. Accepts floats.</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span> <span class="op">=</span> repeat(<span class="op">&lt;</span>el<span class="op">&gt;</span> [, times])             <span class="co"># Returns element endlessly or &#39;times&#39; times.</span></a>
<a class="sourceLine" id="cb24-3" title="3"><span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span> <span class="op">=</span> cycle(<span class="op">&lt;</span>collection<span class="op">&gt;</span>)                <span class="co"># Repeats the sequence endlessly.</span></a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb25-1" title="1"><span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span> <span class="op">=</span> chain(<span class="op">&lt;</span>coll_1<span class="op">&gt;</span>, <span class="op">&lt;</span>coll_2<span class="op">&gt;</span> [, ...])  <span class="co"># Empties collections in order.</span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span> <span class="op">=</span> chain.from_iterable(<span class="op">&lt;</span>collection<span class="op">&gt;</span>)  <span class="co"># Empties collections inside a collection in order.</span></a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb26-1" title="1"><span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span> <span class="op">=</span> islice(<span class="op">&lt;</span>coll<span class="op">&gt;</span>, to_exclusive)       <span class="co"># Only returns first &#39;to_exclusive&#39; elements.</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span> <span class="op">=</span> islice(<span class="op">&lt;</span>coll<span class="op">&gt;</span>, from_inclusive, …)  <span class="co"># `to_exclusive, step_size`.</span></a></code></pre></div>
<h2 id="generator">Generator</h2>
<ul>
<li><strong>Any function that contains a yield statement returns a generator.</strong></li>
<li><strong>Generators and iterators are interchangeable.</strong></li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">def</span> count(start, step):</a>
<a class="sourceLine" id="cb27-2" title="2">    <span class="cf">while</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb27-3" title="3">        <span class="cf">yield</span> start</a>
<a class="sourceLine" id="cb27-4" title="4">        start <span class="op">+=</span> step</a></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb28-1" title="1"><span class="op">&gt;&gt;&gt;</span> counter <span class="op">=</span> count(<span class="dv">10</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb28-2" title="2"><span class="op">&gt;&gt;&gt;</span> <span class="bu">next</span>(counter), <span class="bu">next</span>(counter), <span class="bu">next</span>(counter)</a>
<a class="sourceLine" id="cb28-3" title="3">(<span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">14</span>)</a></code></pre></div>
<h2 id="type">Type</h2>
<ul>
<li><strong>Everything is an object.</strong></li>
<li><strong>Every object has a type.</strong></li>
<li><strong>Type and class are synonymous.</strong></li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb29-1" title="1"><span class="op">&lt;</span><span class="bu">type</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">type</span>(<span class="op">&lt;</span>el<span class="op">&gt;</span>)                          <span class="co"># Or: &lt;el&gt;.__class__</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="op">&lt;</span><span class="bu">bool</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">isinstance</span>(<span class="op">&lt;</span>el<span class="op">&gt;</span>, <span class="op">&lt;</span><span class="bu">type</span><span class="op">&gt;</span>)            <span class="co"># Or: issubclass(type(&lt;el&gt;), &lt;type&gt;)</span></a></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb30-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="bu">type</span>(<span class="st">&#39;a&#39;</span>), <span class="st">&#39;a&#39;</span>.__class__, <span class="bu">str</span></a>
<a class="sourceLine" id="cb30-2" title="2">(<span class="op">&lt;</span><span class="kw">class</span> <span class="st">&#39;str&#39;</span><span class="op">&gt;</span>, <span class="op">&lt;</span><span class="kw">class</span> <span class="st">&#39;str&#39;</span><span class="op">&gt;</span>, <span class="op">&lt;</span><span class="kw">class</span> <span class="st">&#39;str&#39;</span><span class="op">&gt;</span>)</a></code></pre></div>
<h4 id="some-types-do-not-have-built-in-names-so-they-must-be-imported">Some types do not have built-in names, so they must be imported:</h4>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb31-1" title="1"><span class="im">from</span> types <span class="im">import</span> FunctionType, MethodType, LambdaType, GeneratorType</a></code></pre></div>
<h3 id="abstract-base-classes">Abstract Base Classes</h3>
<p><strong>Each abstract base class specifies a set of virtual subclasses. These classes are then recognized by isinstance() and issubclass() as subclasses of the ABC, although they are really not.</strong></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb32-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> collections.abc <span class="im">import</span> Sequence, Collection, Iterable</a>
<a class="sourceLine" id="cb32-2" title="2"><span class="op">&gt;&gt;&gt;</span> <span class="bu">isinstance</span>([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], Iterable)</a>
<a class="sourceLine" id="cb32-3" title="3"><span class="va">True</span></a></code></pre></div>
<pre class="text"><code>+------------------+------------+------------+------------+
|                  |  Sequence  | Collection |  Iterable  |
+------------------+------------+------------+------------+
| list, range, str |    yes     |    yes     |    yes     |
| dict, set        |            |    yes     |    yes     |
| iter             |            |            |    yes     |
+------------------+------------+------------+------------+</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb34-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> numbers <span class="im">import</span> Integral, Rational, Real, Complex, Number</a>
<a class="sourceLine" id="cb34-2" title="2"><span class="op">&gt;&gt;&gt;</span> <span class="bu">isinstance</span>(<span class="dv">123</span>, Number)</a>
<a class="sourceLine" id="cb34-3" title="3"><span class="va">True</span></a></code></pre></div>
<pre class="text"><code>+--------------------+----------+----------+----------+----------+----------+
|                    | Integral | Rational |   Real   | Complex  |  Number  |
+--------------------+----------+----------+----------+----------+----------+
| int                |   yes    |   yes    |   yes    |   yes    |   yes    |
| fractions.Fraction |          |   yes    |   yes    |   yes    |   yes    |
| float              |          |          |   yes    |   yes    |   yes    |
| complex            |          |          |          |   yes    |   yes    |
| decimal.Decimal    |          |          |          |          |   yes    |
+--------------------+----------+----------+----------+----------+----------+</code></pre>
<h2 id="string">String</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb36-1" title="1"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>.strip()                       <span class="co"># Strips all whitespace characters from both ends.</span></a>
<a class="sourceLine" id="cb36-2" title="2"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>.strip(<span class="st">&#39;&lt;chars&gt;&#39;</span>)              <span class="co"># Strips all passed characters from both ends.</span></a></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb37-1" title="1"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>.split()                       <span class="co"># Splits on one or more whitespace characters.</span></a>
<a class="sourceLine" id="cb37-2" title="2"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>.split(sep<span class="op">=</span><span class="va">None</span>, maxsplit<span class="op">=-</span><span class="dv">1</span>)  <span class="co"># Splits on &#39;sep&#39; str at most &#39;maxsplit&#39; times.</span></a>
<a class="sourceLine" id="cb37-3" title="3"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>.splitlines(keepends<span class="op">=</span><span class="va">False</span>)    <span class="co"># Splits on \n,\r,\r\n. Keeps them if &#39;keepends&#39;.</span></a>
<a class="sourceLine" id="cb37-4" title="4"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>.join(<span class="op">&lt;</span>coll_of_strings<span class="op">&gt;</span>)       <span class="co"># Joins elements using string as separator.</span></a></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb38-1" title="1"><span class="op">&lt;</span><span class="bu">bool</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>sub_str<span class="op">&gt;</span> <span class="kw">in</span> <span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>                  <span class="co"># Checks if string contains a substring.</span></a>
<a class="sourceLine" id="cb38-2" title="2"><span class="op">&lt;</span><span class="bu">bool</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>.startswith(<span class="op">&lt;</span>sub_str<span class="op">&gt;</span>)         <span class="co"># Pass tuple of strings for multiple options.</span></a>
<a class="sourceLine" id="cb38-3" title="3"><span class="op">&lt;</span><span class="bu">bool</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>.endswith(<span class="op">&lt;</span>sub_str<span class="op">&gt;</span>)           <span class="co"># Pass tuple of strings for multiple options.</span></a>
<a class="sourceLine" id="cb38-4" title="4"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>.find(<span class="op">&lt;</span>sub_str<span class="op">&gt;</span>)               <span class="co"># Returns start index of first match or -1.</span></a>
<a class="sourceLine" id="cb38-5" title="5"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>.index(<span class="op">&lt;</span>sub_str<span class="op">&gt;</span>)              <span class="co"># Same but raises ValueError if missing.</span></a></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb39-1" title="1"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>.replace(old, new [, count])   <span class="co"># Replaces &#39;old&#39; with &#39;new&#39; at most &#39;count&#39; times.</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>.translate(<span class="op">&lt;</span>table<span class="op">&gt;</span>)            <span class="co"># Use `str.maketrans(&lt;dict&gt;)` to generate table.</span></a></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb40-1" title="1"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="bu">chr</span>(<span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>)                          <span class="co"># Converts int to Unicode char.</span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="bu">ord</span>(<span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>)                          <span class="co"># Converts Unicode char to int.</span></a></code></pre></div>
<ul>
<li><strong>Also: <code>'lstrip()'</code>, <code>'rstrip()'</code>.</strong></li>
<li><strong>Also: <code>'lower()'</code>, <code>'upper()'</code>, <code>'capitalize()'</code> and <code>'title()'</code>.</strong></li>
</ul>
<h3 id="property-methods">Property Methods</h3>
<pre class="text"><code>+---------------+----------+----------+----------+----------+----------+
|               | [ !#$%…] | [a-zA-Z] |  [¼½¾]   |  [²³¹]   |  [0-9]   |
+---------------+----------+----------+----------+----------+----------+
| isprintable() |   yes    |   yes    |   yes    |   yes    |   yes    |
| isalnum()     |          |   yes    |   yes    |   yes    |   yes    |
| isnumeric()   |          |          |   yes    |   yes    |   yes    |
| isdigit()     |          |          |          |   yes    |   yes    |
| isdecimal()   |          |          |          |          |   yes    |
+---------------+----------+----------+----------+----------+----------+</code></pre>
<ul>
<li><strong>Also: <code>'isspace()'</code> checks for <code>'[ \t\n\r\f\v…]'</code>.</strong></li>
</ul>
<h2 id="regex">Regex</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb42-1" title="1"><span class="im">import</span> re</a>
<a class="sourceLine" id="cb42-2" title="2"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>   <span class="op">=</span> re.sub(<span class="op">&lt;</span>regex<span class="op">&gt;</span>, new, text, count<span class="op">=</span><span class="dv">0</span>)  <span class="co"># Substitutes all occurrences with &#39;new&#39;.</span></a>
<a class="sourceLine" id="cb42-3" title="3"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>  <span class="op">=</span> re.findall(<span class="op">&lt;</span>regex<span class="op">&gt;</span>, text)            <span class="co"># Returns all occurrences as strings.</span></a>
<a class="sourceLine" id="cb42-4" title="4"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>  <span class="op">=</span> re.split(<span class="op">&lt;</span>regex<span class="op">&gt;</span>, text, maxsplit<span class="op">=</span><span class="dv">0</span>)  <span class="co"># Use brackets in regex to include the matches.</span></a>
<a class="sourceLine" id="cb42-5" title="5"><span class="op">&lt;</span>Match<span class="op">&gt;</span> <span class="op">=</span> re.search(<span class="op">&lt;</span>regex<span class="op">&gt;</span>, text)             <span class="co"># Searches for first occurrence of the pattern.</span></a>
<a class="sourceLine" id="cb42-6" title="6"><span class="op">&lt;</span>Match<span class="op">&gt;</span> <span class="op">=</span> re.match(<span class="op">&lt;</span>regex<span class="op">&gt;</span>, text)              <span class="co"># Searches only at the beginning of the text.</span></a>
<a class="sourceLine" id="cb42-7" title="7"><span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span>  <span class="op">=</span> re.finditer(<span class="op">&lt;</span>regex<span class="op">&gt;</span>, text)           <span class="co"># Returns all occurrences as match objects.</span></a></code></pre></div>
<ul>
<li><strong>Search() and match() return None if they can’t find a match.</strong></li>
<li><strong>Argument <code>'flags=re.IGNORECASE'</code> can be used with all functions.</strong></li>
<li><strong>Argument <code>'flags=re.MULTILINE'</code> makes <code>'^'</code> and <code>'$'</code> match the start/end of each line.</strong></li>
<li><strong>Argument <code>'flags=re.DOTALL'</code> makes dot also accept the <code>'\n'</code>.</strong></li>
<li><strong>Use <code>r'\1'</code> or <code>'\\1'</code> for backreference.</strong></li>
<li><strong>Add <code>'?'</code> after an operator to make it non-greedy.</strong></li>
</ul>
<h3 id="match-object">Match Object</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb43-1" title="1"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>   <span class="op">=</span> <span class="op">&lt;</span>Match<span class="op">&gt;</span>.group()                      <span class="co"># Returns the whole match. Also group(0).</span></a>
<a class="sourceLine" id="cb43-2" title="2"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>   <span class="op">=</span> <span class="op">&lt;</span>Match<span class="op">&gt;</span>.group(<span class="dv">1</span>)                     <span class="co"># Returns part in the first bracket.</span></a>
<a class="sourceLine" id="cb43-3" title="3"><span class="op">&lt;</span><span class="bu">tuple</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Match<span class="op">&gt;</span>.groups()                     <span class="co"># Returns all bracketed parts.</span></a>
<a class="sourceLine" id="cb43-4" title="4"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>   <span class="op">=</span> <span class="op">&lt;</span>Match<span class="op">&gt;</span>.start()                      <span class="co"># Returns start index of the match.</span></a>
<a class="sourceLine" id="cb43-5" title="5"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>   <span class="op">=</span> <span class="op">&lt;</span>Match<span class="op">&gt;</span>.end()                        <span class="co"># Returns exclusive end index of the match.</span></a></code></pre></div>
<h3 id="special-sequences">Special Sequences</h3>
<ul>
<li><strong>By default digits, alphanumerics and whitespaces from all alphabets are matched, unless <code>'flags=re.ASCII'</code> argument is used.</strong></li>
<li><strong>Use a capital letter for negation.</strong></li>
</ul>
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb44-1" title="1"><span class="co">&#39;\d&#39;</span> <span class="op">==</span> <span class="st">&#39;[0-9]&#39;</span>                                <span class="co"># Matches any digit.</span></a>
<a class="sourceLine" id="cb44-2" title="2"><span class="co">&#39;\w&#39;</span> <span class="op">==</span> <span class="st">&#39;[a-zA-Z0-9_]&#39;</span>                         <span class="co"># Matches any alphanumeric.</span></a>
<a class="sourceLine" id="cb44-3" title="3"><span class="co">&#39;\s&#39;</span> <span class="op">==</span> <span class="st">&#39;[ </span><span class="ch">\t\n\r\f\v</span><span class="st">]&#39;</span>                        <span class="co"># Matches any whitespace.</span></a></code></pre></div>
<h2 id="format">Format</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb45-1" title="1"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span> <span class="op">=</span> <span class="ss">f&#39;</span><span class="sc">{</span><span class="op">&lt;</span>el_1<span class="op">&gt;</span><span class="sc">}</span><span class="ss">, </span><span class="sc">{</span><span class="op">&lt;</span>el_2<span class="op">&gt;</span><span class="sc">}</span><span class="ss">&#39;</span></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span> <span class="op">=</span> <span class="st">&#39;</span><span class="sc">{}</span><span class="st">, </span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(<span class="op">&lt;</span>el_1<span class="op">&gt;</span>, <span class="op">&lt;</span>el_2<span class="op">&gt;</span>)</a></code></pre></div>
<h3 id="attributes">Attributes</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb46-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> collections <span class="im">import</span> namedtuple</a>
<a class="sourceLine" id="cb46-2" title="2"><span class="op">&gt;&gt;&gt;</span> Person <span class="op">=</span> namedtuple(<span class="st">&#39;Person&#39;</span>, <span class="st">&#39;name height&#39;</span>)</a>
<a class="sourceLine" id="cb46-3" title="3"><span class="op">&gt;&gt;&gt;</span> person <span class="op">=</span> Person(<span class="st">&#39;Jean-Luc&#39;</span>, <span class="dv">187</span>)</a>
<a class="sourceLine" id="cb46-4" title="4"><span class="op">&gt;&gt;&gt;</span> <span class="ss">f&#39;</span><span class="sc">{</span>person<span class="sc">.</span>height<span class="sc">}</span><span class="ss">&#39;</span></a>
<a class="sourceLine" id="cb46-5" title="5"><span class="co">&#39;187&#39;</span></a>
<a class="sourceLine" id="cb46-6" title="6"><span class="op">&gt;&gt;&gt;</span> <span class="st">&#39;</span><span class="sc">{p.height}</span><span class="st">&#39;</span>.<span class="bu">format</span>(p<span class="op">=</span>person)</a>
<a class="sourceLine" id="cb46-7" title="7"><span class="co">&#39;187&#39;</span></a></code></pre></div>
<h3 id="general-options">General Options</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb47-1" title="1">{<span class="op">&lt;</span>el<span class="op">&gt;</span>:<span class="op">&lt;</span><span class="dv">10</span>}                                     <span class="co"># &#39;&lt;el&gt;      &#39;</span></a>
<a class="sourceLine" id="cb47-2" title="2">{<span class="op">&lt;</span>el<span class="op">&gt;</span>:<span class="op">^</span><span class="dv">10</span>}                                     <span class="co"># &#39;   &lt;el&gt;   &#39;</span></a>
<a class="sourceLine" id="cb47-3" title="3">{<span class="op">&lt;</span>el<span class="op">&gt;</span>:<span class="op">&gt;</span><span class="dv">10</span>}                                     <span class="co"># &#39;      &lt;el&gt;&#39;</span></a>
<a class="sourceLine" id="cb47-4" title="4">{<span class="op">&lt;</span>el<span class="op">&gt;</span>:.<span class="op">&lt;</span><span class="dv">10</span>}                                    <span class="co"># &#39;&lt;el&gt;......&#39;</span></a>
<a class="sourceLine" id="cb47-5" title="5">{<span class="op">&lt;</span>el<span class="op">&gt;</span>:<span class="op">&lt;</span><span class="dv">0</span>}                                      <span class="co"># &#39;&lt;el&gt;&#39;</span></a></code></pre></div>
<h3 id="strings">Strings</h3>
<p><strong><code>'!r'</code> calls object’s <a href="#class">repr()</a> method, instead of <a href="#class">str()</a>, to get a string.</strong></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb48-1" title="1">{<span class="st">&#39;abcde&#39;</span><span class="op">!</span>r:<span class="dv">10</span>}                                 <span class="co"># &quot;&#39;abcde&#39;   &quot;</span></a>
<a class="sourceLine" id="cb48-2" title="2">{<span class="st">&#39;abcde&#39;</span>:<span class="fl">10.3</span>}                                 <span class="co"># &#39;abc       &#39;</span></a>
<a class="sourceLine" id="cb48-3" title="3">{<span class="st">&#39;abcde&#39;</span>:.<span class="dv">3</span>}                                   <span class="co"># &#39;abc&#39;</span></a></code></pre></div>
<h3 id="numbers">Numbers</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb49-1" title="1">{ <span class="dv">123456</span>:<span class="dv">10</span>,}                                  <span class="co"># &#39;   123,456&#39;</span></a>
<a class="sourceLine" id="cb49-2" title="2">{ <span class="dv">123456</span>:<span class="dv">10</span>_}                                  <span class="co"># &#39;   123_456&#39;</span></a>
<a class="sourceLine" id="cb49-3" title="3">{ <span class="dv">123456</span>:<span class="op">+</span><span class="dv">10</span>}                                  <span class="co"># &#39;   +123456&#39;</span></a>
<a class="sourceLine" id="cb49-4" title="4">{<span class="op">-</span><span class="dv">123456</span>:<span class="op">=</span><span class="dv">10</span>}                                  <span class="co"># &#39;-   123456&#39;</span></a>
<a class="sourceLine" id="cb49-5" title="5">{ <span class="dv">123456</span>: }                                    <span class="co"># &#39; 123456&#39;</span></a>
<a class="sourceLine" id="cb49-6" title="6">{<span class="op">-</span><span class="dv">123456</span>: }                                    <span class="co"># &#39;-123456&#39;</span></a></code></pre></div>
<h3 id="floats">Floats</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb50-1" title="1">{<span class="fl">1.23456</span>:<span class="fl">10.3</span>}                                 <span class="co"># &#39;      1.23&#39;</span></a>
<a class="sourceLine" id="cb50-2" title="2">{<span class="fl">1.23456</span>:<span class="fl">10.3</span>f}                                <span class="co"># &#39;     1.235&#39;</span></a>
<a class="sourceLine" id="cb50-3" title="3">{<span class="fl">1.23456</span>:<span class="fl">10.3</span>e}                                <span class="co"># &#39; 1.235e+00&#39;</span></a>
<a class="sourceLine" id="cb50-4" title="4">{<span class="fl">1.23456</span>:<span class="fl">10.3</span><span class="op">%</span>}                                <span class="co"># &#39;  123.456%&#39;</span></a></code></pre></div>
<h4 id="comparison-of-presentation-types">Comparison of presentation types:</h4>
<pre class="text"><code>+---------------+-----------------+-----------------+-----------------+-----------------+
|               |    {&lt;float&gt;}    |   {&lt;float&gt;:f}   |   {&lt;float&gt;:e}   |   {&lt;float&gt;:%}   |
+---------------+-----------------+-----------------+-----------------+-----------------+
|   0.000056789 |    &#39;5.6789e-05&#39; |     &#39;0.000057&#39;  |  &#39;5.678900e-05&#39; |     &#39;0.005679%&#39; |
|   0.00056789  |    &#39;0.00056789&#39; |     &#39;0.000568&#39;  |  &#39;5.678900e-04&#39; |     &#39;0.056789%&#39; |
|   0.0056789   |    &#39;0.0056789&#39;  |     &#39;0.005679&#39;  |  &#39;5.678900e-03&#39; |     &#39;0.567890%&#39; |
|   0.056789    |    &#39;0.056789&#39;   |     &#39;0.056789&#39;  |  &#39;5.678900e-02&#39; |     &#39;5.678900%&#39; |
|   0.56789     |    &#39;0.56789&#39;    |     &#39;0.567890&#39;  |  &#39;5.678900e-01&#39; |    &#39;56.789000%&#39; |
|   5.6789      |    &#39;5.6789&#39;     |     &#39;5.678900&#39;  |  &#39;5.678900e+00&#39; |   &#39;567.890000%&#39; |
|  56.789       |   &#39;56.789&#39;      |    &#39;56.789000&#39;  |  &#39;5.678900e+01&#39; |  &#39;5678.900000%&#39; |
| 567.89        |  &#39;567.89&#39;       |   &#39;567.890000&#39;  |  &#39;5.678900e+02&#39; | &#39;56789.000000%&#39; |
+---------------+-----------------+-----------------+-----------------+-----------------+</code></pre>
<pre class="text"><code>+---------------+-----------------+-----------------+-----------------+-----------------+
|               |   {&lt;float&gt;:.2}  |  {&lt;float&gt;:.2f}  |  {&lt;float&gt;:.2e}  |  {&lt;float&gt;:.2%}  |
+---------------+-----------------+-----------------+-----------------+-----------------+
|   0.000056789 |    &#39;5.7e-05&#39;    |       &#39;0.00&#39;    |    &#39;5.68e-05&#39;   |       &#39;0.01%&#39;   |
|   0.00056789  |    &#39;0.00057&#39;    |       &#39;0.00&#39;    |    &#39;5.68e-04&#39;   |       &#39;0.06%&#39;   |
|   0.0056789   |    &#39;0.0057&#39;     |       &#39;0.01&#39;    |    &#39;5.68e-03&#39;   |       &#39;0.57%&#39;   |
|   0.056789    |    &#39;0.057&#39;      |       &#39;0.06&#39;    |    &#39;5.68e-02&#39;   |       &#39;5.68%&#39;   |
|   0.56789     |    &#39;0.57&#39;       |       &#39;0.57&#39;    |    &#39;5.68e-01&#39;   |      &#39;56.79%&#39;   |
|   5.6789      |    &#39;5.7&#39;        |       &#39;5.68&#39;    |    &#39;5.68e+00&#39;   |     &#39;567.89%&#39;   |
|  56.789       |    &#39;5.7e+01&#39;    |      &#39;56.79&#39;    |    &#39;5.68e+01&#39;   |    &#39;5678.90%&#39;   |
| 567.89        |    &#39;5.7e+02&#39;    |     &#39;567.89&#39;    |    &#39;5.68e+02&#39;   |   &#39;56789.00%&#39;   |
+---------------+-----------------+-----------------+-----------------+-----------------+</code></pre>
<h3 id="ints">Ints</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb53-1" title="1">{<span class="dv">90</span>:c}                                   <span class="co"># &#39;Z&#39;</span></a>
<a class="sourceLine" id="cb53-2" title="2">{<span class="dv">90</span>:b}                                   <span class="co"># &#39;1011010&#39;</span></a>
<a class="sourceLine" id="cb53-3" title="3">{<span class="dv">90</span>:X}                                   <span class="co"># &#39;5A&#39;</span></a></code></pre></div>
<h2 id="numbers-1">Numbers</h2>
<h3 id="types">Types</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb54-1" title="1"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>      <span class="op">=</span> <span class="bu">int</span>(<span class="op">&lt;</span><span class="bu">float</span><span class="op">/</span><span class="bu">str</span><span class="op">/</span><span class="bu">bool</span><span class="op">&gt;</span>)       <span class="co"># Or: math.floor(&lt;float&gt;)</span></a>
<a class="sourceLine" id="cb54-2" title="2"><span class="op">&lt;</span><span class="bu">float</span><span class="op">&gt;</span>    <span class="op">=</span> <span class="bu">float</span>(<span class="op">&lt;</span><span class="bu">int</span><span class="op">/</span><span class="bu">str</span><span class="op">/</span><span class="bu">bool</span><span class="op">&gt;</span>)       <span class="co"># Or: &lt;real&gt;e±&lt;int&gt;</span></a>
<a class="sourceLine" id="cb54-3" title="3"><span class="op">&lt;</span><span class="bu">complex</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="bu">complex</span>(real<span class="op">=</span><span class="dv">0</span>, imag<span class="op">=</span><span class="dv">0</span>)     <span class="co"># Or: &lt;real&gt; ± &lt;real&gt;j</span></a>
<a class="sourceLine" id="cb54-4" title="4"><span class="op">&lt;</span>Fraction<span class="op">&gt;</span> <span class="op">=</span> fractions.Fraction(<span class="dv">0</span>, <span class="dv">1</span>)    <span class="co"># Or: Fraction(numerator=0, denominator=1)</span></a>
<a class="sourceLine" id="cb54-5" title="5"><span class="op">&lt;</span>Decimal<span class="op">&gt;</span>  <span class="op">=</span> decimal.Decimal(<span class="op">&lt;</span><span class="bu">str</span><span class="op">/</span><span class="bu">int</span><span class="op">&gt;</span>)  <span class="co"># Or: Decimal((sign, digits, exponent))</span></a></code></pre></div>
<ul>
<li><strong><code>'int(&lt;str&gt;)'</code> and <code>'float(&lt;str&gt;)'</code> raise ValueError on malformed strings.</strong></li>
<li><strong>Decimal numbers can be represented exactly, unlike floats where <code>'1.1 + 2.2 != 3.3'</code>.</strong></li>
<li><strong>Precision of decimal operations is set with: <code>'decimal.getcontext().prec = &lt;int&gt;'</code>.</strong></li>
</ul>
<h3 id="basic-functions">Basic Functions</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb55-1" title="1"><span class="op">&lt;</span>num<span class="op">&gt;</span> <span class="op">=</span> <span class="bu">pow</span>(<span class="op">&lt;</span>num<span class="op">&gt;</span>, <span class="op">&lt;</span>num<span class="op">&gt;</span>)                <span class="co"># Or: &lt;num&gt; ** &lt;num&gt;</span></a>
<a class="sourceLine" id="cb55-2" title="2"><span class="op">&lt;</span>num<span class="op">&gt;</span> <span class="op">=</span> <span class="bu">abs</span>(<span class="op">&lt;</span>num<span class="op">&gt;</span>)                       <span class="co"># &lt;float&gt; = abs(&lt;complex&gt;)</span></a>
<a class="sourceLine" id="cb55-3" title="3"><span class="op">&lt;</span>num<span class="op">&gt;</span> <span class="op">=</span> <span class="bu">round</span>(<span class="op">&lt;</span>num<span class="op">&gt;</span> [, ±ndigits])        <span class="co"># `round(126, -1) == 130`</span></a></code></pre></div>
<h3 id="math">Math</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb56-1" title="1"><span class="im">from</span> math <span class="im">import</span> e, pi, inf, nan, isinf, isnan</a>
<a class="sourceLine" id="cb56-2" title="2"><span class="im">from</span> math <span class="im">import</span> cos, acos, sin, asin, tan, atan, degrees, radians</a>
<a class="sourceLine" id="cb56-3" title="3"><span class="im">from</span> math <span class="im">import</span> log, log10, log2</a></code></pre></div>
<h3 id="statistics">Statistics</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb57-1" title="1"><span class="im">from</span> statistics <span class="im">import</span> mean, median, variance, stdev, pvariance, pstdev</a></code></pre></div>
<h3 id="random">Random</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb58-1" title="1"><span class="im">from</span> random <span class="im">import</span> random, randint, choice, shuffle</a>
<a class="sourceLine" id="cb58-2" title="2"><span class="op">&lt;</span><span class="bu">float</span><span class="op">&gt;</span> <span class="op">=</span> random()</a>
<a class="sourceLine" id="cb58-3" title="3"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>   <span class="op">=</span> randint(from_inclusive, to_inclusive)</a>
<a class="sourceLine" id="cb58-4" title="4"><span class="op">&lt;</span>el<span class="op">&gt;</span>    <span class="op">=</span> choice(<span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb58-5" title="5">shuffle(<span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>)</a></code></pre></div>
<h3 id="bin-hex">Bin, Hex</h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb59-1" title="1"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span> <span class="op">=</span> ±0b<span class="op">&lt;</span><span class="bu">bin</span><span class="op">&gt;</span>                         <span class="co"># Or: ±0x&lt;hex&gt;</span></a>
<a class="sourceLine" id="cb59-2" title="2"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">int</span>(<span class="st">&#39;±&lt;bin&gt;&#39;</span>, <span class="dv">2</span>)                 <span class="co"># Or: int(&#39;±&lt;hex&gt;&#39;, 16)</span></a>
<a class="sourceLine" id="cb59-3" title="3"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">int</span>(<span class="st">&#39;±0b&lt;bin&gt;&#39;</span>, <span class="dv">0</span>)               <span class="co"># Or: int(&#39;±0x&lt;hex&gt;&#39;, 0)</span></a>
<a class="sourceLine" id="cb59-4" title="4"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">bin</span>(<span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>)                       <span class="co"># Returns &#39;[-]0b&lt;bin&gt;&#39;.</span></a></code></pre></div>
<h3 id="bitwise-operators">Bitwise Operators</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb60-1" title="1"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span> <span class="op">&amp;</span> <span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>                    <span class="co"># And</span></a>
<a class="sourceLine" id="cb60-2" title="2"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span> <span class="op">|</span> <span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>                    <span class="co"># Or</span></a>
<a class="sourceLine" id="cb60-3" title="3"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span> <span class="op">^</span> <span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>                    <span class="co"># Xor (0 if both bits equal)</span></a>
<a class="sourceLine" id="cb60-4" title="4"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span> <span class="op">&lt;&lt;</span> n_bits                  <span class="co"># Shift left (&gt;&gt; for right)</span></a>
<a class="sourceLine" id="cb60-5" title="5"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">~&lt;</span><span class="bu">int</span><span class="op">&gt;</span>                           <span class="co"># Not (also: -&lt;int&gt; - 1)</span></a></code></pre></div>
<h2 id="combinatorics">Combinatorics</h2>
<ul>
<li><strong>Every function returns an iterator.</strong></li>
<li><strong>If you want to print the iterator, you need to pass it to the list() function first!</strong></li>
</ul>
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb61-1" title="1"><span class="im">from</span> itertools <span class="im">import</span> product, combinations, combinations_with_replacement, permutations</a></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb62-1" title="1"><span class="op">&gt;&gt;&gt;</span> product([<span class="dv">0</span>, <span class="dv">1</span>], repeat<span class="op">=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb62-2" title="2">[(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), (<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), (<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), (<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), ..., (<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)]</a></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb63-1" title="1"><span class="op">&gt;&gt;&gt;</span> product(<span class="st">&#39;abc&#39;</span>, <span class="st">&#39;abc&#39;</span>)                    <span class="co">#   a  b  c</span></a>
<a class="sourceLine" id="cb63-2" title="2">[(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;a&#39;</span>), (<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>), (<span class="st">&#39;a&#39;</span>, <span class="st">&#39;c&#39;</span>),         <span class="co"># a x  x  x</span></a>
<a class="sourceLine" id="cb63-3" title="3"> (<span class="st">&#39;b&#39;</span>, <span class="st">&#39;a&#39;</span>), (<span class="st">&#39;b&#39;</span>, <span class="st">&#39;b&#39;</span>), (<span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>),         <span class="co"># b x  x  x</span></a>
<a class="sourceLine" id="cb63-4" title="4"> (<span class="st">&#39;c&#39;</span>, <span class="st">&#39;a&#39;</span>), (<span class="st">&#39;c&#39;</span>, <span class="st">&#39;b&#39;</span>), (<span class="st">&#39;c&#39;</span>, <span class="st">&#39;c&#39;</span>)]         <span class="co"># c x  x  x</span></a></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb64-1" title="1"><span class="op">&gt;&gt;&gt;</span> combinations(<span class="st">&#39;abc&#39;</span>, <span class="dv">2</span>)                   <span class="co">#   a  b  c</span></a>
<a class="sourceLine" id="cb64-2" title="2">[(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>), (<span class="st">&#39;a&#39;</span>, <span class="st">&#39;c&#39;</span>),                     <span class="co"># a .  x  x</span></a>
<a class="sourceLine" id="cb64-3" title="3"> (<span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>)]                                 <span class="co"># b .  .  x</span></a></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb65-1" title="1"><span class="op">&gt;&gt;&gt;</span> combinations_with_replacement(<span class="st">&#39;abc&#39;</span>, <span class="dv">2</span>)  <span class="co">#   a  b  c</span></a>
<a class="sourceLine" id="cb65-2" title="2">[(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;a&#39;</span>), (<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>), (<span class="st">&#39;a&#39;</span>, <span class="st">&#39;c&#39;</span>),         <span class="co"># a x  x  x</span></a>
<a class="sourceLine" id="cb65-3" title="3"> (<span class="st">&#39;b&#39;</span>, <span class="st">&#39;b&#39;</span>), (<span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>),                     <span class="co"># b .  x  x</span></a>
<a class="sourceLine" id="cb65-4" title="4"> (<span class="st">&#39;c&#39;</span>, <span class="st">&#39;c&#39;</span>)]                                 <span class="co"># c .  .  x</span></a></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb66-1" title="1"><span class="op">&gt;&gt;&gt;</span> permutations(<span class="st">&#39;abc&#39;</span>, <span class="dv">2</span>)                   <span class="co">#   a  b  c</span></a>
<a class="sourceLine" id="cb66-2" title="2">[(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>), (<span class="st">&#39;a&#39;</span>, <span class="st">&#39;c&#39;</span>),                     <span class="co"># a .  x  x</span></a>
<a class="sourceLine" id="cb66-3" title="3"> (<span class="st">&#39;b&#39;</span>, <span class="st">&#39;a&#39;</span>), (<span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>),                     <span class="co"># b x  .  x</span></a>
<a class="sourceLine" id="cb66-4" title="4"> (<span class="st">&#39;c&#39;</span>, <span class="st">&#39;a&#39;</span>), (<span class="st">&#39;c&#39;</span>, <span class="st">&#39;b&#39;</span>)]                     <span class="co"># c x  x  .</span></a></code></pre></div>
<h2 id="datetime">Datetime</h2>
<ul>
<li><strong>Module ‘datetime’ provides ‘date’ <code>&lt;D&gt;</code>, ‘time’ <code>&lt;T&gt;</code>, ‘datetime’ <code>&lt;DT&gt;</code> and ‘timedelta’ <code>&lt;TD&gt;</code> classes. All are immutable and hashable.</strong></li>
<li><strong>Time and datetime objects can be ‘aware’ <code>&lt;a&gt;</code>, meaning they have defined timezone, or ‘naive’ <code>&lt;n&gt;</code>, meaning they don’t.</strong></li>
<li><strong>If object is naive, it is presumed to be in the system’s timezone.</strong></li>
</ul>
<div class="sourceCode" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb67-1" title="1"><span class="im">from</span> datetime <span class="im">import</span> date, time, datetime, timedelta</a>
<a class="sourceLine" id="cb67-2" title="2"><span class="im">from</span> dateutil.tz <span class="im">import</span> UTC, tzlocal, gettz, resolve_imaginary</a></code></pre></div>
<h3 id="constructors">Constructors</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb68-1" title="1"><span class="op">&lt;</span>D<span class="op">&gt;</span>  <span class="op">=</span> date(year, month, day)</a>
<a class="sourceLine" id="cb68-2" title="2"><span class="op">&lt;</span>T<span class="op">&gt;</span>  <span class="op">=</span> time(hour<span class="op">=</span><span class="dv">0</span>, minute<span class="op">=</span><span class="dv">0</span>, second<span class="op">=</span><span class="dv">0</span>, microsecond<span class="op">=</span><span class="dv">0</span>, tzinfo<span class="op">=</span><span class="va">None</span>, fold<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb68-3" title="3"><span class="op">&lt;</span>DT<span class="op">&gt;</span> <span class="op">=</span> datetime(year, month, day, hour<span class="op">=</span><span class="dv">0</span>, minute<span class="op">=</span><span class="dv">0</span>, second<span class="op">=</span><span class="dv">0</span>, ...)</a>
<a class="sourceLine" id="cb68-4" title="4"><span class="op">&lt;</span>TD<span class="op">&gt;</span> <span class="op">=</span> timedelta(days<span class="op">=</span><span class="dv">0</span>, seconds<span class="op">=</span><span class="dv">0</span>, microseconds<span class="op">=</span><span class="dv">0</span>, milliseconds<span class="op">=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb68-5" title="5">                 minutes<span class="op">=</span><span class="dv">0</span>, hours<span class="op">=</span><span class="dv">0</span>, weeks<span class="op">=</span><span class="dv">0</span>)</a></code></pre></div>
<ul>
<li><strong>Use <code>'&lt;D/DT&gt;.weekday()'</code> to get the day of the week (Mon == 0).</strong></li>
<li><strong><code>'fold=1'</code> means the second pass in case of time jumping back for one hour.</strong></li>
<li><strong><code>'&lt;DTa&gt; = resolve_imaginary(&lt;DTa&gt;)'</code> fixes DTs that fall into the missing hour.</strong></li>
</ul>
<h3 id="now">Now</h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb69-1" title="1"><span class="op">&lt;</span>D<span class="op">/</span>DTn<span class="op">&gt;</span>  <span class="op">=</span> D<span class="op">/</span>DT.today()                     <span class="co"># Current local date or naive datetime.</span></a>
<a class="sourceLine" id="cb69-2" title="2"><span class="op">&lt;</span>DTn<span class="op">&gt;</span>    <span class="op">=</span> DT.utcnow()                      <span class="co"># Naive datetime from current UTC time.</span></a>
<a class="sourceLine" id="cb69-3" title="3"><span class="op">&lt;</span>DTa<span class="op">&gt;</span>    <span class="op">=</span> DT.now(<span class="op">&lt;</span>tzinfo<span class="op">&gt;</span>)                 <span class="co"># Aware datetime from current tz time.</span></a></code></pre></div>
<ul>
<li><strong>To extract time use <code>'&lt;DTn&gt;.time()'</code>, <code>'&lt;DTa&gt;.time()'</code> or <code>'&lt;DTa&gt;.timetz()'</code>.</strong></li>
</ul>
<h3 id="timezone">Timezone</h3>
<div class="sourceCode" id="cb70"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb70-1" title="1"><span class="op">&lt;</span>tzinfo<span class="op">&gt;</span> <span class="op">=</span> UTC                              <span class="co"># UTC timezone. London without DST.</span></a>
<a class="sourceLine" id="cb70-2" title="2"><span class="op">&lt;</span>tzinfo<span class="op">&gt;</span> <span class="op">=</span> tzlocal()                        <span class="co"># Local timezone. Also gettz().</span></a>
<a class="sourceLine" id="cb70-3" title="3"><span class="op">&lt;</span>tzinfo<span class="op">&gt;</span> <span class="op">=</span> gettz(<span class="st">&#39;&lt;Continent&gt;/&lt;City&gt;&#39;</span>)      <span class="co"># &#39;Continent/City_Name&#39; timezone or None.</span></a>
<a class="sourceLine" id="cb70-4" title="4"><span class="op">&lt;</span>DTa<span class="op">&gt;</span>    <span class="op">=</span> <span class="op">&lt;</span>DT<span class="op">&gt;</span>.astimezone(<span class="op">&lt;</span>tzinfo<span class="op">&gt;</span>)        <span class="co"># Datetime, converted to passed timezone.</span></a>
<a class="sourceLine" id="cb70-5" title="5"><span class="op">&lt;</span>Ta<span class="op">/</span>DTa<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>T<span class="op">/</span>DT<span class="op">&gt;</span>.replace(tzinfo<span class="op">=&lt;</span>tzinfo<span class="op">&gt;</span>)  <span class="co"># Unconverted object with new timezone.</span></a></code></pre></div>
<h3 id="encode">Encode</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb71-1" title="1"><span class="op">&lt;</span>D<span class="op">/</span>T<span class="op">/</span>DT<span class="op">&gt;</span> <span class="op">=</span> D<span class="op">/</span>T<span class="op">/</span>DT.fromisoformat(<span class="st">&#39;&lt;iso&gt;&#39;</span>)    <span class="co"># Object from ISO string. Raises ValueError.</span></a>
<a class="sourceLine" id="cb71-2" title="2"><span class="op">&lt;</span>DT<span class="op">&gt;</span>     <span class="op">=</span> DT.strptime(<span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>, <span class="st">&#39;&lt;format&gt;&#39;</span>)   <span class="co"># Datetime from str, according to format.</span></a>
<a class="sourceLine" id="cb71-3" title="3"><span class="op">&lt;</span>D<span class="op">/</span>DTn<span class="op">&gt;</span>  <span class="op">=</span> D<span class="op">/</span>DT.fromordinal(<span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>)          <span class="co"># D/DTn from days since Christ, at midnight.</span></a>
<a class="sourceLine" id="cb71-4" title="4"><span class="op">&lt;</span>DTn<span class="op">&gt;</span>    <span class="op">=</span> DT.fromtimestamp(<span class="op">&lt;</span>real<span class="op">&gt;</span>)         <span class="co"># Local time DTn from seconds since Epoch.</span></a>
<a class="sourceLine" id="cb71-5" title="5"><span class="op">&lt;</span>DTa<span class="op">&gt;</span>    <span class="op">=</span> DT.fromtimestamp(<span class="op">&lt;</span>real<span class="op">&gt;</span>, <span class="op">&lt;</span>tz.<span class="op">&gt;</span>)  <span class="co"># Aware datetime from seconds since Epoch.</span></a></code></pre></div>
<ul>
<li><strong>ISO strings come in following forms: <code>'YYYY-MM-DD'</code>, <code>'HH:MM:SS.ffffff[±&lt;offset&gt;]'</code>, or both separated by an arbitrary character. Offset is formatted as: <code>'HH:MM'</code>.</strong></li>
<li><strong>Epoch on Unix systems is: <code>'1970-01-01 00:00 UTC'</code>, <code>'1970-01-01 01:00 CET'</code>, …</strong></li>
</ul>
<h3 id="decode">Decode</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb72-1" title="1"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>    <span class="op">=</span> <span class="op">&lt;</span>D<span class="op">/</span>T<span class="op">/</span>DT<span class="op">&gt;</span>.isoformat(sep<span class="op">=</span><span class="st">&#39;T&#39;</span>)      <span class="co"># Also timespec=&#39;auto/hours/minutes/seconds&#39;.</span></a>
<a class="sourceLine" id="cb72-2" title="2"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>    <span class="op">=</span> <span class="op">&lt;</span>D<span class="op">/</span>T<span class="op">/</span>DT<span class="op">&gt;</span>.strftime(<span class="st">&#39;&lt;format&gt;&#39;</span>)    <span class="co"># Custom string representation.</span></a>
<a class="sourceLine" id="cb72-3" title="3"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>    <span class="op">=</span> <span class="op">&lt;</span>D<span class="op">/</span>DT<span class="op">&gt;</span>.toordinal()               <span class="co"># Days since Christ, ignoring time and tz.</span></a>
<a class="sourceLine" id="cb72-4" title="4"><span class="op">&lt;</span><span class="bu">float</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span>DTn<span class="op">&gt;</span>.timestamp()                <span class="co"># Seconds since Epoch, from DTn in local tz.</span></a>
<a class="sourceLine" id="cb72-5" title="5"><span class="op">&lt;</span><span class="bu">float</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span>DTa<span class="op">&gt;</span>.timestamp()                <span class="co"># Seconds since Epoch, from DTa.</span></a></code></pre></div>
<h3 id="format-1">Format</h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb73-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> datetime <span class="im">import</span> datetime</a>
<a class="sourceLine" id="cb73-2" title="2"><span class="op">&gt;&gt;&gt;</span> dt <span class="op">=</span> datetime.strptime(<span class="st">&#39;2015-05-14 23:39:00.00 +0200&#39;</span>, <span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S.</span><span class="sc">%f</span><span class="st"> %z&#39;</span>)</a>
<a class="sourceLine" id="cb73-3" title="3"><span class="op">&gt;&gt;&gt;</span> dt.strftime(<span class="st">&quot;%A, </span><span class="sc">%d</span><span class="st">th of %B &#39;%y, %I:%M%p %Z&quot;</span>)</a>
<a class="sourceLine" id="cb73-4" title="4"><span class="co">&quot;Thursday, 14th of May &#39;15, 11:39PM UTC+02:00&quot;</span></a></code></pre></div>
<ul>
<li><strong>When parsing, <code>'%z'</code> also accepts <code>'±HH:MM'</code>.</strong></li>
<li><strong>For abbreviated weekday and month use <code>'%a'</code> and <code>'%b'</code>.</strong></li>
</ul>
<h3 id="arithmetics">Arithmetics</h3>
<div class="sourceCode" id="cb74"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb74-1" title="1"><span class="op">&lt;</span>D<span class="op">/</span>DT<span class="op">&gt;</span>   <span class="op">=</span> <span class="op">&lt;</span>D<span class="op">/</span>DT<span class="op">&gt;</span>   ± <span class="op">&lt;</span>TD<span class="op">&gt;</span>                  <span class="co"># Returned datetime can fall into missing hour.</span></a>
<a class="sourceLine" id="cb74-2" title="2"><span class="op">&lt;</span>TD<span class="op">&gt;</span>     <span class="op">=</span> <span class="op">&lt;</span>D<span class="op">/</span>DTn<span class="op">&gt;</span>  <span class="op">-</span> <span class="op">&lt;</span>D<span class="op">/</span>DTn<span class="op">&gt;</span>               <span class="co"># Returns the difference, ignoring time jumps.</span></a>
<a class="sourceLine" id="cb74-3" title="3"><span class="op">&lt;</span>TD<span class="op">&gt;</span>     <span class="op">=</span> <span class="op">&lt;</span>DTa<span class="op">&gt;</span>    <span class="op">-</span> <span class="op">&lt;</span>DTa<span class="op">&gt;</span>                 <span class="co"># Ignores time jumps if they share tzinfo object.</span></a>
<a class="sourceLine" id="cb74-4" title="4"><span class="op">&lt;</span>TD<span class="op">&gt;</span>     <span class="op">=</span> <span class="op">&lt;</span>DT_UTC<span class="op">&gt;</span> <span class="op">-</span> <span class="op">&lt;</span>DT_UTC<span class="op">&gt;</span>              <span class="co"># Convert DTs to UTC to get the actual delta.</span></a></code></pre></div>
<h2 id="arguments">Arguments</h2>
<h3 id="inside-function-call">Inside Function Call</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb75-1" title="1"><span class="op">&lt;</span>function<span class="op">&gt;</span>(<span class="op">&lt;</span>positional_args<span class="op">&gt;</span>)                  <span class="co"># f(0, 0)</span></a>
<a class="sourceLine" id="cb75-2" title="2"><span class="op">&lt;</span>function<span class="op">&gt;</span>(<span class="op">&lt;</span>keyword_args<span class="op">&gt;</span>)                     <span class="co"># f(x=0, y=0)</span></a>
<a class="sourceLine" id="cb75-3" title="3"><span class="op">&lt;</span>function<span class="op">&gt;</span>(<span class="op">&lt;</span>positional_args<span class="op">&gt;</span>, <span class="op">&lt;</span>keyword_args<span class="op">&gt;</span>)  <span class="co"># f(0, y=0)</span></a></code></pre></div>
<h3 id="inside-function-definition">Inside Function Definition</h3>
<div class="sourceCode" id="cb76"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb76-1" title="1"><span class="kw">def</span> f(<span class="op">&lt;</span>nondefault_args<span class="op">&gt;</span>):                      <span class="co"># def f(x, y):</span></a>
<a class="sourceLine" id="cb76-2" title="2"><span class="kw">def</span> f(<span class="op">&lt;</span>default_args<span class="op">&gt;</span>):                         <span class="co"># def f(x=0, y=0):</span></a>
<a class="sourceLine" id="cb76-3" title="3"><span class="kw">def</span> f(<span class="op">&lt;</span>nondefault_args<span class="op">&gt;</span>, <span class="op">&lt;</span>default_args<span class="op">&gt;</span>):      <span class="co"># def f(x, y=0):</span></a></code></pre></div>
<h2 id="splat-operator">Splat Operator</h2>
<h3 id="inside-function-call-1">Inside Function Call</h3>
<p><strong>Splat expands a collection into positional arguments, while splatty-splat expands a dictionary into keyword arguments.</strong></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb77-1" title="1">args   <span class="op">=</span> (<span class="dv">1</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb77-2" title="2">kwargs <span class="op">=</span> {<span class="st">&#39;x&#39;</span>: <span class="dv">3</span>, <span class="st">&#39;y&#39;</span>: <span class="dv">4</span>, <span class="st">&#39;z&#39;</span>: <span class="dv">5</span>}</a>
<a class="sourceLine" id="cb77-3" title="3">func(<span class="op">*</span>args, <span class="op">**</span>kwargs)</a></code></pre></div>
<h4 id="is-the-same-as">Is the same as:</h4>
<div class="sourceCode" id="cb78"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb78-1" title="1">func(<span class="dv">1</span>, <span class="dv">2</span>, x<span class="op">=</span><span class="dv">3</span>, y<span class="op">=</span><span class="dv">4</span>, z<span class="op">=</span><span class="dv">5</span>)</a></code></pre></div>
<h3 id="inside-function-definition-1">Inside Function Definition</h3>
<p><strong>Splat combines zero or more positional arguments into a tuple, while splatty-splat combines zero or more keyword arguments into a dictionary.</strong></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb79-1" title="1"><span class="kw">def</span> add(<span class="op">*</span>a):</a>
<a class="sourceLine" id="cb79-2" title="2">    <span class="cf">return</span> <span class="bu">sum</span>(a)</a></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb80-1" title="1"><span class="op">&gt;&gt;&gt;</span> add(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb80-2" title="2"><span class="dv">6</span></a></code></pre></div>
<h4 id="legal-argument-combinations">Legal argument combinations:</h4>
<div class="sourceCode" id="cb81"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb81-1" title="1"><span class="kw">def</span> f(x, y, z):                <span class="co"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3) | f(1, 2, 3)</span></a>
<a class="sourceLine" id="cb81-2" title="2"><span class="kw">def</span> f(<span class="op">*</span>, x, y, z):             <span class="co"># f(x=1, y=2, z=3)</span></a>
<a class="sourceLine" id="cb81-3" title="3"><span class="kw">def</span> f(x, <span class="op">*</span>, y, z):             <span class="co"># f(x=1, y=2, z=3) | f(1, y=2, z=3)</span></a>
<a class="sourceLine" id="cb81-4" title="4"><span class="kw">def</span> f(x, y, <span class="op">*</span>, z):             <span class="co"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3)</span></a></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">def</span> f(<span class="op">*</span>args):                  <span class="co"># f(1, 2, 3)</span></a>
<a class="sourceLine" id="cb82-2" title="2"><span class="kw">def</span> f(x, <span class="op">*</span>args):               <span class="co"># f(1, 2, 3)</span></a>
<a class="sourceLine" id="cb82-3" title="3"><span class="kw">def</span> f(<span class="op">*</span>args, z):               <span class="co"># f(1, 2, z=3)</span></a>
<a class="sourceLine" id="cb82-4" title="4"><span class="kw">def</span> f(x, <span class="op">*</span>args, z):            <span class="co"># f(1, 2, z=3)</span></a></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">def</span> f(<span class="op">**</span>kwargs):               <span class="co"># f(x=1, y=2, z=3)</span></a>
<a class="sourceLine" id="cb83-2" title="2"><span class="kw">def</span> f(x, <span class="op">**</span>kwargs):            <span class="co"># f(x=1, y=2, z=3) | f(1, y=2, z=3)</span></a>
<a class="sourceLine" id="cb83-3" title="3"><span class="kw">def</span> f(<span class="op">*</span>, x, <span class="op">**</span>kwargs):         <span class="co"># f(x=1, y=2, z=3)</span></a></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">def</span> f(<span class="op">*</span>args, <span class="op">**</span>kwargs):        <span class="co"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3) | f(1, 2, 3)</span></a>
<a class="sourceLine" id="cb84-2" title="2"><span class="kw">def</span> f(x, <span class="op">*</span>args, <span class="op">**</span>kwargs):     <span class="co"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3) | f(1, 2, 3)</span></a>
<a class="sourceLine" id="cb84-3" title="3"><span class="kw">def</span> f(<span class="op">*</span>args, y, <span class="op">**</span>kwargs):     <span class="co"># f(x=1, y=2, z=3) | f(1, y=2, z=3)</span></a>
<a class="sourceLine" id="cb84-4" title="4"><span class="kw">def</span> f(x, <span class="op">*</span>args, z, <span class="op">**</span>kwargs):  <span class="co"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3)</span></a></code></pre></div>
<h3 id="other-uses">Other Uses</h3>
<div class="sourceCode" id="cb85"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb85-1" title="1"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>  <span class="op">=</span> [<span class="op">*&lt;</span>collection<span class="op">&gt;</span> [, ...]]</a>
<a class="sourceLine" id="cb85-2" title="2"><span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span>   <span class="op">=</span> {<span class="op">*&lt;</span>collection<span class="op">&gt;</span> [, ...]}</a>
<a class="sourceLine" id="cb85-3" title="3"><span class="op">&lt;</span><span class="bu">tuple</span><span class="op">&gt;</span> <span class="op">=</span> (<span class="op">*&lt;</span>collection<span class="op">&gt;</span>, [...])</a>
<a class="sourceLine" id="cb85-4" title="4"><span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span>  <span class="op">=</span> {<span class="op">**&lt;</span><span class="bu">dict</span><span class="op">&gt;</span> [, ...]}</a></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb86-1" title="1">head, <span class="op">*</span>body, tail <span class="op">=</span> <span class="op">&lt;</span>collection<span class="op">&gt;</span></a></code></pre></div>
<h2 id="inline">Inline</h2>
<h3 id="lambda">Lambda</h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb87-1" title="1"><span class="op">&lt;</span>function<span class="op">&gt;</span> <span class="op">=</span> <span class="kw">lambda</span>: <span class="op">&lt;</span>return_value<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb87-2" title="2"><span class="op">&lt;</span>function<span class="op">&gt;</span> <span class="op">=</span> <span class="kw">lambda</span> <span class="op">&lt;</span>argument_1<span class="op">&gt;</span>, <span class="op">&lt;</span>argument_2<span class="op">&gt;</span>: <span class="op">&lt;</span>return_value<span class="op">&gt;</span></a></code></pre></div>
<h3 id="comprehensions">Comprehensions</h3>
<div class="sourceCode" id="cb88"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb88-1" title="1"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span> <span class="op">=</span> [i<span class="op">+</span><span class="dv">1</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)]                   <span class="co"># [1, 2, ..., 10]</span></a>
<a class="sourceLine" id="cb88-2" title="2"><span class="op">&lt;</span><span class="bu">set</span><span class="op">&gt;</span>  <span class="op">=</span> {i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>) <span class="cf">if</span> i <span class="op">&gt;</span> <span class="dv">5</span>}            <span class="co"># {6, 7, 8, 9}</span></a>
<a class="sourceLine" id="cb88-3" title="3"><span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span> <span class="op">=</span> (i<span class="op">+</span><span class="dv">5</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>))                   <span class="co"># (5, 6, ..., 14)</span></a>
<a class="sourceLine" id="cb88-4" title="4"><span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span> <span class="op">=</span> {i: i<span class="op">*</span><span class="dv">2</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)}                <span class="co"># {0: 0, 1: 2, ..., 9: 18}</span></a></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb89-1" title="1">out <span class="op">=</span> [i<span class="op">+</span>j <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)]</a></code></pre></div>
<h4 id="is-the-same-as-1">Is the same as:</h4>
<div class="sourceCode" id="cb90"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb90-1" title="1">out <span class="op">=</span> []</a>
<a class="sourceLine" id="cb90-2" title="2"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</a>
<a class="sourceLine" id="cb90-3" title="3">    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</a>
<a class="sourceLine" id="cb90-4" title="4">        out.append(i<span class="op">+</span>j)</a></code></pre></div>
<h3 id="map-filter-reduce">Map, Filter, Reduce</h3>
<div class="sourceCode" id="cb91"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb91-1" title="1"><span class="im">from</span> functools <span class="im">import</span> <span class="bu">reduce</span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">map</span>(<span class="kw">lambda</span> x: x <span class="op">+</span> <span class="dv">1</span>, <span class="bu">range</span>(<span class="dv">10</span>))            <span class="co"># (1, 2, ..., 10)</span></a>
<a class="sourceLine" id="cb91-3" title="3"><span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">filter</span>(<span class="kw">lambda</span> x: x <span class="op">&gt;</span> <span class="dv">5</span>, <span class="bu">range</span>(<span class="dv">10</span>))         <span class="co"># (6, 7, 8, 9)</span></a>
<a class="sourceLine" id="cb91-4" title="4"><span class="op">&lt;</span>obj<span class="op">&gt;</span>  <span class="op">=</span> <span class="bu">reduce</span>(<span class="kw">lambda</span> out, x: out <span class="op">+</span> x, <span class="bu">range</span>(<span class="dv">10</span>))  <span class="co"># 45</span></a></code></pre></div>
<h3 id="any-all">Any, All</h3>
<div class="sourceCode" id="cb92"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb92-1" title="1"><span class="op">&lt;</span><span class="bu">bool</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">any</span>(<span class="op">&lt;</span>collection<span class="op">&gt;</span>)                          <span class="co"># False if empty.</span></a>
<a class="sourceLine" id="cb92-2" title="2"><span class="op">&lt;</span><span class="bu">bool</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">all</span>(el[<span class="dv">1</span>] <span class="cf">for</span> el <span class="kw">in</span> <span class="op">&lt;</span>collection<span class="op">&gt;</span>)          <span class="co"># True if empty.</span></a></code></pre></div>
<h3 id="if---else">If - Else</h3>
<div class="sourceCode" id="cb93"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb93-1" title="1"><span class="op">&lt;</span>obj<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>expression_if_true<span class="op">&gt;</span> <span class="cf">if</span> <span class="op">&lt;</span>condition<span class="op">&gt;</span> <span class="cf">else</span> <span class="op">&lt;</span>expression_if_false<span class="op">&gt;</span></a></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb94-1" title="1"><span class="op">&gt;&gt;&gt;</span> [a <span class="cf">if</span> a <span class="cf">else</span> <span class="st">&#39;zero&#39;</span> <span class="cf">for</span> a <span class="kw">in</span> (<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)]</a>
<a class="sourceLine" id="cb94-2" title="2">[<span class="st">&#39;zero&#39;</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</a></code></pre></div>
<h3 id="namedtuple-enum-dataclass">Namedtuple, Enum, Dataclass</h3>
<div class="sourceCode" id="cb95"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb95-1" title="1"><span class="im">from</span> collections <span class="im">import</span> namedtuple</a>
<a class="sourceLine" id="cb95-2" title="2">Point     <span class="op">=</span> namedtuple(<span class="st">&#39;Point&#39;</span>, <span class="st">&#39;x y&#39;</span>)</a>
<a class="sourceLine" id="cb95-3" title="3">point     <span class="op">=</span> Point(<span class="dv">0</span>, <span class="dv">0</span>)</a></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb96-1" title="1"><span class="im">from</span> enum <span class="im">import</span> Enum</a>
<a class="sourceLine" id="cb96-2" title="2">Direction <span class="op">=</span> Enum(<span class="st">&#39;Direction&#39;</span>, <span class="st">&#39;n e s w&#39;</span>)</a>
<a class="sourceLine" id="cb96-3" title="3">direction <span class="op">=</span> Direction.n</a></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb97-1" title="1"><span class="im">from</span> dataclasses <span class="im">import</span> make_dataclass</a>
<a class="sourceLine" id="cb97-2" title="2">Creature  <span class="op">=</span> make_dataclass(<span class="st">&#39;Creature&#39;</span>, [<span class="st">&#39;location&#39;</span>, <span class="st">&#39;direction&#39;</span>])</a>
<a class="sourceLine" id="cb97-3" title="3">creature  <span class="op">=</span> Creature(Point(<span class="dv">0</span>, <span class="dv">0</span>), Direction.n)</a></code></pre></div>
<h2 id="closure">Closure</h2>
<p><strong>We have a closure in Python when:</strong> * <strong>A nested function references a value of its enclosing function and then</strong> * <strong>the enclosing function returns the nested function.</strong></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb98-1" title="1"><span class="kw">def</span> get_multiplier(a):</a>
<a class="sourceLine" id="cb98-2" title="2">    <span class="kw">def</span> out(b):</a>
<a class="sourceLine" id="cb98-3" title="3">        <span class="cf">return</span> a <span class="op">*</span> b</a>
<a class="sourceLine" id="cb98-4" title="4">    <span class="cf">return</span> out</a></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb99-1" title="1"><span class="op">&gt;&gt;&gt;</span> multiply_by_3 <span class="op">=</span> get_multiplier(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb99-2" title="2"><span class="op">&gt;&gt;&gt;</span> multiply_by_3(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb99-3" title="3"><span class="dv">30</span></a></code></pre></div>
<ul>
<li><strong>If multiple nested functions within enclosing function reference the same value, that value gets shared.</strong></li>
<li><strong>To dynamically access function’s first free variable use <code>'&lt;function&gt;.__closure__[0].cell_contents'</code>.</strong></li>
</ul>
<h3 id="partial">Partial</h3>
<div class="sourceCode" id="cb100"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb100-1" title="1"><span class="im">from</span> functools <span class="im">import</span> partial</a>
<a class="sourceLine" id="cb100-2" title="2"><span class="op">&lt;</span>function<span class="op">&gt;</span> <span class="op">=</span> partial(<span class="op">&lt;</span>function<span class="op">&gt;</span> [, <span class="op">&lt;</span>arg_1<span class="op">&gt;</span>, <span class="op">&lt;</span>arg_2<span class="op">&gt;</span>, ...])</a></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb101-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> operator <span class="im">as</span> op</a>
<a class="sourceLine" id="cb101-2" title="2"><span class="op">&gt;&gt;&gt;</span> multiply_by_3 <span class="op">=</span> partial(op.mul, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb101-3" title="3"><span class="op">&gt;&gt;&gt;</span> multiply_by_3(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb101-4" title="4"><span class="dv">30</span></a></code></pre></div>
<ul>
<li><strong>Partial is also useful in cases when function needs to be passed as an argument, because it enables us to set its arguments beforehand.</strong></li>
<li><strong>A few examples being: <code>'defaultdict(&lt;function&gt;)'</code>, <code>'iter(&lt;function&gt;, to_exclusive)'</code> and dataclass’s <code>'field(default_factory=&lt;function&gt;)'</code>.</strong></li>
</ul>
<h3 id="non-local">Non-Local</h3>
<p><strong>If variable is being assigned to anywhere in the scope, it is regarded as a local variable, unless it is declared as a ‘global’ or a ‘nonlocal’.</strong></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb102-1" title="1"><span class="kw">def</span> get_counter():</a>
<a class="sourceLine" id="cb102-2" title="2">    i <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb102-3" title="3">    <span class="kw">def</span> out():</a>
<a class="sourceLine" id="cb102-4" title="4">        <span class="kw">nonlocal</span> i</a>
<a class="sourceLine" id="cb102-5" title="5">        i <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb102-6" title="6">        <span class="cf">return</span> i</a>
<a class="sourceLine" id="cb102-7" title="7">    <span class="cf">return</span> out</a></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb103-1" title="1"><span class="op">&gt;&gt;&gt;</span> counter <span class="op">=</span> get_counter()</a>
<a class="sourceLine" id="cb103-2" title="2"><span class="op">&gt;&gt;&gt;</span> counter(), counter(), counter()</a>
<a class="sourceLine" id="cb103-3" title="3">(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</a></code></pre></div>
<h2 id="decorator">Decorator</h2>
<p><strong>A decorator takes a function, adds some functionality and returns it.</strong></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb104-1" title="1"><span class="at">@decorator_name</span></a>
<a class="sourceLine" id="cb104-2" title="2"><span class="kw">def</span> function_that_gets_passed_to_decorator():</a>
<a class="sourceLine" id="cb104-3" title="3">    ...</a></code></pre></div>
<h3 id="debugger-example">Debugger Example</h3>
<p><strong>Decorator that prints function’s name every time it gets called.</strong></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb105-1" title="1"><span class="im">from</span> functools <span class="im">import</span> wraps</a>
<a class="sourceLine" id="cb105-2" title="2"></a>
<a class="sourceLine" id="cb105-3" title="3"><span class="kw">def</span> debug(func):</a>
<a class="sourceLine" id="cb105-4" title="4">    <span class="at">@wraps</span>(func)</a>
<a class="sourceLine" id="cb105-5" title="5">    <span class="kw">def</span> out(<span class="op">*</span>args, <span class="op">**</span>kwargs):</a>
<a class="sourceLine" id="cb105-6" title="6">        <span class="bu">print</span>(func.<span class="va">__name__</span>)</a>
<a class="sourceLine" id="cb105-7" title="7">        <span class="cf">return</span> func(<span class="op">*</span>args, <span class="op">**</span>kwargs)</a>
<a class="sourceLine" id="cb105-8" title="8">    <span class="cf">return</span> out</a>
<a class="sourceLine" id="cb105-9" title="9"></a>
<a class="sourceLine" id="cb105-10" title="10"><span class="at">@debug</span></a>
<a class="sourceLine" id="cb105-11" title="11"><span class="kw">def</span> add(x, y):</a>
<a class="sourceLine" id="cb105-12" title="12">    <span class="cf">return</span> x <span class="op">+</span> y</a></code></pre></div>
<ul>
<li><strong>Wraps is a helper decorator that copies the metadata of the passed function (func) to the function it is wrapping (out).</strong></li>
<li><strong>Without it <code>'add.__name__'</code> would return <code>'out'</code>.</strong></li>
</ul>
<h3 id="lru-cache">LRU Cache</h3>
<p><strong>Decorator that caches function’s return values. All function’s arguments must be hashable.</strong></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb106-1" title="1"><span class="im">from</span> functools <span class="im">import</span> lru_cache</a>
<a class="sourceLine" id="cb106-2" title="2"></a>
<a class="sourceLine" id="cb106-3" title="3"><span class="at">@lru_cache</span>(maxsize<span class="op">=</span><span class="va">None</span>)</a>
<a class="sourceLine" id="cb106-4" title="4"><span class="kw">def</span> fib(n):</a>
<a class="sourceLine" id="cb106-5" title="5">    <span class="cf">return</span> n <span class="cf">if</span> n <span class="op">&lt;</span> <span class="dv">2</span> <span class="cf">else</span> fib(n<span class="dv">-2</span>) <span class="op">+</span> fib(n<span class="dv">-1</span>)</a></code></pre></div>
<ul>
<li><strong>CPython interpreter limits recursion depth to 1000 by default. To increase it use <code>'sys.setrecursionlimit(&lt;depth&gt;)'</code>.</strong></li>
</ul>
<h3 id="parametrized-decorator">Parametrized Decorator</h3>
<p><strong>A decorator that accepts arguments and returns a normal decorator that accepts a function.</strong></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb107-1" title="1"><span class="im">from</span> functools <span class="im">import</span> wraps</a>
<a class="sourceLine" id="cb107-2" title="2"></a>
<a class="sourceLine" id="cb107-3" title="3"><span class="kw">def</span> debug(print_result<span class="op">=</span><span class="va">False</span>):</a>
<a class="sourceLine" id="cb107-4" title="4">    <span class="kw">def</span> decorator(func):</a>
<a class="sourceLine" id="cb107-5" title="5">        <span class="at">@wraps</span>(func)</a>
<a class="sourceLine" id="cb107-6" title="6">        <span class="kw">def</span> out(<span class="op">*</span>args, <span class="op">**</span>kwargs):</a>
<a class="sourceLine" id="cb107-7" title="7">            result <span class="op">=</span> func(<span class="op">*</span>args, <span class="op">**</span>kwargs)</a>
<a class="sourceLine" id="cb107-8" title="8">            <span class="bu">print</span>(func.<span class="va">__name__</span>, result <span class="cf">if</span> print_result <span class="cf">else</span> <span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb107-9" title="9">            <span class="cf">return</span> result</a>
<a class="sourceLine" id="cb107-10" title="10">        <span class="cf">return</span> out</a>
<a class="sourceLine" id="cb107-11" title="11">    <span class="cf">return</span> decorator</a>
<a class="sourceLine" id="cb107-12" title="12"></a>
<a class="sourceLine" id="cb107-13" title="13"><span class="at">@debug</span>(print_result<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb107-14" title="14"><span class="kw">def</span> add(x, y):</a>
<a class="sourceLine" id="cb107-15" title="15">    <span class="cf">return</span> x <span class="op">+</span> y</a></code></pre></div>
<h2 id="class">Class</h2>
<div class="sourceCode" id="cb108"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb108-1" title="1"><span class="kw">class</span> <span class="op">&lt;</span>name<span class="op">&gt;</span>:</a>
<a class="sourceLine" id="cb108-2" title="2">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a):</a>
<a class="sourceLine" id="cb108-3" title="3">        <span class="va">self</span>.a <span class="op">=</span> a</a>
<a class="sourceLine" id="cb108-4" title="4">    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb108-5" title="5">        class_name <span class="op">=</span> <span class="va">self</span>.__class__.<span class="va">__name__</span></a>
<a class="sourceLine" id="cb108-6" title="6">        <span class="cf">return</span> <span class="ss">f&#39;</span><span class="sc">{</span>class_name<span class="sc">}</span><span class="ss">(</span><span class="sc">{</span><span class="va">self</span><span class="sc">.a!r}</span><span class="ss">)&#39;</span></a>
<a class="sourceLine" id="cb108-7" title="7">    <span class="kw">def</span> <span class="fu">__str__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb108-8" title="8">        <span class="cf">return</span> <span class="bu">str</span>(<span class="va">self</span>.a)</a>
<a class="sourceLine" id="cb108-9" title="9"></a>
<a class="sourceLine" id="cb108-10" title="10">    <span class="at">@classmethod</span></a>
<a class="sourceLine" id="cb108-11" title="11">    <span class="kw">def</span> get_class_name(cls):</a>
<a class="sourceLine" id="cb108-12" title="12">        <span class="cf">return</span> cls.<span class="va">__name__</span></a></code></pre></div>
<ul>
<li><strong>Return value of repr() should be unambiguous and of str() readable.</strong></li>
<li><strong>If only repr() is defined, it will also be used for str().</strong></li>
</ul>
<h4 id="str-use-cases">Str() use cases:</h4>
<div class="sourceCode" id="cb109"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb109-1" title="1"><span class="bu">print</span>(<span class="op">&lt;</span>el<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb109-2" title="2"><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span><span class="op">&lt;</span><span class="sc">el</span><span class="op">&gt;</span><span class="sc">}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb109-3" title="3"><span class="cf">raise</span> <span class="pp">Exception</span>(<span class="op">&lt;</span>el<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb109-4" title="4">loguru.logger.debug(<span class="op">&lt;</span>el<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb109-5" title="5">csv.writer(<span class="op">&lt;</span><span class="bu">file</span><span class="op">&gt;</span>).writerow([<span class="op">&lt;</span>el<span class="op">&gt;</span>])</a></code></pre></div>
<h4 id="repr-use-cases">Repr() use cases:</h4>
<div class="sourceCode" id="cb110"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb110-1" title="1"><span class="bu">print</span>([<span class="op">&lt;</span>el<span class="op">&gt;</span>])</a>
<a class="sourceLine" id="cb110-2" title="2"><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span><span class="op">&lt;</span><span class="sc">el</span><span class="op">&gt;</span><span class="sc">!r}</span><span class="ss">&#39;</span>)</a>
<a class="sourceLine" id="cb110-3" title="3"><span class="op">&gt;&gt;&gt;</span> <span class="op">&lt;</span>el<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb110-4" title="4">loguru.logger.exception()</a>
<a class="sourceLine" id="cb110-5" title="5">Z <span class="op">=</span> dataclasses.make_dataclass(<span class="st">&#39;Z&#39;</span>, [<span class="st">&#39;a&#39;</span>])<span class="op">;</span> <span class="bu">print</span>(Z(<span class="op">&lt;</span>el<span class="op">&gt;</span>))</a></code></pre></div>
<h3 id="constructor-overloading">Constructor Overloading</h3>
<div class="sourceCode" id="cb111"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb111-1" title="1"><span class="kw">class</span> <span class="op">&lt;</span>name<span class="op">&gt;</span>:</a>
<a class="sourceLine" id="cb111-2" title="2">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a<span class="op">=</span><span class="va">None</span>):</a>
<a class="sourceLine" id="cb111-3" title="3">        <span class="va">self</span>.a <span class="op">=</span> a</a></code></pre></div>
<h3 id="inheritance">Inheritance</h3>
<div class="sourceCode" id="cb112"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb112-1" title="1"><span class="kw">class</span> Person:</a>
<a class="sourceLine" id="cb112-2" title="2">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, age):</a>
<a class="sourceLine" id="cb112-3" title="3">        <span class="va">self</span>.name <span class="op">=</span> name</a>
<a class="sourceLine" id="cb112-4" title="4">        <span class="va">self</span>.age  <span class="op">=</span> age</a>
<a class="sourceLine" id="cb112-5" title="5"></a>
<a class="sourceLine" id="cb112-6" title="6"><span class="kw">class</span> Employee(Person):</a>
<a class="sourceLine" id="cb112-7" title="7">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, age, staff_num):</a>
<a class="sourceLine" id="cb112-8" title="8">        <span class="bu">super</span>().<span class="fu">__init__</span>(name, age)</a>
<a class="sourceLine" id="cb112-9" title="9">        <span class="va">self</span>.staff_num <span class="op">=</span> staff_num</a></code></pre></div>
<h3 id="multiple-inheritance">Multiple Inheritance</h3>
<div class="sourceCode" id="cb113"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb113-1" title="1"><span class="kw">class</span> A: <span class="cf">pass</span></a>
<a class="sourceLine" id="cb113-2" title="2"><span class="kw">class</span> B: <span class="cf">pass</span></a>
<a class="sourceLine" id="cb113-3" title="3"><span class="kw">class</span> C(A, B): <span class="cf">pass</span></a></code></pre></div>
<p><strong>MRO determines the order in which parent classes are traversed when searching for a method:</strong></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb114-1" title="1"><span class="op">&gt;&gt;&gt;</span> C.mro()</a>
<a class="sourceLine" id="cb114-2" title="2">[<span class="op">&lt;</span><span class="kw">class</span> <span class="st">&#39;C&#39;</span><span class="op">&gt;</span>, <span class="op">&lt;</span><span class="kw">class</span> <span class="st">&#39;A&#39;</span><span class="op">&gt;</span>, <span class="op">&lt;</span><span class="kw">class</span> <span class="st">&#39;B&#39;</span><span class="op">&gt;</span>, <span class="op">&lt;</span><span class="kw">class</span> <span class="st">&#39;object&#39;</span><span class="op">&gt;</span>]</a></code></pre></div>
<h3 id="property">Property</h3>
<p><strong>Pythonic way of implementing getters and setters.</strong></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb115-1" title="1"><span class="kw">class</span> MyClass:</a>
<a class="sourceLine" id="cb115-2" title="2">    <span class="at">@property</span></a>
<a class="sourceLine" id="cb115-3" title="3">    <span class="kw">def</span> a(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb115-4" title="4">        <span class="cf">return</span> <span class="va">self</span>._a</a>
<a class="sourceLine" id="cb115-5" title="5"></a>
<a class="sourceLine" id="cb115-6" title="6">    <span class="at">@a.setter</span></a>
<a class="sourceLine" id="cb115-7" title="7">    <span class="kw">def</span> a(<span class="va">self</span>, value):</a>
<a class="sourceLine" id="cb115-8" title="8">        <span class="va">self</span>._a <span class="op">=</span> value</a></code></pre></div>
<div class="sourceCode" id="cb116"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb116-1" title="1"><span class="op">&gt;&gt;&gt;</span> el <span class="op">=</span> MyClass()</a>
<a class="sourceLine" id="cb116-2" title="2"><span class="op">&gt;&gt;&gt;</span> el.a <span class="op">=</span> <span class="dv">123</span></a>
<a class="sourceLine" id="cb116-3" title="3"><span class="op">&gt;&gt;&gt;</span> el.a</a>
<a class="sourceLine" id="cb116-4" title="4"><span class="dv">123</span></a></code></pre></div>
<h3 id="dataclass">Dataclass</h3>
<p><strong>Decorator that automatically generates init(), repr() and eq() special methods.</strong></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb117-1" title="1"><span class="im">from</span> dataclasses <span class="im">import</span> dataclass, field</a>
<a class="sourceLine" id="cb117-2" title="2"></a>
<a class="sourceLine" id="cb117-3" title="3"><span class="at">@dataclass</span>(order<span class="op">=</span><span class="va">False</span>, frozen<span class="op">=</span><span class="va">False</span>)</a>
<a class="sourceLine" id="cb117-4" title="4"><span class="kw">class</span> <span class="op">&lt;</span>class_name<span class="op">&gt;</span>:</a>
<a class="sourceLine" id="cb117-5" title="5">    <span class="op">&lt;</span>attr_name_1<span class="op">&gt;</span>: <span class="op">&lt;</span><span class="bu">type</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb117-6" title="6">    <span class="op">&lt;</span>attr_name_2<span class="op">&gt;</span>: <span class="op">&lt;</span><span class="bu">type</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>default_value<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb117-7" title="7">    <span class="op">&lt;</span>attr_name_3<span class="op">&gt;</span>: <span class="bu">list</span><span class="op">/</span><span class="bu">dict</span><span class="op">/</span><span class="bu">set</span> <span class="op">=</span> field(default_factory<span class="op">=</span><span class="bu">list</span><span class="op">/</span><span class="bu">dict</span><span class="op">/</span><span class="bu">set</span>)</a></code></pre></div>
<ul>
<li><strong>Objects can be made sortable with <code>'order=True'</code> and immutable with <code>'frozen=True'</code>.</strong></li>
<li><strong>For object to be hashable, all attributes must be hashable and frozen must be True.</strong></li>
<li><strong>Function field() is needed because <code>'&lt;attr_name&gt;: list = []'</code> would make a list that is shared among all instances.</strong></li>
<li><strong>Default_factory can be any <a href="#callable">callable</a>.</strong></li>
</ul>
<h4 id="inline-1">Inline:</h4>
<div class="sourceCode" id="cb118"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb118-1" title="1"><span class="im">from</span> dataclasses <span class="im">import</span> make_dataclass</a>
<a class="sourceLine" id="cb118-2" title="2"><span class="op">&lt;</span><span class="kw">class</span><span class="op">&gt;</span> <span class="op">=</span> make_dataclass(<span class="st">&#39;&lt;class_name&gt;&#39;</span>, <span class="op">&lt;</span>coll_of_attribute_names<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb118-3" title="3"><span class="op">&lt;</span><span class="kw">class</span><span class="op">&gt;</span> <span class="op">=</span> make_dataclass(<span class="st">&#39;&lt;class_name&gt;&#39;</span>, <span class="op">&lt;</span>coll_of_tuples<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb118-4" title="4"><span class="op">&lt;</span><span class="bu">tuple</span><span class="op">&gt;</span> <span class="op">=</span> (<span class="st">&#39;&lt;attr_name&gt;&#39;</span>, <span class="op">&lt;</span><span class="bu">type</span><span class="op">&gt;</span> [, <span class="op">&lt;</span>default_value<span class="op">&gt;</span>])</a></code></pre></div>
<h3 id="slots">Slots</h3>
<p><strong>Mechanism that restricts objects to attributes listed in ‘slots’ and significantly reduces their memory footprint.</strong></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb119-1" title="1"><span class="kw">class</span> MyClassWithSlots:</a>
<a class="sourceLine" id="cb119-2" title="2">    __slots__ <span class="op">=</span> [<span class="st">&#39;a&#39;</span>]</a>
<a class="sourceLine" id="cb119-3" title="3">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb119-4" title="4">        <span class="va">self</span>.a <span class="op">=</span> <span class="dv">1</span></a></code></pre></div>
<h3 id="copy">Copy</h3>
<div class="sourceCode" id="cb120"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb120-1" title="1"><span class="im">from</span> copy <span class="im">import</span> copy, deepcopy</a>
<a class="sourceLine" id="cb120-2" title="2"><span class="op">&lt;</span><span class="bu">object</span><span class="op">&gt;</span> <span class="op">=</span> copy(<span class="op">&lt;</span><span class="bu">object</span><span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb120-3" title="3"><span class="op">&lt;</span><span class="bu">object</span><span class="op">&gt;</span> <span class="op">=</span> deepcopy(<span class="op">&lt;</span><span class="bu">object</span><span class="op">&gt;</span>)</a></code></pre></div>
<h2 id="duck-types">Duck Types</h2>
<p><strong>A duck type is an implicit type that prescribes a set of special methods. Any object that has those methods defined is considered a member of that duck type.</strong></p>
<h3 id="comparable">Comparable</h3>
<ul>
<li><strong>If eq() method is not overridden, it returns <code>'id(self) == id(other)'</code>, which is the same as <code>'self is other'</code>.</strong></li>
<li><strong>That means all objects compare not equal by default.</strong></li>
<li><strong>Only the left side object has eq() method called, unless it returns NotImplemented, in which case the right object is consulted.</strong></li>
</ul>
<div class="sourceCode" id="cb121"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb121-1" title="1"><span class="kw">class</span> MyComparable:</a>
<a class="sourceLine" id="cb121-2" title="2">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a):</a>
<a class="sourceLine" id="cb121-3" title="3">        <span class="va">self</span>.a <span class="op">=</span> a</a>
<a class="sourceLine" id="cb121-4" title="4">    <span class="kw">def</span> <span class="fu">__eq__</span>(<span class="va">self</span>, other):</a>
<a class="sourceLine" id="cb121-5" title="5">        <span class="cf">if</span> <span class="bu">isinstance</span>(other, <span class="bu">type</span>(<span class="va">self</span>)):</a>
<a class="sourceLine" id="cb121-6" title="6">            <span class="cf">return</span> <span class="va">self</span>.a <span class="op">==</span> other.a</a>
<a class="sourceLine" id="cb121-7" title="7">        <span class="cf">return</span> <span class="va">NotImplemented</span></a></code></pre></div>
<h3 id="hashable">Hashable</h3>
<ul>
<li><strong>Hashable object needs both hash() and eq() methods and its hash value should never change.</strong></li>
<li><strong>Hashable objects that compare equal must have the same hash value, meaning default hash() that returns <code>'id(self)'</code> will not do.</strong></li>
<li><strong>That is why Python automatically makes classes unhashable if you only implement eq().</strong></li>
</ul>
<div class="sourceCode" id="cb122"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb122-1" title="1"><span class="kw">class</span> MyHashable:</a>
<a class="sourceLine" id="cb122-2" title="2">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a):</a>
<a class="sourceLine" id="cb122-3" title="3">        <span class="va">self</span>._a <span class="op">=</span> a</a>
<a class="sourceLine" id="cb122-4" title="4">    <span class="at">@property</span></a>
<a class="sourceLine" id="cb122-5" title="5">    <span class="kw">def</span> a(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb122-6" title="6">        <span class="cf">return</span> <span class="va">self</span>._a</a>
<a class="sourceLine" id="cb122-7" title="7">    <span class="kw">def</span> <span class="fu">__eq__</span>(<span class="va">self</span>, other):</a>
<a class="sourceLine" id="cb122-8" title="8">        <span class="cf">if</span> <span class="bu">isinstance</span>(other, <span class="bu">type</span>(<span class="va">self</span>)):</a>
<a class="sourceLine" id="cb122-9" title="9">            <span class="cf">return</span> <span class="va">self</span>.a <span class="op">==</span> other.a</a>
<a class="sourceLine" id="cb122-10" title="10">        <span class="cf">return</span> <span class="va">NotImplemented</span></a>
<a class="sourceLine" id="cb122-11" title="11">    <span class="kw">def</span> <span class="fu">__hash__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb122-12" title="12">        <span class="cf">return</span> <span class="bu">hash</span>(<span class="va">self</span>.a)</a></code></pre></div>
<h3 id="sortable">Sortable</h3>
<ul>
<li><strong>With total_ordering decorator, you only need to provide eq() and one of lt(), gt(), le() or ge() special methods.</strong></li>
</ul>
<div class="sourceCode" id="cb123"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb123-1" title="1"><span class="im">from</span> functools <span class="im">import</span> total_ordering</a>
<a class="sourceLine" id="cb123-2" title="2"></a>
<a class="sourceLine" id="cb123-3" title="3"><span class="at">@total_ordering</span></a>
<a class="sourceLine" id="cb123-4" title="4"><span class="kw">class</span> MySortable:</a>
<a class="sourceLine" id="cb123-5" title="5">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a):</a>
<a class="sourceLine" id="cb123-6" title="6">        <span class="va">self</span>.a <span class="op">=</span> a</a>
<a class="sourceLine" id="cb123-7" title="7">    <span class="kw">def</span> <span class="fu">__eq__</span>(<span class="va">self</span>, other):</a>
<a class="sourceLine" id="cb123-8" title="8">        <span class="cf">if</span> <span class="bu">isinstance</span>(other, <span class="bu">type</span>(<span class="va">self</span>)):</a>
<a class="sourceLine" id="cb123-9" title="9">            <span class="cf">return</span> <span class="va">self</span>.a <span class="op">==</span> other.a</a>
<a class="sourceLine" id="cb123-10" title="10">        <span class="cf">return</span> <span class="va">NotImplemented</span></a>
<a class="sourceLine" id="cb123-11" title="11">    <span class="kw">def</span> <span class="fu">__lt__</span>(<span class="va">self</span>, other):</a>
<a class="sourceLine" id="cb123-12" title="12">        <span class="cf">if</span> <span class="bu">isinstance</span>(other, <span class="bu">type</span>(<span class="va">self</span>)):</a>
<a class="sourceLine" id="cb123-13" title="13">            <span class="cf">return</span> <span class="va">self</span>.a <span class="op">&lt;</span> other.a</a>
<a class="sourceLine" id="cb123-14" title="14">        <span class="cf">return</span> <span class="va">NotImplemented</span></a></code></pre></div>
<h3 id="iterator-1">Iterator</h3>
<ul>
<li><strong>Any object that has methods next() and iter() is an iterator.</strong></li>
<li><strong>Next() should return next item or raise StopIteration.</strong></li>
<li><strong>Iter() should return ‘self’.</strong></li>
</ul>
<div class="sourceCode" id="cb124"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb124-1" title="1"><span class="kw">class</span> Counter:</a>
<a class="sourceLine" id="cb124-2" title="2">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb124-3" title="3">        <span class="va">self</span>.i <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb124-4" title="4">    <span class="kw">def</span> <span class="fu">__next__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb124-5" title="5">        <span class="va">self</span>.i <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb124-6" title="6">        <span class="cf">return</span> <span class="va">self</span>.i</a>
<a class="sourceLine" id="cb124-7" title="7">    <span class="kw">def</span> <span class="fu">__iter__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb124-8" title="8">        <span class="cf">return</span> <span class="va">self</span></a></code></pre></div>
<div class="sourceCode" id="cb125"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb125-1" title="1"><span class="op">&gt;&gt;&gt;</span> counter <span class="op">=</span> Counter()</a>
<a class="sourceLine" id="cb125-2" title="2"><span class="op">&gt;&gt;&gt;</span> <span class="bu">next</span>(counter), <span class="bu">next</span>(counter), <span class="bu">next</span>(counter)</a>
<a class="sourceLine" id="cb125-3" title="3">(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</a></code></pre></div>
<h4 id="python-has-many-different-iterator-objects">Python has many different iterator objects:</h4>
<ul>
<li><strong>Iterators returned by the <a href="#iterator">iter()</a> function, such as list_iterator and set_iterator.</strong></li>
<li><strong>Objects returned by the <a href="#itertools">itertools</a> module, such as count, repeat and cycle.</strong></li>
<li><strong>Generators returned by the <a href="#generator">generator functions</a> and <a href="#comprehensions">generator expressions</a>.</strong></li>
<li><strong>File objects returned by the <a href="#open">open()</a> function, etc.</strong></li>
</ul>
<h3 id="callable">Callable</h3>
<ul>
<li><strong>All functions and classes have a call() method, hence are callable.</strong></li>
<li><strong>When this cheatsheet uses <code>'&lt;function&gt;'</code> as an argument, it actually means <code>'&lt;callable&gt;'</code>.</strong></li>
</ul>
<div class="sourceCode" id="cb126"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb126-1" title="1"><span class="kw">class</span> Counter:</a>
<a class="sourceLine" id="cb126-2" title="2">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb126-3" title="3">        <span class="va">self</span>.i <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb126-4" title="4">    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb126-5" title="5">        <span class="va">self</span>.i <span class="op">+=</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb126-6" title="6">        <span class="cf">return</span> <span class="va">self</span>.i</a></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb127-1" title="1"><span class="op">&gt;&gt;&gt;</span> counter <span class="op">=</span> Counter()</a>
<a class="sourceLine" id="cb127-2" title="2"><span class="op">&gt;&gt;&gt;</span> counter(), counter(), counter()</a>
<a class="sourceLine" id="cb127-3" title="3">(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</a></code></pre></div>
<h3 id="context-manager">Context Manager</h3>
<ul>
<li><strong>Enter() should lock the resources and optionally return an object.</strong></li>
<li><strong>Exit() should release the resources.</strong></li>
<li><strong>Any exception that happens inside the with block is passed to the exit() method.</strong></li>
<li><strong>If it wishes to suppress the exception it must return a true value.</strong></li>
</ul>
<div class="sourceCode" id="cb128"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb128-1" title="1"><span class="kw">class</span> MyOpen:</a>
<a class="sourceLine" id="cb128-2" title="2">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, filename):</a>
<a class="sourceLine" id="cb128-3" title="3">        <span class="va">self</span>.filename <span class="op">=</span> filename</a>
<a class="sourceLine" id="cb128-4" title="4">    <span class="kw">def</span> <span class="fu">__enter__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb128-5" title="5">        <span class="va">self</span>.<span class="bu">file</span> <span class="op">=</span> <span class="bu">open</span>(<span class="va">self</span>.filename)</a>
<a class="sourceLine" id="cb128-6" title="6">        <span class="cf">return</span> <span class="va">self</span>.<span class="bu">file</span></a>
<a class="sourceLine" id="cb128-7" title="7">    <span class="kw">def</span> <span class="fu">__exit__</span>(<span class="va">self</span>, exc_type, exception, traceback):</a>
<a class="sourceLine" id="cb128-8" title="8">        <span class="va">self</span>.<span class="bu">file</span>.close()</a></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb129-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;test.txt&#39;</span>, <span class="st">&#39;w&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb129-2" title="2">...     <span class="bu">file</span>.write(<span class="st">&#39;Hello World!&#39;</span>)</a>
<a class="sourceLine" id="cb129-3" title="3"><span class="op">&gt;&gt;&gt;</span> <span class="cf">with</span> MyOpen(<span class="st">&#39;test.txt&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb129-4" title="4">...     <span class="bu">print</span>(<span class="bu">file</span>.read())</a>
<a class="sourceLine" id="cb129-5" title="5">Hello World<span class="op">!</span></a></code></pre></div>
<h2 id="iterable-duck-types">Iterable Duck Types</h2>
<h3 id="iterable">Iterable</h3>
<ul>
<li><strong>Only required method is iter(). It should return an iterator of object’s items.</strong></li>
<li><strong>Contains() automatically works on any object that has iter() defined.</strong></li>
</ul>
<div class="sourceCode" id="cb130"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb130-1" title="1"><span class="kw">class</span> MyIterable:</a>
<a class="sourceLine" id="cb130-2" title="2">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a):</a>
<a class="sourceLine" id="cb130-3" title="3">        <span class="va">self</span>.a <span class="op">=</span> a</a>
<a class="sourceLine" id="cb130-4" title="4">    <span class="kw">def</span> <span class="fu">__iter__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb130-5" title="5">        <span class="cf">return</span> <span class="bu">iter</span>(<span class="va">self</span>.a)</a>
<a class="sourceLine" id="cb130-6" title="6">    <span class="kw">def</span> <span class="fu">__contains__</span>(<span class="va">self</span>, el):</a>
<a class="sourceLine" id="cb130-7" title="7">        <span class="cf">return</span> el <span class="kw">in</span> <span class="va">self</span>.a</a></code></pre></div>
<div class="sourceCode" id="cb131"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb131-1" title="1"><span class="op">&gt;&gt;&gt;</span> obj <span class="op">=</span> MyIterable([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</a>
<a class="sourceLine" id="cb131-2" title="2"><span class="op">&gt;&gt;&gt;</span> [el <span class="cf">for</span> el <span class="kw">in</span> obj]</a>
<a class="sourceLine" id="cb131-3" title="3">[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</a>
<a class="sourceLine" id="cb131-4" title="4"><span class="op">&gt;&gt;&gt;</span> <span class="dv">1</span> <span class="kw">in</span> obj</a>
<a class="sourceLine" id="cb131-5" title="5"><span class="va">True</span></a></code></pre></div>
<h3 id="collection">Collection</h3>
<ul>
<li><strong>Only required methods are iter() and len().</strong></li>
<li><strong>This cheatsheet actually means <code>'&lt;iterable&gt;'</code> when it uses <code>'&lt;collection&gt;'</code>.</strong></li>
<li><strong>I chose not to use the name ‘iterable’ because it sounds scarier and more vague than ‘collection’.</strong></li>
</ul>
<div class="sourceCode" id="cb132"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb132-1" title="1"><span class="kw">class</span> MyCollection:</a>
<a class="sourceLine" id="cb132-2" title="2">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a):</a>
<a class="sourceLine" id="cb132-3" title="3">        <span class="va">self</span>.a <span class="op">=</span> a</a>
<a class="sourceLine" id="cb132-4" title="4">    <span class="kw">def</span> <span class="fu">__iter__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb132-5" title="5">        <span class="cf">return</span> <span class="bu">iter</span>(<span class="va">self</span>.a)</a>
<a class="sourceLine" id="cb132-6" title="6">    <span class="kw">def</span> <span class="fu">__contains__</span>(<span class="va">self</span>, el):</a>
<a class="sourceLine" id="cb132-7" title="7">        <span class="cf">return</span> el <span class="kw">in</span> <span class="va">self</span>.a</a>
<a class="sourceLine" id="cb132-8" title="8">    <span class="kw">def</span> <span class="fu">__len__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb132-9" title="9">        <span class="cf">return</span> <span class="bu">len</span>(<span class="va">self</span>.a)</a></code></pre></div>
<h3 id="sequence">Sequence</h3>
<ul>
<li><strong>Only required methods are len() and getitem().</strong></li>
<li><strong>Getitem() should return an item at index or raise IndexError.</strong></li>
<li><strong>Iter() and contains() automatically work on any object that has getitem() defined.</strong></li>
<li><strong>Reversed() automatically works on any object that has getitem() and len() defined.</strong></li>
</ul>
<div class="sourceCode" id="cb133"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb133-1" title="1"><span class="kw">class</span> MySequence:</a>
<a class="sourceLine" id="cb133-2" title="2">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a):</a>
<a class="sourceLine" id="cb133-3" title="3">        <span class="va">self</span>.a <span class="op">=</span> a</a>
<a class="sourceLine" id="cb133-4" title="4">    <span class="kw">def</span> <span class="fu">__iter__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb133-5" title="5">        <span class="cf">return</span> <span class="bu">iter</span>(<span class="va">self</span>.a)</a>
<a class="sourceLine" id="cb133-6" title="6">    <span class="kw">def</span> <span class="fu">__contains__</span>(<span class="va">self</span>, el):</a>
<a class="sourceLine" id="cb133-7" title="7">        <span class="cf">return</span> el <span class="kw">in</span> <span class="va">self</span>.a</a>
<a class="sourceLine" id="cb133-8" title="8">    <span class="kw">def</span> <span class="fu">__len__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb133-9" title="9">        <span class="cf">return</span> <span class="bu">len</span>(<span class="va">self</span>.a)</a>
<a class="sourceLine" id="cb133-10" title="10">    <span class="kw">def</span> <span class="fu">__getitem__</span>(<span class="va">self</span>, i):</a>
<a class="sourceLine" id="cb133-11" title="11">        <span class="cf">return</span> <span class="va">self</span>.a[i]</a>
<a class="sourceLine" id="cb133-12" title="12">    <span class="kw">def</span> <span class="fu">__reversed__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb133-13" title="13">        <span class="cf">return</span> <span class="bu">reversed</span>(<span class="va">self</span>.a)</a></code></pre></div>
<h3 id="abc-sequence">ABC Sequence</h3>
<ul>
<li><strong>It’s a richer interface than the basic sequence.</strong></li>
<li><strong>Extending it generates iter(), contains(), reversed(), index() and count().</strong></li>
<li><strong>Unlike <code>'abc.Iterable'</code> and <code>'abc.Collection'</code>, it is not a duck type. That is why <code>'issubclass(MySequence, abc.Sequence)'</code> would return False even if MySequence had all the methods defined.</strong></li>
</ul>
<div class="sourceCode" id="cb134"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb134-1" title="1"><span class="im">from</span> collections <span class="im">import</span> abc</a>
<a class="sourceLine" id="cb134-2" title="2"></a>
<a class="sourceLine" id="cb134-3" title="3"><span class="kw">class</span> MyAbcSequence(abc.Sequence):</a>
<a class="sourceLine" id="cb134-4" title="4">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a):</a>
<a class="sourceLine" id="cb134-5" title="5">        <span class="va">self</span>.a <span class="op">=</span> a</a>
<a class="sourceLine" id="cb134-6" title="6">    <span class="kw">def</span> <span class="fu">__len__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb134-7" title="7">        <span class="cf">return</span> <span class="bu">len</span>(<span class="va">self</span>.a)</a>
<a class="sourceLine" id="cb134-8" title="8">    <span class="kw">def</span> <span class="fu">__getitem__</span>(<span class="va">self</span>, i):</a>
<a class="sourceLine" id="cb134-9" title="9">        <span class="cf">return</span> <span class="va">self</span>.a[i]</a></code></pre></div>
<h4 id="table-of-required-and-automatically-available-special-methods">Table of required and automatically available special methods:</h4>
<pre class="text"><code>+------------+------------+------------+------------+--------------+
|            |  Iterable  | Collection |  Sequence  | abc.Sequence |
+------------+------------+------------+------------+--------------+
| iter()     |    REQ     |    REQ     |    Yes     |     Yes      |
| contains() |    Yes     |    Yes     |    Yes     |     Yes      |
| len()      |            |    REQ     |    REQ     |     REQ      |
| getitem()  |            |            |    REQ     |     REQ      |
| reversed() |            |            |    Yes     |     Yes      |
| index()    |            |            |            |     Yes      |
| count()    |            |            |            |     Yes      |
+------------+------------+------------+------------+--------------+</code></pre>
<ul>
<li><strong>Other ABCs that generate missing methods are: MutableSequence, Set, MutableSet, Mapping and MutableMapping.</strong></li>
<li><strong>Names of their required methods are stored in <code>'&lt;abc&gt;.__abstractmethods__'</code>.</strong></li>
</ul>
<h2 id="enum">Enum</h2>
<div class="sourceCode" id="cb136"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb136-1" title="1"><span class="im">from</span> enum <span class="im">import</span> Enum, auto</a>
<a class="sourceLine" id="cb136-2" title="2"></a>
<a class="sourceLine" id="cb136-3" title="3"><span class="kw">class</span> <span class="op">&lt;</span>enum_name<span class="op">&gt;</span>(Enum):</a>
<a class="sourceLine" id="cb136-4" title="4">    <span class="op">&lt;</span>member_name_1<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>value_1<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb136-5" title="5">    <span class="op">&lt;</span>member_name_2<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>value_2_a<span class="op">&gt;</span>, <span class="op">&lt;</span>value_2_b<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb136-6" title="6">    <span class="op">&lt;</span>member_name_3<span class="op">&gt;</span> <span class="op">=</span> auto()</a></code></pre></div>
<ul>
<li><strong>If there are no numeric values before auto(), it returns 1.</strong></li>
<li><strong>Otherwise it returns an increment of the last numeric value.</strong></li>
</ul>
<div class="sourceCode" id="cb137"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb137-1" title="1"><span class="op">&lt;</span>member<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>enum<span class="op">&gt;</span>.<span class="op">&lt;</span>member_name<span class="op">&gt;</span>                 <span class="co"># Returns a member.</span></a>
<a class="sourceLine" id="cb137-2" title="2"><span class="op">&lt;</span>member<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>enum<span class="op">&gt;</span>[<span class="st">&#39;&lt;member_name&gt;&#39;</span>]              <span class="co"># Returns a member or raises KeyError.</span></a>
<a class="sourceLine" id="cb137-3" title="3"><span class="op">&lt;</span>member<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>enum<span class="op">&gt;</span>(<span class="op">&lt;</span>value<span class="op">&gt;</span>)                      <span class="co"># Returns a member or raises ValueError.</span></a>
<a class="sourceLine" id="cb137-4" title="4"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>    <span class="op">=</span> <span class="op">&lt;</span>member<span class="op">&gt;</span>.name                        <span class="co"># Returns member&#39;s name.</span></a>
<a class="sourceLine" id="cb137-5" title="5"><span class="op">&lt;</span>obj<span class="op">&gt;</span>    <span class="op">=</span> <span class="op">&lt;</span>member<span class="op">&gt;</span>.value                       <span class="co"># Returns member&#39;s value.</span></a></code></pre></div>
<div class="sourceCode" id="cb138"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb138-1" title="1">list_of_members <span class="op">=</span> <span class="bu">list</span>(<span class="op">&lt;</span>enum<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb138-2" title="2">member_names    <span class="op">=</span> [a.name <span class="cf">for</span> a <span class="kw">in</span> <span class="op">&lt;</span>enum<span class="op">&gt;</span>]</a>
<a class="sourceLine" id="cb138-3" title="3">member_values   <span class="op">=</span> [a.value <span class="cf">for</span> a <span class="kw">in</span> <span class="op">&lt;</span>enum<span class="op">&gt;</span>]</a>
<a class="sourceLine" id="cb138-4" title="4">random_member   <span class="op">=</span> random.choice(<span class="bu">list</span>(<span class="op">&lt;</span>enum<span class="op">&gt;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb139"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb139-1" title="1"><span class="kw">def</span> get_next_member(member):</a>
<a class="sourceLine" id="cb139-2" title="2">    members <span class="op">=</span> <span class="bu">list</span>(member.__class__)</a>
<a class="sourceLine" id="cb139-3" title="3">    index   <span class="op">=</span> (members.index(member) <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(members)</a>
<a class="sourceLine" id="cb139-4" title="4">    <span class="cf">return</span> members[index]</a></code></pre></div>
<h3 id="inline-2">Inline</h3>
<div class="sourceCode" id="cb140"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb140-1" title="1">Cutlery <span class="op">=</span> Enum(<span class="st">&#39;Cutlery&#39;</span>, <span class="st">&#39;fork knife spoon&#39;</span>)</a>
<a class="sourceLine" id="cb140-2" title="2">Cutlery <span class="op">=</span> Enum(<span class="st">&#39;Cutlery&#39;</span>, [<span class="st">&#39;fork&#39;</span>, <span class="st">&#39;knife&#39;</span>, <span class="st">&#39;spoon&#39;</span>])</a>
<a class="sourceLine" id="cb140-3" title="3">Cutlery <span class="op">=</span> Enum(<span class="st">&#39;Cutlery&#39;</span>, {<span class="st">&#39;fork&#39;</span>: <span class="dv">1</span>, <span class="st">&#39;knife&#39;</span>: <span class="dv">2</span>, <span class="st">&#39;spoon&#39;</span>: <span class="dv">3</span>})</a></code></pre></div>
<h4 id="user-defined-functions-cannot-be-values-so-they-must-be-wrapped">User-defined functions cannot be values, so they must be wrapped:</h4>
<div class="sourceCode" id="cb141"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb141-1" title="1"><span class="im">from</span> functools <span class="im">import</span> partial</a>
<a class="sourceLine" id="cb141-2" title="2">LogicOp <span class="op">=</span> Enum(<span class="st">&#39;LogicOp&#39;</span>, {<span class="st">&#39;AND&#39;</span>: partial(<span class="kw">lambda</span> l, r: l <span class="kw">and</span> r),</a>
<a class="sourceLine" id="cb141-3" title="3">                           <span class="st">&#39;OR&#39;</span> : partial(<span class="kw">lambda</span> l, r: l <span class="kw">or</span> r)})</a></code></pre></div>
<ul>
<li><strong>Another solution in this particular case is to use built-in functions and_() and or_() from the module <a href="#operator">operator</a>.</strong></li>
</ul>
<h2 id="exceptions">Exceptions</h2>
<h3 id="basic-example">Basic Example</h3>
<div class="sourceCode" id="cb142"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb142-1" title="1"><span class="cf">try</span>:</a>
<a class="sourceLine" id="cb142-2" title="2">    <span class="op">&lt;</span>code<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb142-3" title="3"><span class="cf">except</span> <span class="op">&lt;</span>exception<span class="op">&gt;</span>:</a>
<a class="sourceLine" id="cb142-4" title="4">    <span class="op">&lt;</span>code<span class="op">&gt;</span></a></code></pre></div>
<h3 id="complex-example">Complex Example</h3>
<div class="sourceCode" id="cb143"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb143-1" title="1"><span class="cf">try</span>:</a>
<a class="sourceLine" id="cb143-2" title="2">    <span class="op">&lt;</span>code_1<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb143-3" title="3"><span class="cf">except</span> <span class="op">&lt;</span>exception_a<span class="op">&gt;</span>:</a>
<a class="sourceLine" id="cb143-4" title="4">    <span class="op">&lt;</span>code_2_a<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb143-5" title="5"><span class="cf">except</span> <span class="op">&lt;</span>exception_b<span class="op">&gt;</span>:</a>
<a class="sourceLine" id="cb143-6" title="6">    <span class="op">&lt;</span>code_2_b<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb143-7" title="7"><span class="cf">else</span>:</a>
<a class="sourceLine" id="cb143-8" title="8">    <span class="op">&lt;</span>code_2_c<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb143-9" title="9"><span class="cf">finally</span>:</a>
<a class="sourceLine" id="cb143-10" title="10">    <span class="op">&lt;</span>code_3<span class="op">&gt;</span></a></code></pre></div>
<ul>
<li><strong>Code inside the <code>'else'</code> block will only be executed if <code>'try'</code> block had no exception.</strong></li>
<li><strong>Code inside the <code>'finally'</code> block will always be executed.</strong></li>
</ul>
<h3 id="catching-exceptions">Catching Exceptions</h3>
<div class="sourceCode" id="cb144"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb144-1" title="1"><span class="cf">except</span> <span class="op">&lt;</span>exception<span class="op">&gt;</span>:</a>
<a class="sourceLine" id="cb144-2" title="2"><span class="cf">except</span> <span class="op">&lt;</span>exception<span class="op">&gt;</span> <span class="im">as</span> <span class="op">&lt;</span>name<span class="op">&gt;</span>:</a>
<a class="sourceLine" id="cb144-3" title="3"><span class="cf">except</span> (<span class="op">&lt;</span>exception<span class="op">&gt;</span>, [...]):</a>
<a class="sourceLine" id="cb144-4" title="4"><span class="cf">except</span> (<span class="op">&lt;</span>exception<span class="op">&gt;</span>, [...]) <span class="im">as</span> <span class="op">&lt;</span>name<span class="op">&gt;</span>:</a></code></pre></div>
<ul>
<li><strong>Also catches subclasses of the exception.</strong></li>
<li><strong>Use <code>'traceback.print_exc()'</code> to print the error message to stderr.</strong></li>
</ul>
<h3 id="raising-exceptions">Raising Exceptions</h3>
<div class="sourceCode" id="cb145"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb145-1" title="1"><span class="cf">raise</span> <span class="op">&lt;</span>exception<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb145-2" title="2"><span class="cf">raise</span> <span class="op">&lt;</span>exception<span class="op">&gt;</span>()</a>
<a class="sourceLine" id="cb145-3" title="3"><span class="cf">raise</span> <span class="op">&lt;</span>exception<span class="op">&gt;</span>(<span class="op">&lt;</span>el<span class="op">&gt;</span> [, ...])</a></code></pre></div>
<h4 id="re-raising-caught-exception">Re-raising caught exception:</h4>
<div class="sourceCode" id="cb146"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb146-1" title="1"><span class="cf">except</span> <span class="op">&lt;</span>exception<span class="op">&gt;</span> <span class="im">as</span> <span class="op">&lt;</span>name<span class="op">&gt;</span>:</a>
<a class="sourceLine" id="cb146-2" title="2">    ...</a>
<a class="sourceLine" id="cb146-3" title="3">    <span class="cf">raise</span></a></code></pre></div>
<h3 id="exception-object">Exception Object</h3>
<div class="sourceCode" id="cb147"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb147-1" title="1">arguments <span class="op">=</span> <span class="op">&lt;</span>name<span class="op">&gt;</span>.args</a>
<a class="sourceLine" id="cb147-2" title="2">exc_type  <span class="op">=</span> <span class="op">&lt;</span>name<span class="op">&gt;</span>.__class__</a>
<a class="sourceLine" id="cb147-3" title="3">filename  <span class="op">=</span> <span class="op">&lt;</span>name<span class="op">&gt;</span>.__traceback__.tb_frame.f_code.co_filename</a>
<a class="sourceLine" id="cb147-4" title="4">func_name <span class="op">=</span> <span class="op">&lt;</span>name<span class="op">&gt;</span>.__traceback__.tb_frame.f_code.co_name</a>
<a class="sourceLine" id="cb147-5" title="5">line      <span class="op">=</span> linecache.getline(filename, <span class="op">&lt;</span>name<span class="op">&gt;</span>.__traceback__.tb_lineno)</a>
<a class="sourceLine" id="cb147-6" title="6">error_msg <span class="op">=</span> traceback.format_exception(exc_type, <span class="op">&lt;</span>name<span class="op">&gt;</span>, <span class="op">&lt;</span>name<span class="op">&gt;</span>.__traceback__)</a></code></pre></div>
<h3 id="built-in-exceptions">Built-in Exceptions</h3>
<pre class="text"><code>BaseException
 +-- SystemExit                   # Raised by the sys.exit() function.
 +-- KeyboardInterrupt            # Raised when the user hits the interrupt key (ctrl-c).
 +-- Exception                    # User-defined exceptions should be derived from this class.
      +-- ArithmeticError         # Base class for arithmetic errors.
      |    +-- ZeroDivisionError  # Raised when dividing by zero.
      +-- AttributeError          # Raised when an attribute is missing.
      +-- EOFError                # Raised by input() when it hits end-of-file condition.
      +-- LookupError             # Raised when a look-up on a collection fails.
      |    +-- IndexError         # Raised when a sequence index is out of range.
      |    +-- KeyError           # Raised when a dictionary key or set element is not found.
      +-- NameError               # Raised when a variable name is not found.
      +-- OSError                 # Failures such as “file not found” or “disk full”.
      |    +-- FileNotFoundError  # When a file or directory is requested but doesn&#39;t exist.
      +-- RuntimeError            # Raised by errors that don&#39;t fall into other categories.
      |    +-- RecursionError     # Raised when the maximum recursion depth is exceeded.
      +-- StopIteration           # Raised by next() when run on an empty iterator.
      +-- TypeError               # Raised when an argument is of wrong type.
      +-- ValueError              # When an argument is of right type but inappropriate value.
           +-- UnicodeError       # Raised when encoding/decoding strings to/from bytes fails.</code></pre>
<h4 id="collections-and-their-exceptions">Collections and their exceptions:</h4>
<pre class="text"><code>+-----------+------------+------------+------------+
|           |    list    |    dict    |    set     |
+-----------+------------+------------+------------+
| getitem() | IndexError |  KeyError  |            |
| pop()     | IndexError |  KeyError  |  KeyError  |
| remove()  | ValueError |            |  KeyError  |
| index()   | ValueError |            |            |
+-----------+------------+------------+------------+</code></pre>
<h4 id="useful-built-in-exceptions">Useful built-in exceptions:</h4>
<div class="sourceCode" id="cb150"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb150-1" title="1"><span class="cf">raise</span> <span class="pp">TypeError</span>(<span class="st">&#39;Argument is of wrong type!&#39;</span>)</a>
<a class="sourceLine" id="cb150-2" title="2"><span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&#39;Argument is of right type but inappropriate value!&#39;</span>)</a>
<a class="sourceLine" id="cb150-3" title="3"><span class="cf">raise</span> <span class="pp">RuntimeError</span>(<span class="st">&#39;None of above!&#39;</span>)</a></code></pre></div>
<h3 id="user-defined-exceptions">User-defined Exceptions</h3>
<div class="sourceCode" id="cb151"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb151-1" title="1"><span class="kw">class</span> MyError(<span class="pp">Exception</span>):</a>
<a class="sourceLine" id="cb151-2" title="2">    <span class="cf">pass</span></a>
<a class="sourceLine" id="cb151-3" title="3"></a>
<a class="sourceLine" id="cb151-4" title="4"><span class="kw">class</span> MyInputError(MyError):</a>
<a class="sourceLine" id="cb151-5" title="5">    <span class="cf">pass</span></a></code></pre></div>
<h2 id="exit">Exit</h2>
<p><strong>Exits the interpreter by raising SystemExit exception.</strong></p>
<div class="sourceCode" id="cb152"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb152-1" title="1"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb152-2" title="2">sys.exit()                        <span class="co"># Exits with exit code 0 (success).</span></a>
<a class="sourceLine" id="cb152-3" title="3">sys.exit(<span class="op">&lt;</span>el<span class="op">&gt;</span>)                    <span class="co"># Prints to stderr and exits with 1.</span></a>
<a class="sourceLine" id="cb152-4" title="4">sys.exit(<span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>)                   <span class="co"># Exits with passed exit code.</span></a></code></pre></div>
<h2 id="print">Print</h2>
<div class="sourceCode" id="cb153"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb153-1" title="1"><span class="bu">print</span>(<span class="op">&lt;</span>el_1<span class="op">&gt;</span>, ..., sep<span class="op">=</span><span class="st">&#39; &#39;</span>, end<span class="op">=</span><span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>, <span class="bu">file</span><span class="op">=</span>sys.stdout, flush<span class="op">=</span><span class="va">False</span>)</a></code></pre></div>
<ul>
<li><strong>Use <code>'file=sys.stderr'</code> for messages about errors.</strong></li>
<li><strong>Use <code>'flush=True'</code> to forcibly flush the stream.</strong></li>
</ul>
<h3 id="pretty-print">Pretty Print</h3>
<div class="sourceCode" id="cb154"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb154-1" title="1"><span class="im">from</span> pprint <span class="im">import</span> pprint</a>
<a class="sourceLine" id="cb154-2" title="2">pprint(<span class="op">&lt;</span>collection<span class="op">&gt;</span>, width<span class="op">=</span><span class="dv">80</span>, depth<span class="op">=</span><span class="va">None</span>, compact<span class="op">=</span><span class="va">False</span>, sort_dicts<span class="op">=</span><span class="va">True</span>)</a></code></pre></div>
<ul>
<li><strong>Levels deeper than ‘depth’ get replaced by ‘…’.</strong></li>
</ul>
<h2 id="input">Input</h2>
<p><strong>Reads a line from user input or pipe if present.</strong></p>
<div class="sourceCode" id="cb155"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb155-1" title="1"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">input</span>(prompt<span class="op">=</span><span class="va">None</span>)</a></code></pre></div>
<ul>
<li><strong>Trailing newline gets stripped.</strong></li>
<li><strong>Prompt string is printed to the standard output before reading input.</strong></li>
<li><strong>Raises EOFError when user hits EOF (ctrl-d/z) or input stream gets exhausted.</strong></li>
</ul>
<h2 id="command-line-arguments">Command Line Arguments</h2>
<div class="sourceCode" id="cb156"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb156-1" title="1"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb156-2" title="2">script_name <span class="op">=</span> sys.argv[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb156-3" title="3">arguments   <span class="op">=</span> sys.argv[<span class="dv">1</span>:]</a></code></pre></div>
<h3 id="argument-parser">Argument Parser</h3>
<div class="sourceCode" id="cb157"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb157-1" title="1"><span class="im">from</span> argparse <span class="im">import</span> ArgumentParser, FileType</a>
<a class="sourceLine" id="cb157-2" title="2">p <span class="op">=</span> ArgumentParser(description<span class="op">=&lt;</span><span class="bu">str</span><span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb157-3" title="3">p.add_argument(<span class="st">&#39;-&lt;short_name&gt;&#39;</span>, <span class="st">&#39;--&lt;name&gt;&#39;</span>, action<span class="op">=</span><span class="st">&#39;store_true&#39;</span>)  <span class="co"># Flag</span></a>
<a class="sourceLine" id="cb157-4" title="4">p.add_argument(<span class="st">&#39;-&lt;short_name&gt;&#39;</span>, <span class="st">&#39;--&lt;name&gt;&#39;</span>, <span class="bu">type</span><span class="op">=&lt;</span><span class="bu">type</span><span class="op">&gt;</span>)          <span class="co"># Option</span></a>
<a class="sourceLine" id="cb157-5" title="5">p.add_argument(<span class="st">&#39;&lt;name&gt;&#39;</span>, <span class="bu">type</span><span class="op">=&lt;</span><span class="bu">type</span><span class="op">&gt;</span>, nargs<span class="op">=</span><span class="dv">1</span>)                    <span class="co"># First argument</span></a>
<a class="sourceLine" id="cb157-6" title="6">p.add_argument(<span class="st">&#39;&lt;name&gt;&#39;</span>, <span class="bu">type</span><span class="op">=&lt;</span><span class="bu">type</span><span class="op">&gt;</span>, nargs<span class="op">=</span><span class="st">&#39;+&#39;</span>)                  <span class="co"># Remaining arguments</span></a>
<a class="sourceLine" id="cb157-7" title="7">p.add_argument(<span class="st">&#39;&lt;name&gt;&#39;</span>, <span class="bu">type</span><span class="op">=&lt;</span><span class="bu">type</span><span class="op">&gt;</span>, nargs<span class="op">=</span><span class="st">&#39;*&#39;</span>)                  <span class="co"># Optional arguments</span></a>
<a class="sourceLine" id="cb157-8" title="8">args  <span class="op">=</span> p.parse_args()                                            <span class="co"># Exits on error.</span></a>
<a class="sourceLine" id="cb157-9" title="9">value <span class="op">=</span> args.<span class="op">&lt;</span>name<span class="op">&gt;</span></a></code></pre></div>
<ul>
<li><strong>Use <code>'help=&lt;str&gt;'</code> to set argument description.</strong></li>
<li><strong>Use <code>'default=&lt;el&gt;'</code> to set the default value.</strong></li>
<li><strong>Use <code>'type=FileType(&lt;mode&gt;)'</code> for files.</strong></li>
</ul>
<h2 id="open">Open</h2>
<p><strong>Opens the file and returns a corresponding file object.</strong></p>
<div class="sourceCode" id="cb158"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb158-1" title="1"><span class="op">&lt;</span><span class="bu">file</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">open</span>(<span class="st">&#39;&lt;path&gt;&#39;</span>, mode<span class="op">=</span><span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="va">None</span>, newline<span class="op">=</span><span class="va">None</span>)</a></code></pre></div>
<ul>
<li><strong><code>'encoding=None'</code> means that the default encoding is used, which is platform dependent. Best practice is to use <code>'encoding="utf-8"'</code> whenever possible.</strong></li>
<li><strong><code>'newline=None'</code> means all different end of line combinations are converted to ‘’ on read, while on write all ‘’ characters are converted to system’s default line separator.</strong></li>
<li><strong><code>'newline=""'</code> means no conversions take place, but input is still broken into chunks by readline() and readlines() on either ‘’, ‘ or’’.</strong></li>
</ul>
<h3 id="modes">Modes</h3>
<ul>
<li><strong><code>'r'</code> - Read (default).</strong></li>
<li><strong><code>'w'</code> - Write (truncate).</strong></li>
<li><strong><code>'x'</code> - Write or fail if the file already exists.</strong></li>
<li><strong><code>'a'</code> - Append.</strong></li>
<li><strong><code>'w+'</code> - Read and write (truncate).</strong></li>
<li><strong><code>'r+'</code> - Read and write from the start.</strong></li>
<li><strong><code>'a+'</code> - Read and write from the end.</strong></li>
<li><strong><code>'t'</code> - Text mode (default).</strong></li>
<li><strong><code>'b'</code> - Binary mode.</strong></li>
</ul>
<h3 id="exceptions-1">Exceptions</h3>
<ul>
<li><strong><code>'FileNotFoundError'</code> can be raised when reading with <code>'r'</code> or <code>'r+'</code>.</strong></li>
<li><strong><code>'FileExistsError'</code> can be raised when writing with <code>'x'</code>.</strong></li>
<li><strong><code>'IsADirectoryError'</code> and <code>'PermissionError'</code> can be raised by any.</strong></li>
<li><strong><code>'OSError'</code> is the parent class of all listed exceptions.</strong></li>
</ul>
<h3 id="file-object">File Object</h3>
<div class="sourceCode" id="cb159"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb159-1" title="1"><span class="op">&lt;</span><span class="bu">file</span><span class="op">&gt;</span>.seek(<span class="dv">0</span>)                      <span class="co"># Moves to the start of the file.</span></a>
<a class="sourceLine" id="cb159-2" title="2"><span class="op">&lt;</span><span class="bu">file</span><span class="op">&gt;</span>.seek(offset)                 <span class="co"># Moves &#39;offset&#39; chars/bytes from the start.</span></a>
<a class="sourceLine" id="cb159-3" title="3"><span class="op">&lt;</span><span class="bu">file</span><span class="op">&gt;</span>.seek(<span class="dv">0</span>, <span class="dv">2</span>)                   <span class="co"># Moves to the end of the file.</span></a>
<a class="sourceLine" id="cb159-4" title="4"><span class="op">&lt;</span>bin_file<span class="op">&gt;</span>.seek(±offset, <span class="op">&lt;</span>anchor<span class="op">&gt;</span>)  <span class="co"># Anchor: 0 start, 1 current position, 2 end.</span></a></code></pre></div>
<div class="sourceCode" id="cb160"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb160-1" title="1"><span class="op">&lt;</span><span class="bu">str</span><span class="op">/</span><span class="bu">bytes</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">file</span><span class="op">&gt;</span>.read(size<span class="op">=-</span><span class="dv">1</span>)  <span class="co"># Reads &#39;size&#39; chars/bytes or until EOF.</span></a>
<a class="sourceLine" id="cb160-2" title="2"><span class="op">&lt;</span><span class="bu">str</span><span class="op">/</span><span class="bu">bytes</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">file</span><span class="op">&gt;</span>.readline()     <span class="co"># Returns a line or empty string/bytes on EOF.</span></a>
<a class="sourceLine" id="cb160-3" title="3"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>      <span class="op">=</span> <span class="op">&lt;</span><span class="bu">file</span><span class="op">&gt;</span>.readlines()    <span class="co"># Returns a list of remaining lines.</span></a>
<a class="sourceLine" id="cb160-4" title="4"><span class="op">&lt;</span><span class="bu">str</span><span class="op">/</span><span class="bu">bytes</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">next</span>(<span class="op">&lt;</span><span class="bu">file</span><span class="op">&gt;</span>)          <span class="co"># Returns a line using buffer. Do not mix.</span></a></code></pre></div>
<div class="sourceCode" id="cb161"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb161-1" title="1"><span class="op">&lt;</span><span class="bu">file</span><span class="op">&gt;</span>.write(<span class="op">&lt;</span><span class="bu">str</span><span class="op">/</span><span class="bu">bytes</span><span class="op">&gt;</span>)           <span class="co"># Writes a string or bytes object.</span></a>
<a class="sourceLine" id="cb161-2" title="2"><span class="op">&lt;</span><span class="bu">file</span><span class="op">&gt;</span>.writelines(<span class="op">&lt;</span>collection<span class="op">&gt;</span>)     <span class="co"># Writes a coll. of strings or bytes objects.</span></a>
<a class="sourceLine" id="cb161-3" title="3"><span class="op">&lt;</span><span class="bu">file</span><span class="op">&gt;</span>.flush()                      <span class="co"># Flushes write buffer.</span></a></code></pre></div>
<ul>
<li><strong>Methods do not add or strip trailing newlines, even writelines().</strong></li>
</ul>
<h3 id="read-text-from-file">Read Text from File</h3>
<div class="sourceCode" id="cb162"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb162-1" title="1"><span class="kw">def</span> read_file(filename):</a>
<a class="sourceLine" id="cb162-2" title="2">    <span class="cf">with</span> <span class="bu">open</span>(filename, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb162-3" title="3">        <span class="cf">return</span> <span class="bu">file</span>.readlines()</a></code></pre></div>
<h3 id="write-text-to-file">Write Text to File</h3>
<div class="sourceCode" id="cb163"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb163-1" title="1"><span class="kw">def</span> write_to_file(filename, text):</a>
<a class="sourceLine" id="cb163-2" title="2">    <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb163-3" title="3">        <span class="bu">file</span>.write(text)</a></code></pre></div>
<h2 id="path">Path</h2>
<div class="sourceCode" id="cb164"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb164-1" title="1"><span class="im">from</span> os <span class="im">import</span> getcwd, path, listdir</a>
<a class="sourceLine" id="cb164-2" title="2"><span class="im">from</span> glob <span class="im">import</span> glob</a></code></pre></div>
<div class="sourceCode" id="cb165"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb165-1" title="1"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> getcwd()                   <span class="co"># Returns the current working directory.</span></a>
<a class="sourceLine" id="cb165-2" title="2"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> path.join(<span class="op">&lt;</span>path<span class="op">&gt;</span>, ...)     <span class="co"># Joins two or more pathname components.</span></a>
<a class="sourceLine" id="cb165-3" title="3"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> path.abspath(<span class="op">&lt;</span>path<span class="op">&gt;</span>)       <span class="co"># Returns absolute path.</span></a></code></pre></div>
<div class="sourceCode" id="cb166"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb166-1" title="1"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> path.basename(<span class="op">&lt;</span>path<span class="op">&gt;</span>)      <span class="co"># Returns final component of the path.</span></a>
<a class="sourceLine" id="cb166-2" title="2"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> path.dirname(<span class="op">&lt;</span>path<span class="op">&gt;</span>)       <span class="co"># Returns path without the final component.</span></a>
<a class="sourceLine" id="cb166-3" title="3"><span class="op">&lt;</span>tup.<span class="op">&gt;</span> <span class="op">=</span> path.splitext(<span class="op">&lt;</span>path<span class="op">&gt;</span>)      <span class="co"># Splits on last period of the final component.</span></a></code></pre></div>
<div class="sourceCode" id="cb167"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb167-1" title="1"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span> <span class="op">=</span> listdir(path<span class="op">=</span><span class="st">&#39;.&#39;</span>)          <span class="co"># Returns filenames located at path.</span></a>
<a class="sourceLine" id="cb167-2" title="2"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span> <span class="op">=</span> glob(<span class="st">&#39;&lt;pattern&gt;&#39;</span>)          <span class="co"># Returns paths matching the wildcard pattern.</span></a></code></pre></div>
<div class="sourceCode" id="cb168"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb168-1" title="1"><span class="op">&lt;</span><span class="bu">bool</span><span class="op">&gt;</span> <span class="op">=</span> path.exists(<span class="op">&lt;</span>path<span class="op">&gt;</span>)        <span class="co"># Or: &lt;Path&gt;.exists()</span></a>
<a class="sourceLine" id="cb168-2" title="2"><span class="op">&lt;</span><span class="bu">bool</span><span class="op">&gt;</span> <span class="op">=</span> path.isfile(<span class="op">&lt;</span>path<span class="op">&gt;</span>)        <span class="co"># Or: &lt;DirEntry/Path&gt;.is_file()</span></a>
<a class="sourceLine" id="cb168-3" title="3"><span class="op">&lt;</span><span class="bu">bool</span><span class="op">&gt;</span> <span class="op">=</span> path.isdir(<span class="op">&lt;</span>path<span class="op">&gt;</span>)         <span class="co"># Or: &lt;DirEntry/Path&gt;.is_dir()</span></a></code></pre></div>
<h3 id="direntry">DirEntry</h3>
<p><strong>Using scandir() instead of listdir() can significantly increase the performance of code that also needs file type information.</strong></p>
<div class="sourceCode" id="cb169"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb169-1" title="1"><span class="im">from</span> os <span class="im">import</span> scandir</a></code></pre></div>
<div class="sourceCode" id="cb170"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb170-1" title="1"><span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span> <span class="op">=</span> scandir(path<span class="op">=</span><span class="st">&#39;.&#39;</span>)          <span class="co"># Returns DirEntry objects located at path.</span></a>
<a class="sourceLine" id="cb170-2" title="2"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span>DirEntry<span class="op">&gt;</span>.path            <span class="co"># Returns path as a string.</span></a>
<a class="sourceLine" id="cb170-3" title="3"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span>DirEntry<span class="op">&gt;</span>.name            <span class="co"># Returns final component as a string.</span></a>
<a class="sourceLine" id="cb170-4" title="4"><span class="op">&lt;</span><span class="bu">file</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">open</span>(<span class="op">&lt;</span>DirEntry<span class="op">&gt;</span>)           <span class="co"># Opens the file and returns file object.</span></a></code></pre></div>
<h3 id="path-object">Path Object</h3>
<div class="sourceCode" id="cb171"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb171-1" title="1"><span class="im">from</span> pathlib <span class="im">import</span> Path</a></code></pre></div>
<div class="sourceCode" id="cb172"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb172-1" title="1"><span class="op">&lt;</span>Path<span class="op">&gt;</span> <span class="op">=</span> Path(<span class="op">&lt;</span>path<span class="op">&gt;</span> [, ...])       <span class="co"># Accepts strings, Paths and DirEntry objects.</span></a>
<a class="sourceLine" id="cb172-2" title="2"><span class="op">&lt;</span>Path<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>path<span class="op">&gt;</span> <span class="op">/</span> <span class="op">&lt;</span>path<span class="op">&gt;</span> [<span class="op">/</span> ...]    <span class="co"># One of the paths must be a Path object.</span></a></code></pre></div>
<div class="sourceCode" id="cb173"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb173-1" title="1"><span class="op">&lt;</span>Path<span class="op">&gt;</span> <span class="op">=</span> Path()                     <span class="co"># Returns relative cwd. Also Path(&#39;.&#39;).</span></a>
<a class="sourceLine" id="cb173-2" title="2"><span class="op">&lt;</span>Path<span class="op">&gt;</span> <span class="op">=</span> Path.cwd()                 <span class="co"># Returns absolute cwd. Also Path().resolve().</span></a>
<a class="sourceLine" id="cb173-3" title="3"><span class="op">&lt;</span>Path<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Path<span class="op">&gt;</span>.resolve()           <span class="co"># Returns absolute Path without symlinks.</span></a></code></pre></div>
<div class="sourceCode" id="cb174"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb174-1" title="1"><span class="op">&lt;</span>Path<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Path<span class="op">&gt;</span>.parent              <span class="co"># Returns Path without final component.</span></a>
<a class="sourceLine" id="cb174-2" title="2"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span>Path<span class="op">&gt;</span>.name                <span class="co"># Returns final component as a string.</span></a>
<a class="sourceLine" id="cb174-3" title="3"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span>Path<span class="op">&gt;</span>.stem                <span class="co"># Returns final component without extension.</span></a>
<a class="sourceLine" id="cb174-4" title="4"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span>Path<span class="op">&gt;</span>.suffix              <span class="co"># Returns final component&#39;s extension.</span></a>
<a class="sourceLine" id="cb174-5" title="5"><span class="op">&lt;</span>tup.<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Path<span class="op">&gt;</span>.parts               <span class="co"># Returns all components as strings.</span></a></code></pre></div>
<div class="sourceCode" id="cb175"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb175-1" title="1"><span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Path<span class="op">&gt;</span>.iterdir()           <span class="co"># Returns dir contents as Path objects.</span></a>
<a class="sourceLine" id="cb175-2" title="2"><span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Path<span class="op">&gt;</span>.glob(<span class="st">&#39;&lt;pattern&gt;&#39;</span>)   <span class="co"># Returns Paths matching the wildcard pattern.</span></a></code></pre></div>
<div class="sourceCode" id="cb176"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb176-1" title="1"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="bu">str</span>(<span class="op">&lt;</span>Path<span class="op">&gt;</span>)                <span class="co"># Returns path as a string.</span></a>
<a class="sourceLine" id="cb176-2" title="2"><span class="op">&lt;</span><span class="bu">file</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">open</span>(<span class="op">&lt;</span>Path<span class="op">&gt;</span>)               <span class="co"># Opens the file and returns file object.</span></a></code></pre></div>
<h2 id="os-commands">OS Commands</h2>
<h3 id="files-and-directories">Files and Directories</h3>
<ul>
<li><strong>Paths can be either strings, Paths or DirEntry objects.</strong></li>
<li><strong>Functions report OS related errors by raising either OSError or one of its <a href="#exceptions-1">subclasses</a>.</strong></li>
</ul>
<div class="sourceCode" id="cb177"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb177-1" title="1"><span class="im">import</span> os, shutil</a></code></pre></div>
<div class="sourceCode" id="cb178"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb178-1" title="1">os.chdir(<span class="op">&lt;</span>path<span class="op">&gt;</span>)                    <span class="co"># Changes the current working directory.</span></a>
<a class="sourceLine" id="cb178-2" title="2">os.mkdir(<span class="op">&lt;</span>path<span class="op">&gt;</span>, mode<span class="op">=</span><span class="dv">0o777</span>)        <span class="co"># Creates a directory. Mode is in octal.</span></a></code></pre></div>
<div class="sourceCode" id="cb179"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb179-1" title="1">shutil.copy(<span class="im">from</span>, to)               <span class="co"># Copies the file. &#39;to&#39; can exist or be a dir.</span></a>
<a class="sourceLine" id="cb179-2" title="2">shutil.copytree(<span class="im">from</span>, to)           <span class="co"># Copies the directory. &#39;to&#39; must not exist.</span></a></code></pre></div>
<div class="sourceCode" id="cb180"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb180-1" title="1">os.rename(<span class="im">from</span>, to)                 <span class="co"># Renames/moves the file or directory.</span></a>
<a class="sourceLine" id="cb180-2" title="2">os.replace(<span class="im">from</span>, to)                <span class="co"># Same, but overwrites &#39;to&#39; if it exists.</span></a></code></pre></div>
<div class="sourceCode" id="cb181"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb181-1" title="1">os.remove(<span class="op">&lt;</span>path<span class="op">&gt;</span>)                   <span class="co"># Deletes the file.</span></a>
<a class="sourceLine" id="cb181-2" title="2">os.rmdir(<span class="op">&lt;</span>path<span class="op">&gt;</span>)                    <span class="co"># Deletes the empty directory.</span></a>
<a class="sourceLine" id="cb181-3" title="3">shutil.rmtree(<span class="op">&lt;</span>path<span class="op">&gt;</span>)               <span class="co"># Deletes the directory.</span></a></code></pre></div>
<h3 id="shell-commands">Shell Commands</h3>
<div class="sourceCode" id="cb182"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb182-1" title="1"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb182-2" title="2"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span> <span class="op">=</span> os.popen(<span class="st">&#39;&lt;shell_command&gt;&#39;</span>).read()</a></code></pre></div>
<h4 id="sends-1-1-to-the-basic-calculator-and-captures-its-output">Sends ‘1 + 1’ to the basic calculator and captures its output:</h4>
<div class="sourceCode" id="cb183"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb183-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> subprocess <span class="im">import</span> run</a>
<a class="sourceLine" id="cb183-2" title="2"><span class="op">&gt;&gt;&gt;</span> run(<span class="st">&#39;bc&#39;</span>, <span class="bu">input</span><span class="op">=</span><span class="st">&#39;1 + 1</span><span class="ch">\n</span><span class="st">&#39;</span>, capture_output<span class="op">=</span><span class="va">True</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>)</a>
<a class="sourceLine" id="cb183-3" title="3">CompletedProcess(args<span class="op">=</span><span class="st">&#39;bc&#39;</span>, returncode<span class="op">=</span><span class="dv">0</span>, stdout<span class="op">=</span><span class="st">&#39;2</span><span class="ch">\n</span><span class="st">&#39;</span>, stderr<span class="op">=</span><span class="st">&#39;&#39;</span>)</a></code></pre></div>
<h4 id="sends-test.in-to-the-basic-calculator-running-in-standard-mode-and-saves-its-output-to-test.out">Sends test.in to the basic calculator running in standard mode and saves its output to test.out:</h4>
<div class="sourceCode" id="cb184"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb184-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> shlex <span class="im">import</span> split</a>
<a class="sourceLine" id="cb184-2" title="2"><span class="op">&gt;&gt;&gt;</span> os.popen(<span class="st">&#39;echo 1 + 1 &gt; test.in&#39;</span>)</a>
<a class="sourceLine" id="cb184-3" title="3"><span class="op">&gt;&gt;&gt;</span> run(split(<span class="st">&#39;bc -s&#39;</span>), stdin<span class="op">=</span><span class="bu">open</span>(<span class="st">&#39;test.in&#39;</span>), stdout<span class="op">=</span><span class="bu">open</span>(<span class="st">&#39;test.out&#39;</span>, <span class="st">&#39;w&#39;</span>))</a>
<a class="sourceLine" id="cb184-4" title="4">CompletedProcess(args<span class="op">=</span>[<span class="st">&#39;bc&#39;</span>, <span class="st">&#39;-s&#39;</span>], returncode<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb184-5" title="5"><span class="op">&gt;&gt;&gt;</span> <span class="bu">open</span>(<span class="st">&#39;test.out&#39;</span>).read()</a>
<a class="sourceLine" id="cb184-6" title="6"><span class="co">&#39;2</span><span class="ch">\n</span><span class="co">&#39;</span></a></code></pre></div>
<h2 id="json">JSON</h2>
<p><strong>Text file format for storing collections of strings and numbers.</strong></p>
<div class="sourceCode" id="cb185"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb185-1" title="1"><span class="im">import</span> json</a>
<a class="sourceLine" id="cb185-2" title="2"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>    <span class="op">=</span> json.dumps(<span class="op">&lt;</span><span class="bu">object</span><span class="op">&gt;</span>, ensure_ascii<span class="op">=</span><span class="va">True</span>, indent<span class="op">=</span><span class="va">None</span>)</a>
<a class="sourceLine" id="cb185-3" title="3"><span class="op">&lt;</span><span class="bu">object</span><span class="op">&gt;</span> <span class="op">=</span> json.loads(<span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>)</a></code></pre></div>
<h3 id="read-object-from-json-file">Read Object from JSON File</h3>
<div class="sourceCode" id="cb186"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb186-1" title="1"><span class="kw">def</span> read_json_file(filename):</a>
<a class="sourceLine" id="cb186-2" title="2">    <span class="cf">with</span> <span class="bu">open</span>(filename, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb186-3" title="3">        <span class="cf">return</span> json.load(<span class="bu">file</span>)</a></code></pre></div>
<h3 id="write-object-to-json-file">Write Object to JSON File</h3>
<div class="sourceCode" id="cb187"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb187-1" title="1"><span class="kw">def</span> write_to_json_file(filename, an_object):</a>
<a class="sourceLine" id="cb187-2" title="2">    <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb187-3" title="3">        json.dump(an_object, <span class="bu">file</span>, ensure_ascii<span class="op">=</span><span class="va">False</span>, indent<span class="op">=</span><span class="dv">2</span>)</a></code></pre></div>
<h2 id="pickle">Pickle</h2>
<p><strong>Binary file format for storing objects.</strong></p>
<div class="sourceCode" id="cb188"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb188-1" title="1"><span class="im">import</span> pickle</a>
<a class="sourceLine" id="cb188-2" title="2"><span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span>  <span class="op">=</span> pickle.dumps(<span class="op">&lt;</span><span class="bu">object</span><span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb188-3" title="3"><span class="op">&lt;</span><span class="bu">object</span><span class="op">&gt;</span> <span class="op">=</span> pickle.loads(<span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span>)</a></code></pre></div>
<h3 id="read-object-from-file">Read Object from File</h3>
<div class="sourceCode" id="cb189"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb189-1" title="1"><span class="kw">def</span> read_pickle_file(filename):</a>
<a class="sourceLine" id="cb189-2" title="2">    <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb189-3" title="3">        <span class="cf">return</span> pickle.load(<span class="bu">file</span>)</a></code></pre></div>
<h3 id="write-object-to-file">Write Object to File</h3>
<div class="sourceCode" id="cb190"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb190-1" title="1"><span class="kw">def</span> write_to_pickle_file(filename, an_object):</a>
<a class="sourceLine" id="cb190-2" title="2">    <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb190-3" title="3">        pickle.dump(an_object, <span class="bu">file</span>)</a></code></pre></div>
<h2 id="csv">CSV</h2>
<p><strong>Text file format for storing spreadsheets.</strong></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb191-1" title="1"><span class="im">import</span> csv</a></code></pre></div>
<h3 id="read">Read</h3>
<div class="sourceCode" id="cb192"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb192-1" title="1"><span class="op">&lt;</span>reader<span class="op">&gt;</span> <span class="op">=</span> csv.reader(<span class="op">&lt;</span><span class="bu">file</span><span class="op">&gt;</span>)       <span class="co"># Also: `dialect=&#39;excel&#39;, delimiter=&#39;,&#39;`.</span></a>
<a class="sourceLine" id="cb192-2" title="2"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>   <span class="op">=</span> <span class="bu">next</span>(<span class="op">&lt;</span>reader<span class="op">&gt;</span>)           <span class="co"># Returns next row as a list of strings.</span></a>
<a class="sourceLine" id="cb192-3" title="3"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>   <span class="op">=</span> <span class="bu">list</span>(<span class="op">&lt;</span>reader<span class="op">&gt;</span>)           <span class="co"># Returns list of remaining rows.</span></a></code></pre></div>
<ul>
<li><strong>File must be opened with <code>'newline=""'</code> argument, or newlines embedded inside quoted fields will not be interpreted correctly!</strong></li>
</ul>
<h3 id="write">Write</h3>
<div class="sourceCode" id="cb193"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb193-1" title="1"><span class="op">&lt;</span>writer<span class="op">&gt;</span> <span class="op">=</span> csv.writer(<span class="op">&lt;</span><span class="bu">file</span><span class="op">&gt;</span>)       <span class="co"># Also: `dialect=&#39;excel&#39;, delimiter=&#39;,&#39;`.</span></a>
<a class="sourceLine" id="cb193-2" title="2"><span class="op">&lt;</span>writer<span class="op">&gt;</span>.writerow(<span class="op">&lt;</span>collection<span class="op">&gt;</span>)     <span class="co"># Encodes objects using `str(&lt;el&gt;)`.</span></a>
<a class="sourceLine" id="cb193-3" title="3"><span class="op">&lt;</span>writer<span class="op">&gt;</span>.writerows(<span class="op">&lt;</span>coll_of_coll<span class="op">&gt;</span>)  <span class="co"># Appends multiple rows.</span></a></code></pre></div>
<ul>
<li><strong>File must be opened with <code>'newline=""'</code> argument, or ‘ will be added in front of every’’ on platforms that use ‘’ line endings!</strong></li>
</ul>
<h3 id="parameters">Parameters</h3>
<ul>
<li><strong><code>'dialect'</code> - Master parameter that sets the default values.</strong></li>
<li><strong><code>'delimiter'</code> - A one-character string used to separate fields.</strong></li>
<li><strong><code>'quotechar'</code> - Character for quoting fields that contain special characters.</strong></li>
<li><strong><code>'doublequote'</code> - Whether quotechars inside fields get doubled or escaped.</strong></li>
<li><strong><code>'skipinitialspace'</code> - Whether whitespace after delimiter gets stripped.</strong></li>
<li><strong><code>'lineterminator'</code> - Specifies how writer terminates rows.</strong></li>
<li><strong><code>'quoting'</code> - Controls the amount of quoting: 0 - as necessary, 1 - all.</strong></li>
<li><strong><code>'escapechar'</code> - Character for escaping ‘quotechar’ if ‘doublequote’ is False.</strong></li>
</ul>
<h3 id="dialects">Dialects</h3>
<pre class="text"><code>+------------------+--------------+--------------+--------------+
|                  |     excel    |   excel-tab  |     unix     |
+------------------+--------------+--------------+--------------+
| delimiter        |       &#39;,&#39;    |      &#39;\t&#39;    |       &#39;,&#39;    |
| quotechar        |       &#39;&quot;&#39;    |       &#39;&quot;&#39;    |       &#39;&quot;&#39;    |
| doublequote      |      True    |      True    |      True    |
| skipinitialspace |     False    |     False    |     False    |
| lineterminator   |    &#39;\r\n&#39;    |    &#39;\r\n&#39;    |      &#39;\n&#39;    |
| quoting          |         0    |         0    |         1    |
| escapechar       |      None    |      None    |      None    |
+------------------+--------------+--------------+--------------+</code></pre>
<h3 id="read-rows-from-csv-file">Read Rows from CSV File</h3>
<div class="sourceCode" id="cb195"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb195-1" title="1"><span class="kw">def</span> read_csv_file(filename):</a>
<a class="sourceLine" id="cb195-2" title="2">    <span class="cf">with</span> <span class="bu">open</span>(filename, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, newline<span class="op">=</span><span class="st">&#39;&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb195-3" title="3">        <span class="cf">return</span> <span class="bu">list</span>(csv.reader(<span class="bu">file</span>))</a></code></pre></div>
<h3 id="write-rows-to-csv-file">Write Rows to CSV File</h3>
<div class="sourceCode" id="cb196"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb196-1" title="1"><span class="kw">def</span> write_to_csv_file(filename, rows):</a>
<a class="sourceLine" id="cb196-2" title="2">    <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, newline<span class="op">=</span><span class="st">&#39;&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb196-3" title="3">        writer <span class="op">=</span> csv.writer(<span class="bu">file</span>)</a>
<a class="sourceLine" id="cb196-4" title="4">        writer.writerows(rows)</a></code></pre></div>
<h2 id="sqlite">SQLite</h2>
<p><strong>Server-less database engine that stores each database into a separate file.</strong></p>
<h3 id="connect">Connect</h3>
<p><strong>Opens a connection to the database file. Creates a new file if path doesn’t exist.</strong></p>
<div class="sourceCode" id="cb197"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb197-1" title="1"><span class="im">import</span> sqlite3</a>
<a class="sourceLine" id="cb197-2" title="2"><span class="op">&lt;</span>con<span class="op">&gt;</span> <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">&#39;&lt;path&gt;&#39;</span>)               <span class="co"># Also &#39;:memory:&#39;.</span></a>
<a class="sourceLine" id="cb197-3" title="3"><span class="op">&lt;</span>con<span class="op">&gt;</span>.close()                                   <span class="co"># Closes the connection.</span></a></code></pre></div>
<h3 id="read-1">Read</h3>
<p><strong>Returned values can be of type str, int, float, bytes or None.</strong></p>
<div class="sourceCode" id="cb198"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb198-1" title="1"><span class="op">&lt;</span>cursor<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>con<span class="op">&gt;</span>.execute(<span class="st">&#39;&lt;query&gt;&#39;</span>)             <span class="co"># Can raise a subclass of sqlite3.Error.</span></a>
<a class="sourceLine" id="cb198-2" title="2"><span class="op">&lt;</span><span class="bu">tuple</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span>cursor<span class="op">&gt;</span>.fetchone()                  <span class="co"># Returns next row. Also next(&lt;cursor&gt;).</span></a>
<a class="sourceLine" id="cb198-3" title="3"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>   <span class="op">=</span> <span class="op">&lt;</span>cursor<span class="op">&gt;</span>.fetchall()                  <span class="co"># Returns remaining rows. Also list(&lt;cursor&gt;).</span></a></code></pre></div>
<h3 id="write-1">Write</h3>
<div class="sourceCode" id="cb199"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb199-1" title="1"><span class="op">&lt;</span>con<span class="op">&gt;</span>.execute(<span class="st">&#39;&lt;query&gt;&#39;</span>)</a>
<a class="sourceLine" id="cb199-2" title="2"><span class="op">&lt;</span>con<span class="op">&gt;</span>.commit()</a></code></pre></div>
<h4 id="or">Or:</h4>
<div class="sourceCode" id="cb200"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb200-1" title="1"><span class="cf">with</span> <span class="op">&lt;</span>con<span class="op">&gt;</span>:</a>
<a class="sourceLine" id="cb200-2" title="2">    <span class="op">&lt;</span>con<span class="op">&gt;</span>.execute(<span class="st">&#39;&lt;query&gt;&#39;</span>)</a></code></pre></div>
<h3 id="placeholders">Placeholders</h3>
<ul>
<li><strong>Passed values can be of type str, int, float, bytes, None, bool, datetime.date or datetime.datetme.</strong></li>
<li><strong>Bools will be stored and returned as ints and dates as <a href="#encode">ISO formatted strings</a>.</strong></li>
</ul>
<div class="sourceCode" id="cb201"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb201-1" title="1"><span class="op">&lt;</span>con<span class="op">&gt;</span>.execute(<span class="st">&#39;&lt;query&gt;&#39;</span>, <span class="op">&lt;</span><span class="bu">list</span><span class="op">/</span><span class="bu">tuple</span><span class="op">&gt;</span>)          <span class="co"># Replaces &#39;?&#39;s in query with values.</span></a>
<a class="sourceLine" id="cb201-2" title="2"><span class="op">&lt;</span>con<span class="op">&gt;</span>.execute(<span class="st">&#39;&lt;query&gt;&#39;</span>, <span class="op">&lt;</span><span class="bu">dict</span><span class="op">/</span>namedtuple<span class="op">&gt;</span>)     <span class="co"># Replaces &#39;:&lt;key&gt;&#39;s with values.</span></a>
<a class="sourceLine" id="cb201-3" title="3"><span class="op">&lt;</span>con<span class="op">&gt;</span>.executemany(<span class="st">&#39;&lt;query&gt;&#39;</span>, <span class="op">&lt;</span>coll_of_above<span class="op">&gt;</span>)   <span class="co"># Runs execute() multiple times.</span></a></code></pre></div>
<h3 id="example">Example</h3>
<p><strong>In this example values are not actually saved because <code>'con.commit()'</code> is omitted!</strong></p>
<div class="sourceCode" id="cb202"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb202-1" title="1"><span class="op">&gt;&gt;&gt;</span> con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">&#39;test.db&#39;</span>)</a>
<a class="sourceLine" id="cb202-2" title="2"><span class="op">&gt;&gt;&gt;</span> con.execute(<span class="st">&#39;create table person (person_id integer primary key, name, height)&#39;</span>)</a>
<a class="sourceLine" id="cb202-3" title="3"><span class="op">&gt;&gt;&gt;</span> con.execute(<span class="st">&#39;insert into person values (null, ?, ?)&#39;</span>, (<span class="st">&#39;Jean-Luc&#39;</span>, <span class="dv">187</span>)).lastrowid</a>
<a class="sourceLine" id="cb202-4" title="4"><span class="dv">1</span></a>
<a class="sourceLine" id="cb202-5" title="5"><span class="op">&gt;&gt;&gt;</span> con.execute(<span class="st">&#39;select * from person&#39;</span>).fetchall()</a>
<a class="sourceLine" id="cb202-6" title="6">[(<span class="dv">1</span>, <span class="st">&#39;Jean-Luc&#39;</span>, <span class="dv">187</span>)]</a></code></pre></div>
<h3 id="mysql">MySQL</h3>
<p><strong>Has a very similar interface, with differences listed below.</strong></p>
<div class="sourceCode" id="cb203"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb203-1" title="1"><span class="co"># $ pip3 install mysql-connector</span></a>
<a class="sourceLine" id="cb203-2" title="2"><span class="im">from</span> mysql <span class="im">import</span> connector</a>
<a class="sourceLine" id="cb203-3" title="3"><span class="op">&lt;</span>con<span class="op">&gt;</span> <span class="op">=</span> connector.<span class="ex">connect</span>(host<span class="op">=&lt;</span><span class="bu">str</span><span class="op">&gt;</span>, …)        <span class="co"># `user=&lt;str&gt;, password=&lt;str&gt;, database=&lt;str&gt;`.</span></a>
<a class="sourceLine" id="cb203-4" title="4"><span class="op">&lt;</span>cursor<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>con<span class="op">&gt;</span>.cursor()                       <span class="co"># Only cursor has execute method.</span></a>
<a class="sourceLine" id="cb203-5" title="5"><span class="op">&lt;</span>cursor<span class="op">&gt;</span>.execute(<span class="st">&#39;&lt;query&gt;&#39;</span>)                     <span class="co"># Can raise a subclass of connector.Error.</span></a>
<a class="sourceLine" id="cb203-6" title="6"><span class="op">&lt;</span>cursor<span class="op">&gt;</span>.execute(<span class="st">&#39;&lt;query&gt;&#39;</span>, <span class="op">&lt;</span><span class="bu">list</span><span class="op">/</span><span class="bu">tuple</span><span class="op">&gt;</span>)       <span class="co"># Replaces &#39;%s&#39;s in query with values.</span></a>
<a class="sourceLine" id="cb203-7" title="7"><span class="op">&lt;</span>cursor<span class="op">&gt;</span>.execute(<span class="st">&#39;&lt;query&gt;&#39;</span>, <span class="op">&lt;</span><span class="bu">dict</span><span class="op">/</span>namedtuple<span class="op">&gt;</span>)  <span class="co"># Replaces &#39;%(&lt;key&gt;)s&#39;s with values.</span></a></code></pre></div>
<h2 id="bytes">Bytes</h2>
<p><strong>Bytes object is an immutable sequence of single bytes. Mutable version is called bytearray.</strong></p>
<div class="sourceCode" id="cb204"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb204-1" title="1"><span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span> <span class="op">=</span> b<span class="st">&#39;&lt;str&gt;&#39;</span>                       <span class="co"># Only accepts ASCII characters and \x00 - \xff.</span></a>
<a class="sourceLine" id="cb204-2" title="2"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>   <span class="op">=</span> <span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span>[<span class="op">&lt;</span>index<span class="op">&gt;</span>]               <span class="co"># Returns int in range from 0 to 255.</span></a>
<a class="sourceLine" id="cb204-3" title="3"><span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span>[<span class="op">&lt;</span><span class="bu">slice</span><span class="op">&gt;</span>]               <span class="co"># Returns bytes even if it has only one element.</span></a>
<a class="sourceLine" id="cb204-4" title="4"><span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span>.join(<span class="op">&lt;</span>coll_of_bytes<span class="op">&gt;</span>)  <span class="co"># Joins elements using bytes object as separator.</span></a></code></pre></div>
<h3 id="encode-1">Encode</h3>
<div class="sourceCode" id="cb205"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb205-1" title="1"><span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">bytes</span>(<span class="op">&lt;</span>coll_of_ints<span class="op">&gt;</span>)          <span class="co"># Ints must be in range from 0 to 255.</span></a>
<a class="sourceLine" id="cb205-2" title="2"><span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">bytes</span>(<span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>, <span class="st">&#39;utf-8&#39;</span>)          <span class="co"># Or: &lt;str&gt;.encode(&#39;utf-8&#39;)</span></a>
<a class="sourceLine" id="cb205-3" title="3"><span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>.to_bytes(n_bytes, …)     <span class="co"># `byteorder=&#39;big/little&#39;, signed=False`.</span></a>
<a class="sourceLine" id="cb205-4" title="4"><span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">bytes</span>.fromhex(<span class="st">&#39;&lt;hex&gt;&#39;</span>)         <span class="co"># Hex pairs can be separated by spaces.</span></a></code></pre></div>
<h3 id="decode-1">Decode</h3>
<div class="sourceCode" id="cb206"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb206-1" title="1"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="bu">list</span>(<span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span>)                  <span class="co"># Returns ints in range from 0 to 255.</span></a>
<a class="sourceLine" id="cb206-2" title="2"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>   <span class="op">=</span> <span class="bu">str</span>(<span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span>, <span class="st">&#39;utf-8&#39;</span>)          <span class="co"># Or: &lt;bytes&gt;.decode(&#39;utf-8&#39;)</span></a>
<a class="sourceLine" id="cb206-3" title="3"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>   <span class="op">=</span> <span class="bu">int</span>.from_bytes(<span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span>, …)     <span class="co"># `byteorder=&#39;big/little&#39;, signed=False`.</span></a>
<a class="sourceLine" id="cb206-4" title="4"><span class="co">&#39;&lt;hex&gt;&#39;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span>.<span class="bu">hex</span>()                  <span class="co"># Returns a string of hexadecimal pairs.</span></a></code></pre></div>
<h3 id="read-bytes-from-file">Read Bytes from File</h3>
<div class="sourceCode" id="cb207"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb207-1" title="1"><span class="kw">def</span> read_bytes(filename):</a>
<a class="sourceLine" id="cb207-2" title="2">    <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb207-3" title="3">        <span class="cf">return</span> <span class="bu">file</span>.read()</a></code></pre></div>
<h3 id="write-bytes-to-file">Write Bytes to File</h3>
<div class="sourceCode" id="cb208"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb208-1" title="1"><span class="kw">def</span> write_bytes(filename, bytes_obj):</a>
<a class="sourceLine" id="cb208-2" title="2">    <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb208-3" title="3">        <span class="bu">file</span>.write(bytes_obj)</a></code></pre></div>
<h2 id="struct">Struct</h2>
<ul>
<li><strong>Module that performs conversions between a sequence of numbers and a bytes object.</strong></li>
<li><strong>Machine’s native type sizes and byte order are used by default.</strong></li>
</ul>
<div class="sourceCode" id="cb209"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb209-1" title="1"><span class="im">from</span> struct <span class="im">import</span> pack, unpack, iter_unpack</a>
<a class="sourceLine" id="cb209-2" title="2"><span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span>  <span class="op">=</span> pack(<span class="st">&#39;&lt;format&gt;&#39;</span>, <span class="op">&lt;</span>num_1<span class="op">&gt;</span> [, <span class="op">&lt;</span>num_2<span class="op">&gt;</span>, ...])</a>
<a class="sourceLine" id="cb209-3" title="3"><span class="op">&lt;</span><span class="bu">tuple</span><span class="op">&gt;</span>  <span class="op">=</span> unpack(<span class="st">&#39;&lt;format&gt;&#39;</span>, <span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb209-4" title="4"><span class="op">&lt;</span>tuples<span class="op">&gt;</span> <span class="op">=</span> iter_unpack(<span class="st">&#39;&lt;format&gt;&#39;</span>, <span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span>)</a></code></pre></div>
<h3 id="example-1">Example</h3>
<div class="sourceCode" id="cb210"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb210-1" title="1"><span class="op">&gt;&gt;&gt;</span> pack(<span class="st">&#39;&gt;hhl&#39;</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb210-2" title="2">b<span class="st">&#39;</span><span class="ch">\x00\x01\x00\x02\x00\x00\x00\x03</span><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb210-3" title="3"><span class="op">&gt;&gt;&gt;</span> unpack(<span class="st">&#39;&gt;hhl&#39;</span>, b<span class="st">&#39;</span><span class="ch">\x00\x01\x00\x02\x00\x00\x00\x03</span><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb210-4" title="4">(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</a></code></pre></div>
<h3 id="format-2">Format</h3>
<h4 id="for-standard-type-sizes-start-format-string-with">For standard type sizes start format string with:</h4>
<ul>
<li><strong><code>'='</code> - native byte order (usually little-endian)</strong></li>
<li><strong><code>'&lt;'</code> - little-endian</strong></li>
<li><strong><code>'&gt;'</code> - big-endian (also <code>'!'</code>)</strong></li>
</ul>
<h4 id="integer-types.-use-a-capital-letter-for-unsigned-type.-minimum-and-standard-sizes-are-in-brackets">Integer types. Use a capital letter for unsigned type. Minimum and standard sizes are in brackets:</h4>
<ul>
<li><strong><code>'x'</code> - pad byte</strong></li>
<li><strong><code>'b'</code> - char (1/1)</strong></li>
<li><strong><code>'h'</code> - short (2/2)</strong></li>
<li><strong><code>'i'</code> - int (2/4)</strong></li>
<li><strong><code>'l'</code> - long (4/4)</strong></li>
<li><strong><code>'q'</code> - long long (8/8)</strong></li>
</ul>
<h4 id="floating-point-types">Floating point types:</h4>
<ul>
<li><strong><code>'f'</code> - float (4/4)</strong></li>
<li><strong><code>'d'</code> - double (8/8)</strong></li>
</ul>
<h2 id="array">Array</h2>
<p><strong>List that can only hold numbers of a predefined type. Available types and their minimum sizes in bytes are listed above. Sizes and byte order are always determined by the system.</strong></p>
<div class="sourceCode" id="cb211"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb211-1" title="1"><span class="im">from</span> array <span class="im">import</span> array</a>
<a class="sourceLine" id="cb211-2" title="2"><span class="op">&lt;</span>array<span class="op">&gt;</span> <span class="op">=</span> array(<span class="st">&#39;&lt;typecode&gt;&#39;</span>, <span class="op">&lt;</span>collection<span class="op">&gt;</span>)    <span class="co"># Array from collection of numbers.</span></a>
<a class="sourceLine" id="cb211-3" title="3"><span class="op">&lt;</span>array<span class="op">&gt;</span> <span class="op">=</span> array(<span class="st">&#39;&lt;typecode&gt;&#39;</span>, <span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span>)         <span class="co"># Array from bytes object.</span></a>
<a class="sourceLine" id="cb211-4" title="4"><span class="op">&lt;</span>array<span class="op">&gt;</span> <span class="op">=</span> array(<span class="st">&#39;&lt;typecode&gt;&#39;</span>, <span class="op">&lt;</span>array<span class="op">&gt;</span>)         <span class="co"># Treats array as a sequence of numbers.</span></a>
<a class="sourceLine" id="cb211-5" title="5"><span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">bytes</span>(<span class="op">&lt;</span>array<span class="op">&gt;</span>)                       <span class="co"># Or: &lt;array&gt;.tobytes()</span></a></code></pre></div>
<h2 id="memory-view">Memory View</h2>
<ul>
<li><strong>A sequence object that points to the memory of another object.</strong></li>
<li><strong>Each element can reference a single or multiple consecutive bytes, depending on format.</strong></li>
<li><strong>Order and number of elements can be changed with slicing.</strong></li>
</ul>
<div class="sourceCode" id="cb212"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb212-1" title="1"><span class="op">&lt;</span>mview<span class="op">&gt;</span> <span class="op">=</span> <span class="bu">memoryview</span>(<span class="op">&lt;</span><span class="bu">bytes</span><span class="op">/</span><span class="bu">bytearray</span><span class="op">/</span>array<span class="op">&gt;</span>)  <span class="co"># Immutable if bytes, else mutable.</span></a>
<a class="sourceLine" id="cb212-2" title="2"><span class="op">&lt;</span>real<span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span>mview<span class="op">&gt;</span>[<span class="op">&lt;</span>index<span class="op">&gt;</span>]                     <span class="co"># Returns an int or a float.</span></a>
<a class="sourceLine" id="cb212-3" title="3"><span class="op">&lt;</span>mview<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>mview<span class="op">&gt;</span>[<span class="op">&lt;</span><span class="bu">slice</span><span class="op">&gt;</span>]                     <span class="co"># Mview with rearranged elements.</span></a>
<a class="sourceLine" id="cb212-4" title="4"><span class="op">&lt;</span>mview<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>mview<span class="op">&gt;</span>.cast(<span class="st">&#39;&lt;typecode&gt;&#39;</span>)           <span class="co"># Casts memoryview to the new format.</span></a>
<a class="sourceLine" id="cb212-5" title="5"><span class="op">&lt;</span>mview<span class="op">&gt;</span>.release()                              <span class="co"># Releases the object&#39;s memory buffer.</span></a></code></pre></div>
<h3 id="decode-2">Decode</h3>
<div class="sourceCode" id="cb213"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb213-1" title="1"><span class="op">&lt;</span>bin_file<span class="op">&gt;</span>.write(<span class="op">&lt;</span>mview<span class="op">&gt;</span>)                      <span class="co"># Writes mview to the binary file.</span></a>
<a class="sourceLine" id="cb213-2" title="2"><span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">bytes</span>(<span class="op">&lt;</span>mview<span class="op">&gt;</span>)                       <span class="co"># Creates a new bytes object.</span></a>
<a class="sourceLine" id="cb213-3" title="3"><span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span>.join(<span class="op">&lt;</span>coll_of_mviews<span class="op">&gt;</span>)       <span class="co"># Joins mviews using bytes object as sep.</span></a>
<a class="sourceLine" id="cb213-4" title="4"><span class="op">&lt;</span>array<span class="op">&gt;</span> <span class="op">=</span> array(<span class="st">&#39;&lt;typecode&gt;&#39;</span>, <span class="op">&lt;</span>mview<span class="op">&gt;</span>)         <span class="co"># Treats mview as a sequence of numbers.</span></a></code></pre></div>
<div class="sourceCode" id="cb214"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb214-1" title="1"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="bu">list</span>(<span class="op">&lt;</span>mview<span class="op">&gt;</span>)                        <span class="co"># Returns list of ints or floats.</span></a>
<a class="sourceLine" id="cb214-2" title="2"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>   <span class="op">=</span> <span class="bu">str</span>(<span class="op">&lt;</span>mview<span class="op">&gt;</span>, <span class="st">&#39;utf-8&#39;</span>)                <span class="co"># Treats mview as a bytes object.</span></a>
<a class="sourceLine" id="cb214-3" title="3"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>   <span class="op">=</span> <span class="bu">int</span>.from_bytes(<span class="op">&lt;</span>mview<span class="op">&gt;</span>, …)           <span class="co"># `byteorder=&#39;big/little&#39;, signed=False`.</span></a>
<a class="sourceLine" id="cb214-4" title="4"><span class="co">&#39;&lt;hex&gt;&#39;</span> <span class="op">=</span> <span class="op">&lt;</span>mview<span class="op">&gt;</span>.<span class="bu">hex</span>()                        <span class="co"># Treats mview as a bytes object.</span></a></code></pre></div>
<h2 id="deque">Deque</h2>
<p><strong>A thread-safe list with efficient appends and pops from either side. Pronounced “deck”.</strong></p>
<div class="sourceCode" id="cb215"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb215-1" title="1"><span class="im">from</span> collections <span class="im">import</span> deque</a>
<a class="sourceLine" id="cb215-2" title="2"><span class="op">&lt;</span>deque<span class="op">&gt;</span> <span class="op">=</span> deque(<span class="op">&lt;</span>collection<span class="op">&gt;</span>, maxlen<span class="op">=</span><span class="va">None</span>)</a></code></pre></div>
<div class="sourceCode" id="cb216"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb216-1" title="1"><span class="op">&lt;</span>deque<span class="op">&gt;</span>.appendleft(<span class="op">&lt;</span>el<span class="op">&gt;</span>)                       <span class="co"># Opposite element is dropped if full.</span></a>
<a class="sourceLine" id="cb216-2" title="2"><span class="op">&lt;</span>deque<span class="op">&gt;</span>.extendleft(<span class="op">&lt;</span>collection<span class="op">&gt;</span>)               <span class="co"># Collection gets reversed.</span></a>
<a class="sourceLine" id="cb216-3" title="3"><span class="op">&lt;</span>el<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>deque<span class="op">&gt;</span>.popleft()                       <span class="co"># Raises IndexError if empty.</span></a>
<a class="sourceLine" id="cb216-4" title="4"><span class="op">&lt;</span>deque<span class="op">&gt;</span>.rotate(n<span class="op">=</span><span class="dv">1</span>)                            <span class="co"># Rotates elements to the right.</span></a></code></pre></div>
<h2 id="threading">Threading</h2>
<ul>
<li><strong>CPython interpreter can only run a single thread at a time.</strong></li>
<li><strong>That is why using multiple threads won’t result in a faster execution, unless at least one of the threads contains an I/O operation.</strong></li>
</ul>
<div class="sourceCode" id="cb217"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb217-1" title="1"><span class="im">from</span> threading <span class="im">import</span> Thread, RLock, Semaphore, Event, Barrier</a></code></pre></div>
<h3 id="thread">Thread</h3>
<div class="sourceCode" id="cb218"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb218-1" title="1"><span class="op">&lt;</span>Thread<span class="op">&gt;</span> <span class="op">=</span> Thread(target<span class="op">=&lt;</span>function<span class="op">&gt;</span>)  <span class="co"># Use `args=&lt;collection&gt;` to set arguments.</span></a>
<a class="sourceLine" id="cb218-2" title="2"><span class="op">&lt;</span>Thread<span class="op">&gt;</span>.start()                      <span class="co"># Starts the thread.</span></a>
<a class="sourceLine" id="cb218-3" title="3"><span class="op">&lt;</span><span class="bu">bool</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Thread<span class="op">&gt;</span>.is_alive()          <span class="co"># Checks if thread has finished executing.</span></a>
<a class="sourceLine" id="cb218-4" title="4"><span class="op">&lt;</span>Thread<span class="op">&gt;</span>.join()                       <span class="co"># Waits for thread to finish.</span></a></code></pre></div>
<ul>
<li><strong>Use <code>'kwargs=&lt;dict&gt;'</code> to pass keyword arguments to the function.</strong></li>
<li><strong>Use <code>'daemon=True'</code>, or the program will not be able to exit while the thread is alive.</strong></li>
</ul>
<h3 id="lock">Lock</h3>
<div class="sourceCode" id="cb219"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb219-1" title="1"><span class="op">&lt;</span>lock<span class="op">&gt;</span> <span class="op">=</span> RLock()</a>
<a class="sourceLine" id="cb219-2" title="2"><span class="op">&lt;</span>lock<span class="op">&gt;</span>.acquire()                      <span class="co"># Waits for lock to be available.</span></a>
<a class="sourceLine" id="cb219-3" title="3"><span class="op">&lt;</span>lock<span class="op">&gt;</span>.release()                      <span class="co"># Makes the lock available again.</span></a></code></pre></div>
<h4 id="or-1">Or:</h4>
<div class="sourceCode" id="cb220"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb220-1" title="1">lock <span class="op">=</span> RLock()</a>
<a class="sourceLine" id="cb220-2" title="2"><span class="cf">with</span> lock:</a>
<a class="sourceLine" id="cb220-3" title="3">    ...</a></code></pre></div>
<h3 id="semaphore-event-barrier">Semaphore, Event, Barrier</h3>
<div class="sourceCode" id="cb221"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb221-1" title="1"><span class="op">&lt;</span>Semaphore<span class="op">&gt;</span> <span class="op">=</span> Semaphore(value<span class="op">=</span><span class="dv">1</span>)      <span class="co"># Lock that can be acquired &#39;value&#39; times.</span></a>
<a class="sourceLine" id="cb221-2" title="2"><span class="op">&lt;</span>Event<span class="op">&gt;</span>     <span class="op">=</span> Event()                 <span class="co"># Method wait() blocks until set() is called.</span></a>
<a class="sourceLine" id="cb221-3" title="3"><span class="op">&lt;</span>Barrier<span class="op">&gt;</span>   <span class="op">=</span> Barrier(n_times)        <span class="co"># Method wait() blocks until it&#39;s called &#39;n_times&#39;.</span></a></code></pre></div>
<h3 id="thread-pool-executor">Thread Pool Executor</h3>
<div class="sourceCode" id="cb222"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb222-1" title="1"><span class="im">from</span> concurrent.futures <span class="im">import</span> ThreadPoolExecutor</a>
<a class="sourceLine" id="cb222-2" title="2"><span class="cf">with</span> ThreadPoolExecutor(max_workers<span class="op">=</span><span class="va">None</span>) <span class="im">as</span> executor:         <span class="co"># Does not exit until done.</span></a>
<a class="sourceLine" id="cb222-3" title="3">    <span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span>   <span class="op">=</span> executor.<span class="bu">map</span>(<span class="kw">lambda</span> x: x <span class="op">+</span> <span class="dv">1</span>, <span class="bu">range</span>(<span class="dv">3</span>))         <span class="co"># (1, 2, 3)</span></a>
<a class="sourceLine" id="cb222-4" title="4">    <span class="op">&lt;</span><span class="bu">iter</span><span class="op">&gt;</span>   <span class="op">=</span> executor.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: x <span class="op">+</span> y, <span class="st">&#39;abc&#39;</span>, <span class="st">&#39;123&#39;</span>)  <span class="co"># (&#39;a1&#39;, &#39;b2&#39;, &#39;c3&#39;)</span></a>
<a class="sourceLine" id="cb222-5" title="5">    <span class="op">&lt;</span>Future<span class="op">&gt;</span> <span class="op">=</span> executor.submit(<span class="op">&lt;</span>function<span class="op">&gt;</span> [, <span class="op">&lt;</span>arg_1<span class="op">&gt;</span>, ...])    <span class="co"># Also visible outside block.</span></a></code></pre></div>
<h4 id="future">Future:</h4>
<div class="sourceCode" id="cb223"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb223-1" title="1"><span class="op">&lt;</span><span class="bu">bool</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Future<span class="op">&gt;</span>.done()              <span class="co"># Checks if thread has finished executing.</span></a>
<a class="sourceLine" id="cb223-2" title="2"><span class="op">&lt;</span>obj<span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span>Future<span class="op">&gt;</span>.result()            <span class="co"># Waits for thread to finish and returns result.</span></a></code></pre></div>
<h3 id="queue">Queue</h3>
<p><strong>A thread-safe FIFO queue. For LIFO queue use LifoQueue.</strong></p>
<div class="sourceCode" id="cb224"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb224-1" title="1"><span class="im">from</span> queue <span class="im">import</span> Queue</a>
<a class="sourceLine" id="cb224-2" title="2"><span class="op">&lt;</span>Queue<span class="op">&gt;</span> <span class="op">=</span> Queue(maxsize<span class="op">=</span><span class="dv">0</span>)</a></code></pre></div>
<div class="sourceCode" id="cb225"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb225-1" title="1"><span class="op">&lt;</span>Queue<span class="op">&gt;</span>.put(<span class="op">&lt;</span>el<span class="op">&gt;</span>)                     <span class="co"># Blocks until queue stops being full.</span></a>
<a class="sourceLine" id="cb225-2" title="2"><span class="op">&lt;</span>Queue<span class="op">&gt;</span>.put_nowait(<span class="op">&lt;</span>el<span class="op">&gt;</span>)              <span class="co"># Raises queue.Full exception if full.</span></a>
<a class="sourceLine" id="cb225-3" title="3"><span class="op">&lt;</span>el<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Queue<span class="op">&gt;</span>.get()                  <span class="co"># Blocks until queue stops being empty.</span></a>
<a class="sourceLine" id="cb225-4" title="4"><span class="op">&lt;</span>el<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Queue<span class="op">&gt;</span>.get_nowait()           <span class="co"># Raises queue.Empty exception if empty.</span></a></code></pre></div>
<h2 id="operator">Operator</h2>
<p><strong>Module of functions that provide the functionality of operators.</strong></p>
<div class="sourceCode" id="cb226"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb226-1" title="1"><span class="im">from</span> operator <span class="im">import</span> add, sub, mul, truediv, floordiv, mod, <span class="bu">pow</span>, neg, <span class="bu">abs</span></a>
<a class="sourceLine" id="cb226-2" title="2"><span class="im">from</span> operator <span class="im">import</span> eq, ne, lt, le, gt, ge</a>
<a class="sourceLine" id="cb226-3" title="3"><span class="im">from</span> operator <span class="im">import</span> and_, or_, not_</a>
<a class="sourceLine" id="cb226-4" title="4"><span class="im">from</span> operator <span class="im">import</span> itemgetter, attrgetter, methodcaller</a></code></pre></div>
<div class="sourceCode" id="cb227"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb227-1" title="1"><span class="im">import</span> operator <span class="im">as</span> op</a>
<a class="sourceLine" id="cb227-2" title="2">elementwise_sum  <span class="op">=</span> <span class="bu">map</span>(op.add, list_a, list_b)</a>
<a class="sourceLine" id="cb227-3" title="3">sorted_by_second <span class="op">=</span> <span class="bu">sorted</span>(<span class="op">&lt;</span>collection<span class="op">&gt;</span>, key<span class="op">=</span>op.itemgetter(<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb227-4" title="4">sorted_by_both   <span class="op">=</span> <span class="bu">sorted</span>(<span class="op">&lt;</span>collection<span class="op">&gt;</span>, key<span class="op">=</span>op.itemgetter(<span class="dv">1</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb227-5" title="5">product_of_elems <span class="op">=</span> functools.<span class="bu">reduce</span>(op.mul, <span class="op">&lt;</span>collection<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb227-6" title="6">LogicOp          <span class="op">=</span> enum.Enum(<span class="st">&#39;LogicOp&#39;</span>, {<span class="st">&#39;AND&#39;</span>: op.and_, <span class="st">&#39;OR&#39;</span> : op.or_})</a>
<a class="sourceLine" id="cb227-7" title="7">last_el          <span class="op">=</span> op.methodcaller(<span class="st">&#39;pop&#39;</span>)(<span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>)</a></code></pre></div>
<h2 id="introspection">Introspection</h2>
<p><strong>Inspecting code at runtime.</strong></p>
<h3 id="variables">Variables</h3>
<div class="sourceCode" id="cb228"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb228-1" title="1"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">dir</span>()                             <span class="co"># Names of local variables (incl. functions).</span></a>
<a class="sourceLine" id="cb228-2" title="2"><span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">vars</span>()                            <span class="co"># Dict of local variables. Also locals().</span></a>
<a class="sourceLine" id="cb228-3" title="3"><span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">globals</span>()                         <span class="co"># Dict of global variables.</span></a></code></pre></div>
<h3 id="attributes-1">Attributes</h3>
<div class="sourceCode" id="cb229"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb229-1" title="1"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">dir</span>(<span class="op">&lt;</span><span class="bu">object</span><span class="op">&gt;</span>)                     <span class="co"># Names of object&#39;s attributes (incl. methods).</span></a>
<a class="sourceLine" id="cb229-2" title="2"><span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">vars</span>(<span class="op">&lt;</span><span class="bu">object</span><span class="op">&gt;</span>)                    <span class="co"># Dict of object&#39;s fields. Also &lt;obj&gt;.__dict__.</span></a>
<a class="sourceLine" id="cb229-3" title="3"><span class="op">&lt;</span><span class="bu">bool</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">hasattr</span>(<span class="op">&lt;</span><span class="bu">object</span><span class="op">&gt;</span>, <span class="st">&#39;&lt;attr_name&gt;&#39;</span>)  <span class="co"># Checks if getattr() raises an error.</span></a>
<a class="sourceLine" id="cb229-4" title="4">value  <span class="op">=</span> <span class="bu">getattr</span>(<span class="op">&lt;</span><span class="bu">object</span><span class="op">&gt;</span>, <span class="st">&#39;&lt;attr_name&gt;&#39;</span>)  <span class="co"># Raises AttributeError if attribute is missing.</span></a>
<a class="sourceLine" id="cb229-5" title="5"><span class="bu">setattr</span>(<span class="op">&lt;</span><span class="bu">object</span><span class="op">&gt;</span>, <span class="st">&#39;&lt;attr_name&gt;&#39;</span>, value)    <span class="co"># Only works on objects with __dict__ attribute.</span></a>
<a class="sourceLine" id="cb229-6" title="6"><span class="bu">delattr</span>(<span class="op">&lt;</span><span class="bu">object</span><span class="op">&gt;</span>, <span class="st">&#39;&lt;attr_name&gt;&#39;</span>)           <span class="co"># Equivalent to `del &lt;object&gt;.&lt;attr_name&gt;`.</span></a></code></pre></div>
<h3 id="parameters-1">Parameters</h3>
<div class="sourceCode" id="cb230"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb230-1" title="1"><span class="im">from</span> inspect <span class="im">import</span> signature</a>
<a class="sourceLine" id="cb230-2" title="2"><span class="op">&lt;</span>sig<span class="op">&gt;</span>        <span class="op">=</span> signature(<span class="op">&lt;</span>function<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb230-3" title="3">no_of_params <span class="op">=</span> <span class="bu">len</span>(<span class="op">&lt;</span>sig<span class="op">&gt;</span>.parameters)</a>
<a class="sourceLine" id="cb230-4" title="4">param_names  <span class="op">=</span> <span class="bu">list</span>(<span class="op">&lt;</span>sig<span class="op">&gt;</span>.parameters.keys())</a>
<a class="sourceLine" id="cb230-5" title="5">param_kinds  <span class="op">=</span> [a.kind <span class="cf">for</span> a <span class="kw">in</span> <span class="op">&lt;</span>sig<span class="op">&gt;</span>.parameters.values()]</a></code></pre></div>
<h2 id="metaprograming">Metaprograming</h2>
<p><strong>Code that generates code.</strong></p>
<h3 id="type-1">Type</h3>
<p><strong>Type is the root class. If only passed an object it returns its type (class). Otherwise it creates a new class.</strong></p>
<div class="sourceCode" id="cb231"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb231-1" title="1"><span class="op">&lt;</span><span class="kw">class</span><span class="op">&gt;</span> <span class="op">=</span> <span class="bu">type</span>(<span class="st">&#39;&lt;class_name&gt;&#39;</span>, <span class="op">&lt;</span>parents_tuple<span class="op">&gt;</span>, <span class="op">&lt;</span>attributes_dict<span class="op">&gt;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb232"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb232-1" title="1"><span class="op">&gt;&gt;&gt;</span> Z <span class="op">=</span> <span class="bu">type</span>(<span class="st">&#39;Z&#39;</span>, (), {<span class="st">&#39;a&#39;</span>: <span class="st">&#39;abcde&#39;</span>, <span class="st">&#39;b&#39;</span>: <span class="dv">12345</span>})</a>
<a class="sourceLine" id="cb232-2" title="2"><span class="op">&gt;&gt;&gt;</span> z <span class="op">=</span> Z()</a></code></pre></div>
<h3 id="meta-class">Meta Class</h3>
<p><strong>A class that creates classes.</strong></p>
<div class="sourceCode" id="cb233"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb233-1" title="1"><span class="kw">def</span> my_meta_class(name, parents, attrs):</a>
<a class="sourceLine" id="cb233-2" title="2">    attrs[<span class="st">&#39;a&#39;</span>] <span class="op">=</span> <span class="st">&#39;abcde&#39;</span></a>
<a class="sourceLine" id="cb233-3" title="3">    <span class="cf">return</span> <span class="bu">type</span>(name, parents, attrs)</a></code></pre></div>
<h4 id="or-2">Or:</h4>
<div class="sourceCode" id="cb234"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb234-1" title="1"><span class="kw">class</span> MyMetaClass(<span class="bu">type</span>):</a>
<a class="sourceLine" id="cb234-2" title="2">    <span class="kw">def</span> <span class="fu">__new__</span>(cls, name, parents, attrs):</a>
<a class="sourceLine" id="cb234-3" title="3">        attrs[<span class="st">&#39;a&#39;</span>] <span class="op">=</span> <span class="st">&#39;abcde&#39;</span></a>
<a class="sourceLine" id="cb234-4" title="4">        <span class="cf">return</span> <span class="bu">type</span>.<span class="fu">__new__</span>(cls, name, parents, attrs)</a></code></pre></div>
<ul>
<li><strong>New() is a class method that gets called before init(). If it returns an instance of its class, then that instance gets passed to init() as a ‘self’ argument.</strong></li>
<li><strong>It receives the same arguments as init(), except for the first one that specifies the desired type of the returned instance (MyMetaClass in our case).</strong></li>
<li><strong>Like in our case, new() can also be called directly, usually from a new() method of a child class (</strong><code>def __new__(cls): return super().__new__(cls)</code><strong>).</strong></li>
<li><strong>The only difference between the examples above is that my_meta_class() returns a class of type type, while MyMetaClass() returns a class of type MyMetaClass.</strong></li>
</ul>
<h3 id="metaclass-attribute">Metaclass Attribute</h3>
<p><strong>Right before a class is created it checks if it has the ‘metaclass’ attribute defined. If not, it recursively checks if any of his parents has it defined and eventually comes to type().</strong></p>
<div class="sourceCode" id="cb235"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb235-1" title="1"><span class="kw">class</span> MyClass(metaclass<span class="op">=</span>MyMetaClass):</a>
<a class="sourceLine" id="cb235-2" title="2">    b <span class="op">=</span> <span class="dv">12345</span></a></code></pre></div>
<div class="sourceCode" id="cb236"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb236-1" title="1"><span class="op">&gt;&gt;&gt;</span> MyClass.a, MyClass.b</a>
<a class="sourceLine" id="cb236-2" title="2">(<span class="st">&#39;abcde&#39;</span>, <span class="dv">12345</span>)</a></code></pre></div>
<h3 id="type-diagram">Type Diagram</h3>
<div class="sourceCode" id="cb237"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb237-1" title="1"><span class="bu">type</span>(MyClass)     <span class="op">==</span> MyMetaClass     <span class="co"># MyClass is an instance of MyMetaClass.</span></a>
<a class="sourceLine" id="cb237-2" title="2"><span class="bu">type</span>(MyMetaClass) <span class="op">==</span> <span class="bu">type</span>            <span class="co"># MyMetaClass is an instance of type.</span></a></code></pre></div>
<pre class="text"><code>+-------------+-------------+
|   Classes   | Metaclasses |
+-------------+-------------|
|   MyClass --&gt; MyMetaClass |
|             |     v       |
|    object -----&gt; type &lt;+  |
|             |     ^ +--+  |
|     str ----------+       |
+-------------+-------------+</code></pre>
<h3 id="inheritance-diagram">Inheritance Diagram</h3>
<div class="sourceCode" id="cb239"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb239-1" title="1">MyClass.__base__     <span class="op">==</span> <span class="bu">object</span>       <span class="co"># MyClass is a subclass of object.</span></a>
<a class="sourceLine" id="cb239-2" title="2">MyMetaClass.__base__ <span class="op">==</span> <span class="bu">type</span>         <span class="co"># MyMetaClass is a subclass of type.</span></a></code></pre></div>
<pre class="text"><code>+-------------+-------------+
|   Classes   | Metaclasses |
+-------------+-------------|
|   MyClass   | MyMetaClass |
|      v      |     v       |
|    object &lt;----- type     |
|      ^      |             |
|     str     |             |
+-------------+-------------+</code></pre>
<h2 id="eval">Eval</h2>
<div class="sourceCode" id="cb241"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb241-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> ast <span class="im">import</span> literal_eval</a>
<a class="sourceLine" id="cb241-2" title="2"><span class="op">&gt;&gt;&gt;</span> literal_eval(<span class="st">&#39;1 + 2&#39;</span>)</a>
<a class="sourceLine" id="cb241-3" title="3"><span class="dv">3</span></a>
<a class="sourceLine" id="cb241-4" title="4"><span class="op">&gt;&gt;&gt;</span> literal_eval(<span class="st">&#39;[1, 2, 3]&#39;</span>)</a>
<a class="sourceLine" id="cb241-5" title="5">[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</a>
<a class="sourceLine" id="cb241-6" title="6"><span class="op">&gt;&gt;&gt;</span> literal_eval(<span class="st">&#39;abs(1)&#39;</span>)</a>
<a class="sourceLine" id="cb241-7" title="7"><span class="pp">ValueError</span>: malformed node <span class="kw">or</span> string</a></code></pre></div>
<h2 id="coroutines">Coroutines</h2>
<ul>
<li><strong>Coroutines have a lot in common with threads, but unlike threads, they only give up control when they call another coroutine and they don’t use as much memory.</strong></li>
<li><strong>Coroutine definition starts with <code>'async'</code> and its call with <code>'await'</code>.</strong></li>
<li><strong><code>'asyncio.run(&lt;coroutine&gt;)'</code> is the main entry point for asynchronous programs.</strong></li>
<li><strong>Functions wait(), gather() and as_completed() can be used when multiple coroutines need to be started at the same time.</strong></li>
<li><strong>Asyncio module also provides its own <a href="#queue">Queue</a>, <a href="#semaphore-event-barrier">Event</a>, <a href="#lock">Lock</a> and <a href="#semaphore-event-barrier">Semaphore</a> classes.</strong></li>
</ul>
<h4 id="runs-a-terminal-game-where-you-control-an-asterisk-that-must-avoid-numbers">Runs a terminal game where you control an asterisk that must avoid numbers:</h4>
<div class="sourceCode" id="cb242"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb242-1" title="1"><span class="im">import</span> asyncio, collections, curses, enum, random</a>
<a class="sourceLine" id="cb242-2" title="2"></a>
<a class="sourceLine" id="cb242-3" title="3">P <span class="op">=</span> collections.namedtuple(<span class="st">&#39;P&#39;</span>, <span class="st">&#39;x y&#39;</span>)         <span class="co"># Position</span></a>
<a class="sourceLine" id="cb242-4" title="4">D <span class="op">=</span> enum.Enum(<span class="st">&#39;D&#39;</span>, <span class="st">&#39;n e s w&#39;</span>)                  <span class="co"># Direction</span></a>
<a class="sourceLine" id="cb242-5" title="5"></a>
<a class="sourceLine" id="cb242-6" title="6"><span class="kw">def</span> main(screen):</a>
<a class="sourceLine" id="cb242-7" title="7">    curses.curs_set(<span class="dv">0</span>)                         <span class="co"># Makes cursor invisible.</span></a>
<a class="sourceLine" id="cb242-8" title="8">    screen.nodelay(<span class="va">True</span>)                       <span class="co"># Makes getch() non-blocking.</span></a>
<a class="sourceLine" id="cb242-9" title="9">    asyncio.run(main_coroutine(screen))        <span class="co"># Starts running asyncio code.</span></a>
<a class="sourceLine" id="cb242-10" title="10"></a>
<a class="sourceLine" id="cb242-11" title="11"><span class="cf">async</span> <span class="kw">def</span> main_coroutine(screen):</a>
<a class="sourceLine" id="cb242-12" title="12">    state <span class="op">=</span> {<span class="st">&#39;*&#39;</span>: P(<span class="dv">0</span>, <span class="dv">0</span>), <span class="op">**</span>{id_: P(<span class="dv">30</span>, <span class="dv">10</span>) <span class="cf">for</span> id_ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)}}</a>
<a class="sourceLine" id="cb242-13" title="13">    moves <span class="op">=</span> asyncio.Queue()</a>
<a class="sourceLine" id="cb242-14" title="14">    coros <span class="op">=</span> (<span class="op">*</span>(random_controller(id_, moves) <span class="cf">for</span> id_ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb242-15" title="15">             human_controller(screen, moves),</a>
<a class="sourceLine" id="cb242-16" title="16">             model(moves, state, <span class="op">*</span>screen.getmaxyx()),</a>
<a class="sourceLine" id="cb242-17" title="17">             view(state, screen))</a>
<a class="sourceLine" id="cb242-18" title="18">    <span class="cf">await</span> asyncio.wait(coros, return_when<span class="op">=</span>asyncio.FIRST_COMPLETED)</a>
<a class="sourceLine" id="cb242-19" title="19"></a>
<a class="sourceLine" id="cb242-20" title="20"><span class="cf">async</span> <span class="kw">def</span> random_controller(id_, moves):</a>
<a class="sourceLine" id="cb242-21" title="21">    <span class="cf">while</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb242-22" title="22">        moves.put_nowait((id_, random.choice(<span class="bu">list</span>(D))))</a>
<a class="sourceLine" id="cb242-23" title="23">        <span class="cf">await</span> asyncio.sleep(random.random() <span class="op">/</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb242-24" title="24"></a>
<a class="sourceLine" id="cb242-25" title="25"><span class="cf">async</span> <span class="kw">def</span> human_controller(screen, moves):</a>
<a class="sourceLine" id="cb242-26" title="26">    <span class="cf">while</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb242-27" title="27">        ch <span class="op">=</span> screen.getch()</a>
<a class="sourceLine" id="cb242-28" title="28">        key_mappings <span class="op">=</span> {<span class="dv">259</span>: D.n, <span class="dv">261</span>: D.e, <span class="dv">258</span>: D.s, <span class="dv">260</span>: D.w}</a>
<a class="sourceLine" id="cb242-29" title="29">        <span class="cf">if</span> ch <span class="kw">in</span> key_mappings:</a>
<a class="sourceLine" id="cb242-30" title="30">            moves.put_nowait((<span class="st">&#39;*&#39;</span>, key_mappings[ch]))</a>
<a class="sourceLine" id="cb242-31" title="31">        <span class="cf">await</span> asyncio.sleep(<span class="fl">0.01</span>)  </a>
<a class="sourceLine" id="cb242-32" title="32"></a>
<a class="sourceLine" id="cb242-33" title="33"><span class="cf">async</span> <span class="kw">def</span> model(moves, state, height, width):</a>
<a class="sourceLine" id="cb242-34" title="34">    <span class="cf">while</span> state[<span class="st">&#39;*&#39;</span>] <span class="kw">not</span> <span class="kw">in</span> {p <span class="cf">for</span> id_, p <span class="kw">in</span> state.items() <span class="cf">if</span> id_ <span class="op">!=</span> <span class="st">&#39;*&#39;</span>}:</a>
<a class="sourceLine" id="cb242-35" title="35">        id_, d <span class="op">=</span> <span class="cf">await</span> moves.get()</a>
<a class="sourceLine" id="cb242-36" title="36">        p <span class="op">=</span> state[id_]</a>
<a class="sourceLine" id="cb242-37" title="37">        deltas <span class="op">=</span> {D.n: P(<span class="dv">0</span>, <span class="dv">-1</span>), D.e: P(<span class="dv">1</span>, <span class="dv">0</span>), D.s: P(<span class="dv">0</span>, <span class="dv">1</span>), D.w: P(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>)}</a>
<a class="sourceLine" id="cb242-38" title="38">        new_p <span class="op">=</span> P(p.x <span class="op">+</span> deltas[d].x, p.y <span class="op">+</span> deltas[d].y)</a>
<a class="sourceLine" id="cb242-39" title="39">        <span class="cf">if</span> <span class="dv">0</span> <span class="op">&lt;=</span> new_p.x <span class="op">&lt;</span> width<span class="dv">-1</span> <span class="kw">and</span> <span class="dv">0</span> <span class="op">&lt;=</span> new_p.y <span class="op">&lt;</span> height:</a>
<a class="sourceLine" id="cb242-40" title="40">            state[id_] <span class="op">=</span> new_p</a>
<a class="sourceLine" id="cb242-41" title="41"></a>
<a class="sourceLine" id="cb242-42" title="42"><span class="cf">async</span> <span class="kw">def</span> view(state, screen):</a>
<a class="sourceLine" id="cb242-43" title="43">    <span class="cf">while</span> <span class="va">True</span>:</a>
<a class="sourceLine" id="cb242-44" title="44">        screen.clear()</a>
<a class="sourceLine" id="cb242-45" title="45">        <span class="cf">for</span> id_, p <span class="kw">in</span> state.items():</a>
<a class="sourceLine" id="cb242-46" title="46">            screen.addstr(p.y, p.x, <span class="bu">str</span>(id_))</a>
<a class="sourceLine" id="cb242-47" title="47">        <span class="cf">await</span> asyncio.sleep(<span class="fl">0.01</span>)  </a>
<a class="sourceLine" id="cb242-48" title="48"></a>
<a class="sourceLine" id="cb242-49" title="49">curses.wrapper(main)</a></code></pre></div>
<p><br></p>
<h1 id="libraries">Libraries</h1>
<h2 id="progress-bar">Progress Bar</h2>
<div class="sourceCode" id="cb243"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb243-1" title="1"><span class="co"># $ pip3 install tqdm</span></a>
<a class="sourceLine" id="cb243-2" title="2"><span class="im">from</span> tqdm <span class="im">import</span> tqdm</a>
<a class="sourceLine" id="cb243-3" title="3"><span class="im">from</span> time <span class="im">import</span> sleep</a>
<a class="sourceLine" id="cb243-4" title="4"><span class="cf">for</span> el <span class="kw">in</span> tqdm([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]):</a>
<a class="sourceLine" id="cb243-5" title="5">    sleep(<span class="fl">0.2</span>)</a></code></pre></div>
<h2 id="plot">Plot</h2>
<div class="sourceCode" id="cb244"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb244-1" title="1"><span class="co"># $ pip3 install matplotlib</span></a>
<a class="sourceLine" id="cb244-2" title="2"><span class="im">from</span> matplotlib <span class="im">import</span> pyplot</a>
<a class="sourceLine" id="cb244-3" title="3">pyplot.plot(<span class="op">&lt;</span>y_data<span class="op">&gt;</span> [, label<span class="op">=&lt;</span><span class="bu">str</span><span class="op">&gt;</span>])</a>
<a class="sourceLine" id="cb244-4" title="4">pyplot.plot(<span class="op">&lt;</span>x_data<span class="op">&gt;</span>, <span class="op">&lt;</span>y_data<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb244-5" title="5">pyplot.legend()                                <span class="co"># Adds a legend.</span></a>
<a class="sourceLine" id="cb244-6" title="6">pyplot.savefig(<span class="st">&#39;&lt;path&gt;&#39;</span>)                       <span class="co"># Saves the figure.</span></a>
<a class="sourceLine" id="cb244-7" title="7">pyplot.show()                                  <span class="co"># Displays the figure.</span></a>
<a class="sourceLine" id="cb244-8" title="8">pyplot.clf()                                   <span class="co"># Clears the figure.</span></a></code></pre></div>
<h2 id="table">Table</h2>
<h4 id="prints-a-csv-file-as-an-ascii-table">Prints a CSV file as an ASCII table:</h4>
<div class="sourceCode" id="cb245"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb245-1" title="1"><span class="co"># $ pip3 install tabulate</span></a>
<a class="sourceLine" id="cb245-2" title="2"><span class="im">import</span> csv, tabulate</a>
<a class="sourceLine" id="cb245-3" title="3"><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;test.csv&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, newline<span class="op">=</span><span class="st">&#39;&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb245-4" title="4">    rows   <span class="op">=</span> csv.reader(<span class="bu">file</span>)</a>
<a class="sourceLine" id="cb245-5" title="5">    header <span class="op">=</span> [a.title() <span class="cf">for</span> a <span class="kw">in</span> <span class="bu">next</span>(rows)]</a>
<a class="sourceLine" id="cb245-6" title="6">    table  <span class="op">=</span> tabulate.tabulate(rows, header)</a>
<a class="sourceLine" id="cb245-7" title="7">    <span class="bu">print</span>(table)</a></code></pre></div>
<h2 id="curses">Curses</h2>
<h4 id="clears-the-terminal-prints-a-message-and-waits-for-the-esc-key-press">Clears the terminal, prints a message and waits for the ESC key press:</h4>
<div class="sourceCode" id="cb246"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb246-1" title="1"><span class="im">from</span> curses <span class="im">import</span> wrapper, curs_set, <span class="bu">ascii</span></a>
<a class="sourceLine" id="cb246-2" title="2"><span class="im">from</span> curses <span class="im">import</span> KEY_UP, KEY_RIGHT, KEY_DOWN, KEY_LEFT</a>
<a class="sourceLine" id="cb246-3" title="3"></a>
<a class="sourceLine" id="cb246-4" title="4"><span class="kw">def</span> main():</a>
<a class="sourceLine" id="cb246-5" title="5">    wrapper(draw)</a>
<a class="sourceLine" id="cb246-6" title="6"></a>
<a class="sourceLine" id="cb246-7" title="7"><span class="kw">def</span> draw(screen):</a>
<a class="sourceLine" id="cb246-8" title="8">    curs_set(<span class="dv">0</span>)                                <span class="co"># Makes cursor invisible.</span></a>
<a class="sourceLine" id="cb246-9" title="9">    screen.nodelay(<span class="va">True</span>)                       <span class="co"># Makes getch() non-blocking.</span></a>
<a class="sourceLine" id="cb246-10" title="10">    screen.clear()</a>
<a class="sourceLine" id="cb246-11" title="11">    screen.addstr(<span class="dv">0</span>, <span class="dv">0</span>, <span class="st">&#39;Press ESC to quit.&#39;</span>)  <span class="co"># Coordinates are y, x.</span></a>
<a class="sourceLine" id="cb246-12" title="12">    <span class="cf">while</span> screen.getch() <span class="op">!=</span> <span class="bu">ascii</span>.ESC:</a>
<a class="sourceLine" id="cb246-13" title="13">        <span class="cf">pass</span></a>
<a class="sourceLine" id="cb246-14" title="14"></a>
<a class="sourceLine" id="cb246-15" title="15"><span class="kw">def</span> get_border(screen):</a>
<a class="sourceLine" id="cb246-16" title="16">    <span class="im">from</span> collections <span class="im">import</span> namedtuple</a>
<a class="sourceLine" id="cb246-17" title="17">    P <span class="op">=</span> namedtuple(<span class="st">&#39;P&#39;</span>, <span class="st">&#39;x y&#39;</span>)</a>
<a class="sourceLine" id="cb246-18" title="18">    height, width <span class="op">=</span> screen.getmaxyx()</a>
<a class="sourceLine" id="cb246-19" title="19">    <span class="cf">return</span> P(width<span class="dv">-1</span>, height<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb246-20" title="20"></a>
<a class="sourceLine" id="cb246-21" title="21"><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</a>
<a class="sourceLine" id="cb246-22" title="22">    main()</a></code></pre></div>
<h2 id="logging">Logging</h2>
<div class="sourceCode" id="cb247"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb247-1" title="1"><span class="co"># $ pip3 install loguru</span></a>
<a class="sourceLine" id="cb247-2" title="2"><span class="im">from</span> loguru <span class="im">import</span> logger</a></code></pre></div>
<div class="sourceCode" id="cb248"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb248-1" title="1">logger.add(<span class="st">&#39;debug_</span><span class="sc">{time}</span><span class="st">.log&#39;</span>, colorize<span class="op">=</span><span class="va">True</span>)  <span class="co"># Connects a log file.</span></a>
<a class="sourceLine" id="cb248-2" title="2">logger.add(<span class="st">&#39;error_</span><span class="sc">{time}</span><span class="st">.log&#39;</span>, level<span class="op">=</span><span class="st">&#39;ERROR&#39;</span>)  <span class="co"># Another file for errors or higher.</span></a>
<a class="sourceLine" id="cb248-3" title="3">logger.<span class="op">&lt;</span>level<span class="op">&gt;</span>(<span class="st">&#39;A logging message.&#39;</span>)</a></code></pre></div>
<ul>
<li><strong>Levels: <code>'debug'</code>, <code>'info'</code>, <code>'success'</code>, <code>'warning'</code>, <code>'error'</code>, <code>'critical'</code>.</strong></li>
</ul>
<h3 id="exceptions-2">Exceptions</h3>
<p><strong>Exception description, stack trace and values of variables are appended automatically.</strong></p>
<div class="sourceCode" id="cb249"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb249-1" title="1"><span class="cf">try</span>:</a>
<a class="sourceLine" id="cb249-2" title="2">    ...</a>
<a class="sourceLine" id="cb249-3" title="3"><span class="cf">except</span> <span class="op">&lt;</span>exception<span class="op">&gt;</span>:</a>
<a class="sourceLine" id="cb249-4" title="4">    logger.exception(<span class="st">&#39;An error happened.&#39;</span>)</a></code></pre></div>
<h3 id="rotation">Rotation</h3>
<p><strong>Argument that sets a condition when a new log file is created.</strong></p>
<div class="sourceCode" id="cb250"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb250-1" title="1">rotation<span class="op">=&lt;</span><span class="bu">int</span><span class="op">&gt;|&lt;</span>datetime.timedelta<span class="op">&gt;|&lt;</span>datetime.time<span class="op">&gt;|&lt;</span><span class="bu">str</span><span class="op">&gt;</span></a></code></pre></div>
<ul>
<li><strong><code>'&lt;int&gt;'</code> - Max file size in bytes.</strong></li>
<li><strong><code>'&lt;timedelta&gt;'</code> - Max age of a file.</strong></li>
<li><strong><code>'&lt;time&gt;'</code> - Time of day.</strong></li>
<li><strong><code>'&lt;str&gt;'</code> - Any of above as a string: <code>'100 MB'</code>, <code>'1 month'</code>, <code>'monday at 12:00'</code>, …</strong></li>
</ul>
<h3 id="retention">Retention</h3>
<p><strong>Sets a condition which old log files get deleted.</strong></p>
<div class="sourceCode" id="cb251"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb251-1" title="1">retention<span class="op">=&lt;</span><span class="bu">int</span><span class="op">&gt;|&lt;</span>datetime.timedelta<span class="op">&gt;|&lt;</span><span class="bu">str</span><span class="op">&gt;</span></a></code></pre></div>
<ul>
<li><strong><code>'&lt;int&gt;'</code> - Max number of files.</strong></li>
<li><strong><code>'&lt;timedelta&gt;'</code> - Max age of a file.</strong></li>
<li><strong><code>'&lt;str&gt;'</code> - Max age as a string: <code>'1 week, 3 days'</code>, <code>'2 months'</code>, …</strong></li>
</ul>
<h2 id="scraping">Scraping</h2>
<h4 id="scrapes-pythons-url-version-number-and-logo-from-its-wikipedia-page">Scrapes Python’s URL, version number and logo from its Wikipedia page:</h4>
<div class="sourceCode" id="cb252"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb252-1" title="1"><span class="co"># $ pip3 install requests beautifulsoup4</span></a>
<a class="sourceLine" id="cb252-2" title="2"><span class="im">import</span> requests, sys</a>
<a class="sourceLine" id="cb252-3" title="3"><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</a>
<a class="sourceLine" id="cb252-4" title="4">URL <span class="op">=</span> <span class="st">&#39;https://en.wikipedia.org/wiki/Python_(programming_language)&#39;</span></a>
<a class="sourceLine" id="cb252-5" title="5"><span class="cf">try</span>:</a>
<a class="sourceLine" id="cb252-6" title="6">    html  <span class="op">=</span> requests.get(URL).text</a>
<a class="sourceLine" id="cb252-7" title="7">    doc   <span class="op">=</span> BeautifulSoup(html, <span class="st">&#39;html.parser&#39;</span>)</a>
<a class="sourceLine" id="cb252-8" title="8">    table <span class="op">=</span> doc.find(<span class="st">&#39;table&#39;</span>, class_<span class="op">=</span><span class="st">&#39;infobox vevent&#39;</span>)</a>
<a class="sourceLine" id="cb252-9" title="9">    rows  <span class="op">=</span> table.find_all(<span class="st">&#39;tr&#39;</span>)</a>
<a class="sourceLine" id="cb252-10" title="10">    link  <span class="op">=</span> rows[<span class="dv">11</span>].find(<span class="st">&#39;a&#39;</span>)[<span class="st">&#39;href&#39;</span>]</a>
<a class="sourceLine" id="cb252-11" title="11">    ver   <span class="op">=</span> rows[<span class="dv">6</span>].find(<span class="st">&#39;div&#39;</span>).text.split()[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb252-12" title="12">    url_i <span class="op">=</span> rows[<span class="dv">0</span>].find(<span class="st">&#39;img&#39;</span>)[<span class="st">&#39;src&#39;</span>]</a>
<a class="sourceLine" id="cb252-13" title="13">    image <span class="op">=</span> requests.get(<span class="ss">f&#39;https:</span><span class="sc">{</span>url_i<span class="sc">}</span><span class="ss">&#39;</span>).content</a>
<a class="sourceLine" id="cb252-14" title="14">    <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;test.png&#39;</span>, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb252-15" title="15">        <span class="bu">file</span>.write(image)</a>
<a class="sourceLine" id="cb252-16" title="16">    <span class="bu">print</span>(link, ver)</a>
<a class="sourceLine" id="cb252-17" title="17"><span class="cf">except</span> requests.exceptions.<span class="pp">ConnectionError</span>:</a>
<a class="sourceLine" id="cb252-18" title="18">    <span class="bu">print</span>(<span class="st">&quot;You&#39;ve got problems with connection.&quot;</span>, <span class="bu">file</span><span class="op">=</span>sys.stderr)</a></code></pre></div>
<h2 id="web">Web</h2>
<div class="sourceCode" id="cb253"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb253-1" title="1"><span class="co"># $ pip3 install bottle</span></a>
<a class="sourceLine" id="cb253-2" title="2"><span class="im">from</span> bottle <span class="im">import</span> run, route, static_file, template, post, request, response</a>
<a class="sourceLine" id="cb253-3" title="3"><span class="im">import</span> json</a></code></pre></div>
<h3 id="run">Run</h3>
<div class="sourceCode" id="cb254"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb254-1" title="1">run(host<span class="op">=</span><span class="st">&#39;localhost&#39;</span>, port<span class="op">=</span><span class="dv">8080</span>)        <span class="co"># Runs locally.</span></a>
<a class="sourceLine" id="cb254-2" title="2">run(host<span class="op">=</span><span class="st">&#39;0.0.0.0&#39;</span>, port<span class="op">=</span><span class="dv">80</span>)            <span class="co"># Runs globally.</span></a></code></pre></div>
<h3 id="static-request">Static Request</h3>
<div class="sourceCode" id="cb255"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb255-1" title="1"><span class="at">@route</span>(<span class="st">&#39;/img/&lt;image&gt;&#39;</span>)</a>
<a class="sourceLine" id="cb255-2" title="2"><span class="kw">def</span> send_image(image):</a>
<a class="sourceLine" id="cb255-3" title="3">    <span class="cf">return</span> static_file(image, <span class="st">&#39;img_dir/&#39;</span>, mimetype<span class="op">=</span><span class="st">&#39;image/png&#39;</span>)</a></code></pre></div>
<h3 id="dynamic-request">Dynamic Request</h3>
<div class="sourceCode" id="cb256"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb256-1" title="1"><span class="at">@route</span>(<span class="st">&#39;/&lt;sport&gt;&#39;</span>)</a>
<a class="sourceLine" id="cb256-2" title="2"><span class="kw">def</span> send_page(sport):</a>
<a class="sourceLine" id="cb256-3" title="3">    <span class="cf">return</span> template(<span class="st">&#39;&lt;h1&gt;</span><span class="sc">{{</span><span class="st">title</span><span class="sc">}}</span><span class="st">&lt;/h1&gt;&#39;</span>, title<span class="op">=</span>sport)</a></code></pre></div>
<h3 id="rest-request">REST Request</h3>
<div class="sourceCode" id="cb257"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb257-1" title="1"><span class="at">@post</span>(<span class="st">&#39;/odds/&lt;sport&gt;&#39;</span>)</a>
<a class="sourceLine" id="cb257-2" title="2"><span class="kw">def</span> odds_handler(sport):</a>
<a class="sourceLine" id="cb257-3" title="3">    team <span class="op">=</span> request.forms.get(<span class="st">&#39;team&#39;</span>)</a>
<a class="sourceLine" id="cb257-4" title="4">    home_odds, away_odds <span class="op">=</span> <span class="fl">2.44</span>, <span class="fl">3.29</span></a>
<a class="sourceLine" id="cb257-5" title="5">    response.headers[<span class="st">&#39;Content-Type&#39;</span>] <span class="op">=</span> <span class="st">&#39;application/json&#39;</span></a>
<a class="sourceLine" id="cb257-6" title="6">    response.headers[<span class="st">&#39;Cache-Control&#39;</span>] <span class="op">=</span> <span class="st">&#39;no-cache&#39;</span></a>
<a class="sourceLine" id="cb257-7" title="7">    <span class="cf">return</span> json.dumps([team, home_odds, away_odds])</a></code></pre></div>
<h4 id="test">Test:</h4>
<div class="sourceCode" id="cb258"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb258-1" title="1"><span class="co"># $ pip3 install requests</span></a>
<a class="sourceLine" id="cb258-2" title="2"><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> requests</a>
<a class="sourceLine" id="cb258-3" title="3"><span class="op">&gt;&gt;&gt;</span> url  <span class="op">=</span> <span class="st">&#39;http://localhost:8080/odds/football&#39;</span></a>
<a class="sourceLine" id="cb258-4" title="4"><span class="op">&gt;&gt;&gt;</span> data <span class="op">=</span> {<span class="st">&#39;team&#39;</span>: <span class="st">&#39;arsenal f.c.&#39;</span>}</a>
<a class="sourceLine" id="cb258-5" title="5"><span class="op">&gt;&gt;&gt;</span> response <span class="op">=</span> requests.post(url, data<span class="op">=</span>data)</a>
<a class="sourceLine" id="cb258-6" title="6"><span class="op">&gt;&gt;&gt;</span> response.json()</a>
<a class="sourceLine" id="cb258-7" title="7">[<span class="st">&#39;arsenal f.c.&#39;</span>, <span class="fl">2.44</span>, <span class="fl">3.29</span>]</a></code></pre></div>
<h2 id="profiling">Profiling</h2>
<h3 id="stopwatch">Stopwatch</h3>
<div class="sourceCode" id="cb259"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb259-1" title="1"><span class="im">from</span> time <span class="im">import</span> time</a>
<a class="sourceLine" id="cb259-2" title="2">start_time <span class="op">=</span> time()                     <span class="co"># Seconds since the Epoch.</span></a>
<a class="sourceLine" id="cb259-3" title="3">...</a>
<a class="sourceLine" id="cb259-4" title="4">duration <span class="op">=</span> time() <span class="op">-</span> start_time</a></code></pre></div>
<h4 id="high-performance">High performance:</h4>
<div class="sourceCode" id="cb260"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb260-1" title="1"><span class="im">from</span> time <span class="im">import</span> perf_counter</a>
<a class="sourceLine" id="cb260-2" title="2">start_time <span class="op">=</span> perf_counter()             <span class="co"># Seconds since restart.</span></a>
<a class="sourceLine" id="cb260-3" title="3">...</a>
<a class="sourceLine" id="cb260-4" title="4">duration <span class="op">=</span> perf_counter() <span class="op">-</span> start_time</a></code></pre></div>
<h3 id="timing-a-snippet">Timing a Snippet</h3>
<div class="sourceCode" id="cb261"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb261-1" title="1"><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> timeit <span class="im">import</span> timeit</a>
<a class="sourceLine" id="cb261-2" title="2"><span class="op">&gt;&gt;&gt;</span> timeit(<span class="st">&#39;&quot;-&quot;.join(str(i) for i in range(100))&#39;</span>,</a>
<a class="sourceLine" id="cb261-3" title="3">...        number<span class="op">=</span><span class="dv">10000</span>, <span class="bu">globals</span><span class="op">=</span><span class="bu">globals</span>(), setup<span class="op">=</span><span class="st">&#39;pass&#39;</span>)</a>
<a class="sourceLine" id="cb261-4" title="4"><span class="fl">0.34986</span></a></code></pre></div>
<h3 id="profiling-by-line">Profiling by Line</h3>
<div class="sourceCode" id="cb262"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb262-1" title="1"><span class="co"># $ pip3 install line_profiler memory_profiler</span></a>
<a class="sourceLine" id="cb262-2" title="2"><span class="at">@profile</span></a>
<a class="sourceLine" id="cb262-3" title="3"><span class="kw">def</span> main():</a>
<a class="sourceLine" id="cb262-4" title="4">    a <span class="op">=</span> [<span class="op">*</span><span class="bu">range</span>(<span class="dv">10000</span>)]</a>
<a class="sourceLine" id="cb262-5" title="5">    b <span class="op">=</span> {<span class="op">*</span><span class="bu">range</span>(<span class="dv">10000</span>)}</a>
<a class="sourceLine" id="cb262-6" title="6">main()</a></code></pre></div>
<pre class="text"><code>$ kernprof -lv test.py
Line #   Hits     Time  Per Hit   % Time  Line Contents
=======================================================
     1                                    @profile
     2                                    def main():
     3      1   1128.0   1128.0     27.4      a = [*range(10000)]
     4      1   2994.0   2994.0     72.6      b = {*range(10000)}</code></pre>
<pre class="text"><code>$ python3 -m memory_profiler test.py
Line #         Mem usage      Increment   Line Contents
=======================================================
     1        35.387 MiB     35.387 MiB   @profile
     2                                    def main():
     3        35.734 MiB      0.348 MiB       a = [*range(10000)]
     4        36.160 MiB      0.426 MiB       b = {*range(10000)}</code></pre>
<h3 id="call-graph">Call Graph</h3>
<h4 id="generates-a-png-image-of-a-call-graph-with-highlighted-bottlenecks">Generates a PNG image of a call graph with highlighted bottlenecks:</h4>
<div class="sourceCode" id="cb265"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb265-1" title="1"><span class="co"># $ pip3 install pycallgraph</span></a>
<a class="sourceLine" id="cb265-2" title="2"><span class="im">from</span> pycallgraph <span class="im">import</span> output, PyCallGraph</a>
<a class="sourceLine" id="cb265-3" title="3"><span class="im">from</span> datetime <span class="im">import</span> datetime</a>
<a class="sourceLine" id="cb265-4" title="4">time_str <span class="op">=</span> datetime.now().strftime(<span class="st">&#39;%Y%m</span><span class="sc">%d</span><span class="st">%H%M%S&#39;</span>)</a>
<a class="sourceLine" id="cb265-5" title="5">filename <span class="op">=</span> <span class="ss">f&#39;profile-</span><span class="sc">{</span>time_str<span class="sc">}</span><span class="ss">.png&#39;</span></a>
<a class="sourceLine" id="cb265-6" title="6">drawer <span class="op">=</span> output.GraphvizOutput(output_file<span class="op">=</span>filename)</a>
<a class="sourceLine" id="cb265-7" title="7"><span class="cf">with</span> PyCallGraph(drawer):</a>
<a class="sourceLine" id="cb265-8" title="8">    <span class="op">&lt;</span>code_to_be_profiled<span class="op">&gt;</span></a></code></pre></div>
<h2 id="numpy">NumPy</h2>
<p><strong>Array manipulation mini-language. It can run up to one hundred times faster than the equivalent Python code. An even faster alternative that runs on a GPU is called CuPy.</strong></p>
<div class="sourceCode" id="cb266"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb266-1" title="1"><span class="co"># $ pip3 install numpy</span></a>
<a class="sourceLine" id="cb266-2" title="2"><span class="im">import</span> numpy <span class="im">as</span> np</a></code></pre></div>
<div class="sourceCode" id="cb267"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb267-1" title="1"><span class="op">&lt;</span>array<span class="op">&gt;</span> <span class="op">=</span> np.array(<span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb267-2" title="2"><span class="op">&lt;</span>array<span class="op">&gt;</span> <span class="op">=</span> np.arange(from_inclusive, to_exclusive, ±step_size)</a>
<a class="sourceLine" id="cb267-3" title="3"><span class="op">&lt;</span>array<span class="op">&gt;</span> <span class="op">=</span> np.ones(<span class="op">&lt;</span>shape<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb267-4" title="4"><span class="op">&lt;</span>array<span class="op">&gt;</span> <span class="op">=</span> np.random.randint(from_inclusive, to_exclusive, <span class="op">&lt;</span>shape<span class="op">&gt;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb268"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb268-1" title="1"><span class="op">&lt;</span>array<span class="op">&gt;</span>.shape <span class="op">=</span> <span class="op">&lt;</span>shape<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb268-2" title="2"><span class="op">&lt;</span>view<span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span>array<span class="op">&gt;</span>.reshape(<span class="op">&lt;</span>shape<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb268-3" title="3"><span class="op">&lt;</span>view<span class="op">&gt;</span>  <span class="op">=</span> np.broadcast_to(<span class="op">&lt;</span>array<span class="op">&gt;</span>, <span class="op">&lt;</span>shape<span class="op">&gt;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb269"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb269-1" title="1"><span class="op">&lt;</span>array<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>array<span class="op">&gt;</span>.<span class="bu">sum</span>(axis)</a>
<a class="sourceLine" id="cb269-2" title="2">indexes <span class="op">=</span> <span class="op">&lt;</span>array<span class="op">&gt;</span>.argmin(axis)</a></code></pre></div>
<ul>
<li><strong>Shape is a tuple of dimension sizes.</strong></li>
<li><strong>Axis is the index of a dimension that gets collapsed. The leftmost dimension has index 0.</strong></li>
</ul>
<h3 id="indexing">Indexing</h3>
<div class="sourceCode" id="cb270"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb270-1" title="1"><span class="op">&lt;</span><span class="ex">el</span><span class="op">&gt;</span>       = <span class="op">&lt;</span>2d_array<span class="op">&gt;</span>[0, 0]        <span class="co"># First element.</span></a>
<a class="sourceLine" id="cb270-2" title="2"><span class="op">&lt;</span><span class="ex">1d_view</span><span class="op">&gt;</span>  = <span class="op">&lt;</span>2d_array<span class="op">&gt;</span>[0]           <span class="co"># First row.</span></a>
<a class="sourceLine" id="cb270-3" title="3"><span class="op">&lt;</span><span class="ex">1d_view</span><span class="op">&gt;</span>  = <span class="op">&lt;</span>2d_array<span class="op">&gt;</span>[:, 0]        <span class="co"># First column. Also [..., 0].</span></a>
<a class="sourceLine" id="cb270-4" title="4"><span class="op">&lt;</span><span class="ex">3d_view</span><span class="op">&gt;</span>  = <span class="op">&lt;</span>2d_array<span class="op">&gt;</span>[None, :, :]  <span class="co"># Expanded by dimension of size 1.</span></a></code></pre></div>
<div class="sourceCode" id="cb271"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb271-1" title="1"><span class="op">&lt;</span><span class="ex">1d_array</span><span class="op">&gt;</span> = <span class="op">&lt;</span>2d_array<span class="op">&gt;</span>[<span class="op">&lt;</span>1d_row_indexes<span class="op">&gt;</span>, <span class="op">&lt;</span>1d_column_indexes<span class="op">&gt;</span>]</a>
<a class="sourceLine" id="cb271-2" title="2"><span class="op">&lt;</span><span class="ex">2d_array</span><span class="op">&gt;</span> = <span class="op">&lt;</span>2d_array<span class="op">&gt;</span>[<span class="op">&lt;</span>2d_row_indexes<span class="op">&gt;</span>, <span class="op">&lt;</span>2d_column_indexes<span class="op">&gt;</span>]</a></code></pre></div>
<div class="sourceCode" id="cb272"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb272-1" title="1"><span class="op">&lt;</span><span class="ex">2d_bools</span><span class="op">&gt;</span> = <span class="op">&lt;</span>2d_array<span class="op">&gt;</span> <span class="op">&gt;</span> 0</a>
<a class="sourceLine" id="cb272-2" title="2"><span class="op">&lt;</span><span class="ex">1d_array</span><span class="op">&gt;</span> = <span class="op">&lt;</span>2d_array<span class="op">&gt;</span>[<span class="op">&lt;</span>2d_bools<span class="op">&gt;</span>]</a></code></pre></div>
<ul>
<li><strong>If row and column indexes differ in shape, they are combined with broadcasting.</strong></li>
</ul>
<h3 id="broadcasting">Broadcasting</h3>
<p><strong>Broadcasting is a set of rules by which NumPy functions operate on arrays of different sizes and/or dimensions.</strong></p>
<div class="sourceCode" id="cb273"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb273-1" title="1">left  <span class="op">=</span> [[<span class="fl">0.1</span>], [<span class="fl">0.6</span>], [<span class="fl">0.8</span>]]        <span class="co"># Shape: (3, 1)</span></a>
<a class="sourceLine" id="cb273-2" title="2">right <span class="op">=</span> [ <span class="fl">0.1</span> ,  <span class="fl">0.6</span> ,  <span class="fl">0.8</span> ]        <span class="co"># Shape: (3)</span></a></code></pre></div>
<h4 id="if-array-shapes-differ-in-length-left-pad-the-shorter-shape-with-ones">1. If array shapes differ in length, left-pad the shorter shape with ones:</h4>
<div class="sourceCode" id="cb274"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb274-1" title="1">left  <span class="op">=</span> [[<span class="fl">0.1</span>], [<span class="fl">0.6</span>], [<span class="fl">0.8</span>]]        <span class="co"># Shape: (3, 1)</span></a>
<a class="sourceLine" id="cb274-2" title="2">right <span class="op">=</span> [[<span class="fl">0.1</span> ,  <span class="fl">0.6</span> ,  <span class="fl">0.8</span>]]        <span class="co"># Shape: (1, 3) &lt;- !</span></a></code></pre></div>
<h4 id="if-any-dimensions-differ-in-size-expand-the-ones-that-have-size-1-by-duplicating-their-elements">2. If any dimensions differ in size, expand the ones that have size 1 by duplicating their elements:</h4>
<div class="sourceCode" id="cb275"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb275-1" title="1">left  <span class="op">=</span> [[<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>], [<span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="fl">0.6</span>], [<span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>]]  <span class="co"># Shape: (3, 3) &lt;- !</span></a>
<a class="sourceLine" id="cb275-2" title="2">right <span class="op">=</span> [[<span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>], [<span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>], [<span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>]]  <span class="co"># Shape: (3, 3) &lt;- !</span></a></code></pre></div>
<h4 id="if-neither-non-matching-dimension-has-size-1-raise-an-error.">3. If neither non-matching dimension has size 1, raise an error.</h4>
<h3 id="example-2">Example</h3>
<h4 id="for-each-point-returns-index-of-its-nearest-point-0.1-0.6-0.8-1-2-1">For each point returns index of its nearest point (<code>[0.1, 0.6, 0.8] =&gt; [1, 2, 1]</code>):</h4>
<div class="sourceCode" id="cb276"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb276-1" title="1"><span class="op">&gt;&gt;&gt;</span> points <span class="op">=</span> np.array([<span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>])</a>
<a class="sourceLine" id="cb276-2" title="2"> [ <span class="fl">0.1</span>,  <span class="fl">0.6</span>,  <span class="fl">0.8</span>]</a>
<a class="sourceLine" id="cb276-3" title="3"><span class="op">&gt;&gt;&gt;</span> wrapped_points <span class="op">=</span> points.reshape(<span class="dv">3</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb276-4" title="4">[[ <span class="fl">0.1</span>],</a>
<a class="sourceLine" id="cb276-5" title="5"> [ <span class="fl">0.6</span>],</a>
<a class="sourceLine" id="cb276-6" title="6"> [ <span class="fl">0.8</span>]]</a>
<a class="sourceLine" id="cb276-7" title="7"><span class="op">&gt;&gt;&gt;</span> distances <span class="op">=</span> wrapped_points <span class="op">-</span> points</a>
<a class="sourceLine" id="cb276-8" title="8">[[ <span class="fl">0.</span> , <span class="fl">-0.5</span>, <span class="fl">-0.7</span>],</a>
<a class="sourceLine" id="cb276-9" title="9"> [ <span class="fl">0.5</span>,  <span class="fl">0.</span> , <span class="fl">-0.2</span>],</a>
<a class="sourceLine" id="cb276-10" title="10"> [ <span class="fl">0.7</span>,  <span class="fl">0.2</span>,  <span class="fl">0.</span> ]]</a>
<a class="sourceLine" id="cb276-11" title="11"><span class="op">&gt;&gt;&gt;</span> distances <span class="op">=</span> np.<span class="bu">abs</span>(distances)</a>
<a class="sourceLine" id="cb276-12" title="12">[[ <span class="fl">0.</span> ,  <span class="fl">0.5</span>,  <span class="fl">0.7</span>],</a>
<a class="sourceLine" id="cb276-13" title="13"> [ <span class="fl">0.5</span>,  <span class="fl">0.</span> ,  <span class="fl">0.2</span>],</a>
<a class="sourceLine" id="cb276-14" title="14"> [ <span class="fl">0.7</span>,  <span class="fl">0.2</span>,  <span class="fl">0.</span> ]]</a>
<a class="sourceLine" id="cb276-15" title="15"><span class="op">&gt;&gt;&gt;</span> i <span class="op">=</span> np.arange(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb276-16" title="16">[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>]</a>
<a class="sourceLine" id="cb276-17" title="17"><span class="op">&gt;&gt;&gt;</span> distances[i, i] <span class="op">=</span> np.inf</a>
<a class="sourceLine" id="cb276-18" title="18">[[ inf,  <span class="fl">0.5</span>,  <span class="fl">0.7</span>],</a>
<a class="sourceLine" id="cb276-19" title="19"> [ <span class="fl">0.5</span>,  inf,  <span class="fl">0.2</span>],</a>
<a class="sourceLine" id="cb276-20" title="20"> [ <span class="fl">0.7</span>,  <span class="fl">0.2</span>,  inf]]</a>
<a class="sourceLine" id="cb276-21" title="21"><span class="op">&gt;&gt;&gt;</span> distances.argmin(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb276-22" title="22">[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>]</a></code></pre></div>
<h2 id="image">Image</h2>
<div class="sourceCode" id="cb277"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb277-1" title="1"><span class="co"># $ pip3 install pillow</span></a>
<a class="sourceLine" id="cb277-2" title="2"><span class="im">from</span> PIL <span class="im">import</span> Image</a></code></pre></div>
<div class="sourceCode" id="cb278"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb278-1" title="1"><span class="op">&lt;</span>Image<span class="op">&gt;</span> <span class="op">=</span> Image.new(<span class="st">&#39;&lt;mode&gt;&#39;</span>, (width, height))</a>
<a class="sourceLine" id="cb278-2" title="2"><span class="op">&lt;</span>Image<span class="op">&gt;</span> <span class="op">=</span> Image.<span class="bu">open</span>(<span class="st">&#39;&lt;path&gt;&#39;</span>)</a>
<a class="sourceLine" id="cb278-3" title="3"><span class="op">&lt;</span>Image<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Image<span class="op">&gt;</span>.convert(<span class="st">&#39;&lt;mode&gt;&#39;</span>)</a>
<a class="sourceLine" id="cb278-4" title="4"><span class="op">&lt;</span>Image<span class="op">&gt;</span>.save(<span class="st">&#39;&lt;path&gt;&#39;</span>)</a>
<a class="sourceLine" id="cb278-5" title="5"><span class="op">&lt;</span>Image<span class="op">&gt;</span>.show()</a></code></pre></div>
<div class="sourceCode" id="cb279"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb279-1" title="1"><span class="op">&lt;</span><span class="bu">int</span><span class="op">/</span><span class="bu">tuple</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Image<span class="op">&gt;</span>.getpixel((x, y))          <span class="co"># Returns a pixel.</span></a>
<a class="sourceLine" id="cb279-2" title="2"><span class="op">&lt;</span>Image<span class="op">&gt;</span>.putpixel((x, y), <span class="op">&lt;</span><span class="bu">int</span><span class="op">/</span><span class="bu">tuple</span><span class="op">&gt;</span>)           <span class="co"># Writes a pixel to the image.</span></a>
<a class="sourceLine" id="cb279-3" title="3"><span class="op">&lt;</span>ImagingCore<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Image<span class="op">&gt;</span>.getdata()               <span class="co"># Returns a sequence of pixels.</span></a>
<a class="sourceLine" id="cb279-4" title="4"><span class="op">&lt;</span>Image<span class="op">&gt;</span>.putdata(<span class="op">&lt;</span><span class="bu">list</span><span class="op">/</span>ImagingCore<span class="op">&gt;</span>)             <span class="co"># Writes a sequence of pixels.</span></a>
<a class="sourceLine" id="cb279-5" title="5"><span class="op">&lt;</span>Image<span class="op">&gt;</span>.paste(<span class="op">&lt;</span>Image<span class="op">&gt;</span>, (x, y))                  <span class="co"># Writes an image to the image.</span></a></code></pre></div>
<div class="sourceCode" id="cb280"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb280-1" title="1"><span class="op">&lt;</span><span class="ex">2d_array</span><span class="op">&gt;</span> = np.array(<span class="op">&lt;</span>Image_L<span class="op">&gt;</span>)                <span class="co"># Creates NumPy array from greyscale image.</span></a>
<a class="sourceLine" id="cb280-2" title="2"><span class="op">&lt;</span><span class="ex">3d_array</span><span class="op">&gt;</span> = np.array(<span class="op">&lt;</span>Image_RGB<span class="op">&gt;</span>)              <span class="co"># Creates NumPy array from color image.</span></a>
<a class="sourceLine" id="cb280-3" title="3"><span class="op">&lt;</span><span class="ex">Image</span><span class="op">&gt;</span>    = Image.fromarray(<span class="op">&lt;</span>array<span class="op">&gt;</span>)           <span class="co"># Creates image from NumPy array of floats.</span></a></code></pre></div>
<h3 id="modes-1">Modes</h3>
<ul>
<li><strong><code>'1'</code> - 1-bit pixels, black and white, stored with one pixel per byte.</strong></li>
<li><strong><code>'L'</code> - 8-bit pixels, greyscale.</strong></li>
<li><strong><code>'RGB'</code> - 3x8-bit pixels, true color.</strong></li>
<li><strong><code>'RGBA'</code> - 4x8-bit pixels, true color with transparency mask.</strong></li>
<li><strong><code>'HSV'</code> - 3x8-bit pixels, Hue, Saturation, Value color space.</strong></li>
</ul>
<h3 id="examples">Examples</h3>
<h4 id="creates-a-png-image-of-a-rainbow-gradient">Creates a PNG image of a rainbow gradient:</h4>
<div class="sourceCode" id="cb281"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb281-1" title="1">WIDTH, HEIGHT <span class="op">=</span> <span class="dv">100</span>, <span class="dv">100</span></a>
<a class="sourceLine" id="cb281-2" title="2">size <span class="op">=</span> WIDTH <span class="op">*</span> HEIGHT</a>
<a class="sourceLine" id="cb281-3" title="3">hues <span class="op">=</span> [<span class="dv">255</span> <span class="op">*</span> i<span class="op">/</span>size <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(size)]</a>
<a class="sourceLine" id="cb281-4" title="4">img <span class="op">=</span> Image.new(<span class="st">&#39;HSV&#39;</span>, (WIDTH, HEIGHT))</a>
<a class="sourceLine" id="cb281-5" title="5">img.putdata([(<span class="bu">int</span>(h), <span class="dv">255</span>, <span class="dv">255</span>) <span class="cf">for</span> h <span class="kw">in</span> hues])</a>
<a class="sourceLine" id="cb281-6" title="6">img.convert(<span class="st">&#39;RGB&#39;</span>).save(<span class="st">&#39;test.png&#39;</span>)</a></code></pre></div>
<h4 id="adds-noise-to-a-png-image">Adds noise to a PNG image:</h4>
<div class="sourceCode" id="cb282"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb282-1" title="1"><span class="im">from</span> random <span class="im">import</span> randint</a>
<a class="sourceLine" id="cb282-2" title="2">add_noise <span class="op">=</span> <span class="kw">lambda</span> value: <span class="bu">max</span>(<span class="dv">0</span>, <span class="bu">min</span>(<span class="dv">255</span>, value <span class="op">+</span> randint(<span class="op">-</span><span class="dv">20</span>, <span class="dv">20</span>)))</a>
<a class="sourceLine" id="cb282-3" title="3">img <span class="op">=</span> Image.<span class="bu">open</span>(<span class="st">&#39;test.png&#39;</span>).convert(<span class="st">&#39;HSV&#39;</span>)</a>
<a class="sourceLine" id="cb282-4" title="4">img.putdata([(add_noise(h), s, v) <span class="cf">for</span> h, s, v <span class="kw">in</span> img.getdata()])</a>
<a class="sourceLine" id="cb282-5" title="5">img.convert(<span class="st">&#39;RGB&#39;</span>).save(<span class="st">&#39;test.png&#39;</span>)</a></code></pre></div>
<h3 id="drawing">Drawing</h3>
<div class="sourceCode" id="cb283"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb283-1" title="1"><span class="im">from</span> PIL <span class="im">import</span> ImageDraw</a></code></pre></div>
<div class="sourceCode" id="cb284"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb284-1" title="1"><span class="op">&lt;</span>ImageDraw<span class="op">&gt;</span> <span class="op">=</span> ImageDraw.Draw(<span class="op">&lt;</span>Image<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb284-2" title="2"><span class="op">&lt;</span>ImageDraw<span class="op">&gt;</span>.point((x, y), fill<span class="op">=</span><span class="va">None</span>)</a>
<a class="sourceLine" id="cb284-3" title="3"><span class="op">&lt;</span>ImageDraw<span class="op">&gt;</span>.line((x1, y1, x2, y2 [, ...]), fill<span class="op">=</span><span class="va">None</span>, width<span class="op">=</span><span class="dv">0</span>, joint<span class="op">=</span><span class="va">None</span>) </a>
<a class="sourceLine" id="cb284-4" title="4"><span class="op">&lt;</span>ImageDraw<span class="op">&gt;</span>.arc((x1, y1, x2, y2), from_deg, to_deg, fill<span class="op">=</span><span class="va">None</span>, width<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb284-5" title="5"><span class="op">&lt;</span>ImageDraw<span class="op">&gt;</span>.rectangle((x1, y1, x2, y2), fill<span class="op">=</span><span class="va">None</span>, outline<span class="op">=</span><span class="va">None</span>, width<span class="op">=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb284-6" title="6"><span class="op">&lt;</span>ImageDraw<span class="op">&gt;</span>.polygon((x1, y1, x2, y2 [, ...]), fill<span class="op">=</span><span class="va">None</span>, outline<span class="op">=</span><span class="va">None</span>)</a>
<a class="sourceLine" id="cb284-7" title="7"><span class="op">&lt;</span>ImageDraw<span class="op">&gt;</span>.ellipse((x1, y1, x2, y2), fill<span class="op">=</span><span class="va">None</span>, outline<span class="op">=</span><span class="va">None</span>, width<span class="op">=</span><span class="dv">0</span>)</a></code></pre></div>
<ul>
<li><strong>Use <code>'fill=&lt;color&gt;'</code> to set the primary color.</strong></li>
<li><strong>Use <code>'outline=&lt;color&gt;'</code> to set the secondary color.</strong></li>
<li><strong>Color can be specified as a tuple, int, <code>'#rrggbb'</code> string or a color name.</strong></li>
</ul>
<h2 id="animation">Animation</h2>
<h4 id="creates-a-gif-of-a-bouncing-ball">Creates a GIF of a bouncing ball:</h4>
<div class="sourceCode" id="cb285"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb285-1" title="1"><span class="co"># $ pip3 install pillow imageio</span></a>
<a class="sourceLine" id="cb285-2" title="2"><span class="im">from</span> PIL <span class="im">import</span> Image, ImageDraw</a>
<a class="sourceLine" id="cb285-3" title="3"><span class="im">import</span> imageio</a>
<a class="sourceLine" id="cb285-4" title="4">WIDTH, R <span class="op">=</span> <span class="dv">126</span>, <span class="dv">10</span></a>
<a class="sourceLine" id="cb285-5" title="5">frames <span class="op">=</span> []</a>
<a class="sourceLine" id="cb285-6" title="6"><span class="cf">for</span> velocity <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">15</span>):</a>
<a class="sourceLine" id="cb285-7" title="7">    y <span class="op">=</span> <span class="bu">sum</span>(<span class="bu">range</span>(velocity<span class="op">+</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb285-8" title="8">    frame <span class="op">=</span> Image.new(<span class="st">&#39;L&#39;</span>, (WIDTH, WIDTH))</a>
<a class="sourceLine" id="cb285-9" title="9">    draw  <span class="op">=</span> ImageDraw.Draw(frame)</a>
<a class="sourceLine" id="cb285-10" title="10">    draw.ellipse((WIDTH<span class="op">/</span><span class="dv">2</span><span class="op">-</span>R, y, WIDTH<span class="op">/</span><span class="dv">2</span><span class="op">+</span>R, y<span class="op">+</span>R<span class="op">*</span><span class="dv">2</span>), fill<span class="op">=</span><span class="st">&#39;white&#39;</span>)</a>
<a class="sourceLine" id="cb285-11" title="11">    frames.append(frame)</a>
<a class="sourceLine" id="cb285-12" title="12">frames <span class="op">+=</span> <span class="bu">reversed</span>(frames[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb285-13" title="13">imageio.mimsave(<span class="st">&#39;test.gif&#39;</span>, frames, duration<span class="op">=</span><span class="fl">0.03</span>)</a></code></pre></div>
<h2 id="audio">Audio</h2>
<div class="sourceCode" id="cb286"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb286-1" title="1"><span class="im">import</span> wave</a></code></pre></div>
<div class="sourceCode" id="cb287"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb287-1" title="1"><span class="op">&lt;</span>Wave_read<span class="op">&gt;</span>  <span class="op">=</span> wave.<span class="bu">open</span>(<span class="st">&#39;&lt;path&gt;&#39;</span>, <span class="st">&#39;rb&#39;</span>)        <span class="co"># Opens the WAV file.</span></a>
<a class="sourceLine" id="cb287-2" title="2">framerate    <span class="op">=</span> <span class="op">&lt;</span>Wave_read<span class="op">&gt;</span>.getframerate()       <span class="co"># Number of frames per second.</span></a>
<a class="sourceLine" id="cb287-3" title="3">nchannels    <span class="op">=</span> <span class="op">&lt;</span>Wave_read<span class="op">&gt;</span>.getnchannels()       <span class="co"># Number of samples per frame.</span></a>
<a class="sourceLine" id="cb287-4" title="4">sampwidth    <span class="op">=</span> <span class="op">&lt;</span>Wave_read<span class="op">&gt;</span>.getsampwidth()       <span class="co"># Sample size in bytes.</span></a>
<a class="sourceLine" id="cb287-5" title="5">nframes      <span class="op">=</span> <span class="op">&lt;</span>Wave_read<span class="op">&gt;</span>.getnframes()         <span class="co"># Number of frames.</span></a>
<a class="sourceLine" id="cb287-6" title="6"><span class="op">&lt;</span>params<span class="op">&gt;</span>     <span class="op">=</span> <span class="op">&lt;</span>Wave_read<span class="op">&gt;</span>.getparams()          <span class="co"># Immutable collection of above.</span></a>
<a class="sourceLine" id="cb287-7" title="7"><span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span>      <span class="op">=</span> <span class="op">&lt;</span>Wave_read<span class="op">&gt;</span>.readframes(nframes)  <span class="co"># Returns next &#39;nframes&#39; frames.</span></a></code></pre></div>
<div class="sourceCode" id="cb288"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb288-1" title="1"><span class="op">&lt;</span>Wave_write<span class="op">&gt;</span> <span class="op">=</span> wave.<span class="bu">open</span>(<span class="st">&#39;&lt;path&gt;&#39;</span>, <span class="st">&#39;wb&#39;</span>)        <span class="co"># Truncates existing file.</span></a>
<a class="sourceLine" id="cb288-2" title="2"><span class="op">&lt;</span>Wave_write<span class="op">&gt;</span>.setframerate(<span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>)                <span class="co"># 44100 for CD, 48000 for video.</span></a>
<a class="sourceLine" id="cb288-3" title="3"><span class="op">&lt;</span>Wave_write<span class="op">&gt;</span>.setnchannels(<span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>)                <span class="co"># 1 for mono, 2 for stereo.</span></a>
<a class="sourceLine" id="cb288-4" title="4"><span class="op">&lt;</span>Wave_write<span class="op">&gt;</span>.setsampwidth(<span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>)                <span class="co"># 2 for CD quality sound.</span></a>
<a class="sourceLine" id="cb288-5" title="5"><span class="op">&lt;</span>Wave_write<span class="op">&gt;</span>.setparams(<span class="op">&lt;</span>params<span class="op">&gt;</span>)                <span class="co"># Sets all parameters.</span></a>
<a class="sourceLine" id="cb288-6" title="6"><span class="op">&lt;</span>Wave_write<span class="op">&gt;</span>.writeframes(<span class="op">&lt;</span><span class="bu">bytes</span><span class="op">&gt;</span>)               <span class="co"># Appends frames to the file.</span></a></code></pre></div>
<ul>
<li><strong>Bytes object contains a sequence of frames, each consisting of one or more samples.</strong></li>
<li><strong>In a stereo signal, the first sample of a frame belongs to the left channel.</strong></li>
<li><strong>Each sample consists of one or more bytes that, when converted to an integer, indicate the displacement of a speaker membrane at a given moment.</strong></li>
<li><strong>If sample width is one, then the integer should be encoded unsigned.</strong></li>
<li><strong>For all other sizes, the integer should be encoded signed with little-endian byte order.</strong></li>
</ul>
<h3 id="sample-values">Sample Values</h3>
<pre class="text"><code>+-----------+-------------+------+-------------+
| sampwidth |     min     | zero |     max     |
+-----------+-------------+------+-------------+
|     1     |           0 |  128 |         255 |
|     2     |      -32768 |    0 |       32767 |
|     3     |    -8388608 |    0 |     8388607 |
|     4     | -2147483648 |    0 |  2147483647 |
+-----------+-------------+------+-------------+</code></pre>
<h3 id="read-float-samples-from-wav-file">Read Float Samples from WAV File</h3>
<div class="sourceCode" id="cb290"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb290-1" title="1"><span class="kw">def</span> read_wav_file(filename):</a>
<a class="sourceLine" id="cb290-2" title="2">    <span class="kw">def</span> get_int(bytes_obj):</a>
<a class="sourceLine" id="cb290-3" title="3">        an_int <span class="op">=</span> <span class="bu">int</span>.from_bytes(bytes_obj, <span class="st">&#39;little&#39;</span>, signed<span class="op">=</span>sampwidth<span class="op">!=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb290-4" title="4">        <span class="cf">return</span> an_int <span class="op">-</span> <span class="dv">128</span> <span class="op">*</span> (sampwidth <span class="op">==</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb290-5" title="5">    <span class="cf">with</span> wave.<span class="bu">open</span>(filename, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb290-6" title="6">        sampwidth <span class="op">=</span> <span class="bu">file</span>.getsampwidth()</a>
<a class="sourceLine" id="cb290-7" title="7">        frames <span class="op">=</span> <span class="bu">file</span>.readframes(<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb290-8" title="8">    bytes_samples <span class="op">=</span> (frames[i: i <span class="op">+</span> sampwidth] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(frames), sampwidth))</a>
<a class="sourceLine" id="cb290-9" title="9">    <span class="cf">return</span> [get_int(b) <span class="op">/</span> <span class="bu">pow</span>(<span class="dv">2</span>, sampwidth <span class="op">*</span> <span class="dv">8</span> <span class="op">-</span> <span class="dv">1</span>) <span class="cf">for</span> b <span class="kw">in</span> bytes_samples]</a></code></pre></div>
<h3 id="write-float-samples-to-wav-file">Write Float Samples to WAV File</h3>
<div class="sourceCode" id="cb291"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb291-1" title="1"><span class="kw">def</span> write_to_wav_file(filename, float_samples, nchannels<span class="op">=</span><span class="dv">1</span>, sampwidth<span class="op">=</span><span class="dv">2</span>, framerate<span class="op">=</span><span class="dv">44100</span>):</a>
<a class="sourceLine" id="cb291-2" title="2">    <span class="kw">def</span> get_bytes(a_float):</a>
<a class="sourceLine" id="cb291-3" title="3">        a_float <span class="op">=</span> <span class="bu">max</span>(<span class="op">-</span><span class="dv">1</span>, <span class="bu">min</span>(<span class="dv">1</span> <span class="op">-</span> <span class="fl">2e-16</span>, a_float))</a>
<a class="sourceLine" id="cb291-4" title="4">        a_float <span class="op">+=</span> sampwidth <span class="op">==</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb291-5" title="5">        a_float <span class="op">*=</span> <span class="bu">pow</span>(<span class="dv">2</span>, sampwidth <span class="op">*</span> <span class="dv">8</span> <span class="op">-</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb291-6" title="6">        <span class="cf">return</span> <span class="bu">int</span>(a_float).to_bytes(sampwidth, <span class="st">&#39;little&#39;</span>, signed<span class="op">=</span>sampwidth<span class="op">!=</span><span class="dv">1</span>) </a>
<a class="sourceLine" id="cb291-7" title="7">    <span class="cf">with</span> wave.<span class="bu">open</span>(filename, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb291-8" title="8">        <span class="bu">file</span>.setnchannels(nchannels)</a>
<a class="sourceLine" id="cb291-9" title="9">        <span class="bu">file</span>.setsampwidth(sampwidth)</a>
<a class="sourceLine" id="cb291-10" title="10">        <span class="bu">file</span>.setframerate(framerate)</a>
<a class="sourceLine" id="cb291-11" title="11">        <span class="bu">file</span>.writeframes(b<span class="st">&#39;&#39;</span>.join(get_bytes(f) <span class="cf">for</span> f <span class="kw">in</span> float_samples))</a></code></pre></div>
<h3 id="examples-1">Examples</h3>
<h4 id="saves-a-sine-wave-to-a-mono-wav-file">Saves a sine wave to a mono WAV file:</h4>
<div class="sourceCode" id="cb292"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb292-1" title="1"><span class="im">from</span> math <span class="im">import</span> pi, sin</a>
<a class="sourceLine" id="cb292-2" title="2">samples_f <span class="op">=</span> (sin(i <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> pi <span class="op">*</span> <span class="dv">440</span> <span class="op">/</span> <span class="dv">44100</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100000</span>))</a>
<a class="sourceLine" id="cb292-3" title="3">write_to_wav_file(<span class="st">&#39;test.wav&#39;</span>, samples_f)</a></code></pre></div>
<h4 id="adds-noise-to-a-mono-wav-file">Adds noise to a mono WAV file:</h4>
<div class="sourceCode" id="cb293"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb293-1" title="1"><span class="im">from</span> random <span class="im">import</span> random</a>
<a class="sourceLine" id="cb293-2" title="2">add_noise <span class="op">=</span> <span class="kw">lambda</span> value: value <span class="op">+</span> (random() <span class="op">-</span> <span class="fl">0.5</span>) <span class="op">*</span> <span class="fl">0.03</span></a>
<a class="sourceLine" id="cb293-3" title="3">samples_f <span class="op">=</span> (add_noise(f) <span class="cf">for</span> f <span class="kw">in</span> read_wav_file(<span class="st">&#39;test.wav&#39;</span>))</a>
<a class="sourceLine" id="cb293-4" title="4">write_to_wav_file(<span class="st">&#39;test.wav&#39;</span>, samples_f)</a></code></pre></div>
<h4 id="plays-a-wav-file">Plays a WAV file:</h4>
<div class="sourceCode" id="cb294"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb294-1" title="1"><span class="co"># $ pip3 install simpleaudio</span></a>
<a class="sourceLine" id="cb294-2" title="2"><span class="im">from</span> simpleaudio <span class="im">import</span> play_buffer</a>
<a class="sourceLine" id="cb294-3" title="3"><span class="cf">with</span> wave.<span class="bu">open</span>(<span class="st">&#39;test.wav&#39;</span>, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb294-4" title="4">    p <span class="op">=</span> <span class="bu">file</span>.getparams()</a>
<a class="sourceLine" id="cb294-5" title="5">    frames <span class="op">=</span> <span class="bu">file</span>.readframes(<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb294-6" title="6">    play_buffer(frames, p.nchannels, p.sampwidth, p.framerate)</a></code></pre></div>
<h3 id="text-to-speech">Text to Speech</h3>
<div class="sourceCode" id="cb295"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb295-1" title="1"><span class="co"># $ pip3 install pyttsx3</span></a>
<a class="sourceLine" id="cb295-2" title="2"><span class="im">import</span> pyttsx3</a>
<a class="sourceLine" id="cb295-3" title="3">engine <span class="op">=</span> pyttsx3.init()</a>
<a class="sourceLine" id="cb295-4" title="4">engine.say(<span class="st">&#39;Sally sells seashells by the seashore.&#39;</span>)</a>
<a class="sourceLine" id="cb295-5" title="5">engine.runAndWait()</a></code></pre></div>
<h2 id="synthesizer">Synthesizer</h2>
<h4 id="plays-popcorn-by-gershon-kingsley">Plays Popcorn by Gershon Kingsley:</h4>
<div class="sourceCode" id="cb296"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb296-1" title="1"><span class="co"># $ pip3 install simpleaudio</span></a>
<a class="sourceLine" id="cb296-2" title="2"><span class="im">import</span> simpleaudio, math, struct</a>
<a class="sourceLine" id="cb296-3" title="3"><span class="im">from</span> itertools <span class="im">import</span> chain, repeat</a>
<a class="sourceLine" id="cb296-4" title="4">F  <span class="op">=</span> <span class="dv">44100</span></a>
<a class="sourceLine" id="cb296-5" title="5">P1 <span class="op">=</span> <span class="st">&#39;71♪,69,,71♪,66,,62♪,66,,59♪,,,&#39;</span></a>
<a class="sourceLine" id="cb296-6" title="6">P2 <span class="op">=</span> <span class="st">&#39;71♪,73,,74♪,73,,74,,71,,73♪,71,,73,,69,,71♪,69,,71,,67,,71♪,,,&#39;</span></a>
<a class="sourceLine" id="cb296-7" title="7">get_pause   <span class="op">=</span> <span class="kw">lambda</span> seconds: repeat(<span class="dv">0</span>, <span class="bu">int</span>(seconds <span class="op">*</span> F))</a>
<a class="sourceLine" id="cb296-8" title="8">sin_f       <span class="op">=</span> <span class="kw">lambda</span> i, hz: math.sin(i <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> math.pi <span class="op">*</span> hz <span class="op">/</span> F)</a>
<a class="sourceLine" id="cb296-9" title="9">get_wave    <span class="op">=</span> <span class="kw">lambda</span> hz, seconds: (sin_f(i, hz) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">int</span>(seconds <span class="op">*</span> F)))</a>
<a class="sourceLine" id="cb296-10" title="10">get_hz      <span class="op">=</span> <span class="kw">lambda</span> key: <span class="fl">8.176</span> <span class="op">*</span> <span class="dv">2</span> <span class="op">**</span> (<span class="bu">int</span>(key) <span class="op">/</span> <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb296-11" title="11">parse_note  <span class="op">=</span> <span class="kw">lambda</span> note: (get_hz(note[:<span class="dv">2</span>]), <span class="fl">0.25</span> <span class="cf">if</span> <span class="st">&#39;♪&#39;</span> <span class="kw">in</span> note <span class="cf">else</span> <span class="fl">0.125</span>)</a>
<a class="sourceLine" id="cb296-12" title="12">get_samples <span class="op">=</span> <span class="kw">lambda</span> note: get_wave(<span class="op">*</span>parse_note(note)) <span class="cf">if</span> note <span class="cf">else</span> get_pause(<span class="fl">0.125</span>)</a>
<a class="sourceLine" id="cb296-13" title="13">samples_f   <span class="op">=</span> chain.from_iterable(get_samples(n) <span class="cf">for</span> n <span class="kw">in</span> <span class="ss">f&#39;</span><span class="sc">{P1}{P1}{P2}</span><span class="ss">&#39;</span>.split(<span class="st">&#39;,&#39;</span>))</a>
<a class="sourceLine" id="cb296-14" title="14">samples_b   <span class="op">=</span> b<span class="st">&#39;&#39;</span>.join(struct.pack(<span class="st">&#39;&lt;h&#39;</span>, <span class="bu">int</span>(f <span class="op">*</span> <span class="dv">30000</span>)) <span class="cf">for</span> f <span class="kw">in</span> samples_f)</a>
<a class="sourceLine" id="cb296-15" title="15">simpleaudio.play_buffer(samples_b, <span class="dv">1</span>, <span class="dv">2</span>, F)</a></code></pre></div>
<h2 id="pygame">Pygame</h2>
<h3 id="basic-example-1">Basic Example</h3>
<div class="sourceCode" id="cb297"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb297-1" title="1"><span class="co"># $ pip3 install pygame</span></a>
<a class="sourceLine" id="cb297-2" title="2"><span class="im">import</span> pygame <span class="im">as</span> pg</a>
<a class="sourceLine" id="cb297-3" title="3">pg.init()</a>
<a class="sourceLine" id="cb297-4" title="4">screen <span class="op">=</span> pg.display.set_mode((<span class="dv">500</span>, <span class="dv">500</span>))</a>
<a class="sourceLine" id="cb297-5" title="5">rect <span class="op">=</span> pg.Rect(<span class="dv">240</span>, <span class="dv">240</span>, <span class="dv">20</span>, <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb297-6" title="6"><span class="cf">while</span> <span class="bu">all</span>(event.<span class="bu">type</span> <span class="op">!=</span> pg.QUIT <span class="cf">for</span> event <span class="kw">in</span> pg.event.get()):</a>
<a class="sourceLine" id="cb297-7" title="7">    deltas <span class="op">=</span> {pg.K_UP: (<span class="dv">0</span>, <span class="dv">-3</span>), pg.K_RIGHT: (<span class="dv">3</span>, <span class="dv">0</span>), pg.K_DOWN: (<span class="dv">0</span>, <span class="dv">3</span>), pg.K_LEFT: (<span class="op">-</span><span class="dv">3</span>, <span class="dv">0</span>)}</a>
<a class="sourceLine" id="cb297-8" title="8">    <span class="cf">for</span> key_code, is_pressed <span class="kw">in</span> <span class="bu">enumerate</span>(pg.key.get_pressed()):</a>
<a class="sourceLine" id="cb297-9" title="9">        rect <span class="op">=</span> rect.move(deltas[key_code]) <span class="cf">if</span> key_code <span class="kw">in</span> deltas <span class="kw">and</span> is_pressed <span class="cf">else</span> rect</a>
<a class="sourceLine" id="cb297-10" title="10">    screen.fill((<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb297-11" title="11">    pg.draw.rect(screen, (<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>), rect)</a>
<a class="sourceLine" id="cb297-12" title="12">    pg.display.flip()</a></code></pre></div>
<h3 id="rectangle">Rectangle</h3>
<p><strong>Object for storing rectangular coordinates.</strong></p>
<div class="sourceCode" id="cb298"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb298-1" title="1"><span class="op">&lt;</span>Rect<span class="op">&gt;</span> <span class="op">=</span> pg.Rect(x, y, width, height)           <span class="co"># X and y are coordinates of topleft corner.</span></a>
<a class="sourceLine" id="cb298-2" title="2"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span>Rect<span class="op">&gt;</span>.x<span class="op">/</span>y<span class="op">/</span>centerx<span class="op">/</span>centery<span class="op">/</span>…           <span class="co"># Top, right, bottom, left.</span></a>
<a class="sourceLine" id="cb298-3" title="3"><span class="op">&lt;</span>tup.<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Rect<span class="op">&gt;</span>.topleft<span class="op">/</span>center<span class="op">/</span>…                <span class="co"># Topright, bottomright, bottomleft.</span></a>
<a class="sourceLine" id="cb298-4" title="4"><span class="op">&lt;</span>Rect<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Rect<span class="op">&gt;</span>.move((x, y))                    <span class="co"># Use move_ip() to move in place.</span></a></code></pre></div>
<div class="sourceCode" id="cb299"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb299-1" title="1"><span class="op">&lt;</span><span class="bu">bool</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Rect<span class="op">&gt;</span>.collidepoint((x, y))            <span class="co"># Tests if a point is inside the rectangle.</span></a>
<a class="sourceLine" id="cb299-2" title="2"><span class="op">&lt;</span><span class="bu">bool</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Rect<span class="op">&gt;</span>.colliderect(<span class="op">&lt;</span>Rect<span class="op">&gt;</span>)             <span class="co"># Tests if two rectangles overlap.</span></a>
<a class="sourceLine" id="cb299-3" title="3"><span class="op">&lt;</span><span class="bu">int</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span>Rect<span class="op">&gt;</span>.collidelist(<span class="op">&lt;</span>list_of_Rect<span class="op">&gt;</span>)     <span class="co"># Returns index of first colliding Rect or -1.</span></a>
<a class="sourceLine" id="cb299-4" title="4"><span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Rect<span class="op">&gt;</span>.collidelistall(<span class="op">&lt;</span>list_of_Rect<span class="op">&gt;</span>)  <span class="co"># Returns indexes of all colliding Rects.</span></a></code></pre></div>
<h3 id="surface">Surface</h3>
<p><strong>Object for representing images.</strong></p>
<div class="sourceCode" id="cb300"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb300-1" title="1"><span class="op">&lt;</span>Surf<span class="op">&gt;</span> <span class="op">=</span> pg.display.set_mode((width, height))   <span class="co"># Returns the display surface.</span></a>
<a class="sourceLine" id="cb300-2" title="2"><span class="op">&lt;</span>Surf<span class="op">&gt;</span> <span class="op">=</span> pg.Surface((width, height))            <span class="co"># Creates a new surface.</span></a>
<a class="sourceLine" id="cb300-3" title="3"><span class="op">&lt;</span>Surf<span class="op">&gt;</span> <span class="op">=</span> pg.image.load(<span class="st">&#39;&lt;path&gt;&#39;</span>)                <span class="co"># Loads the image.</span></a>
<a class="sourceLine" id="cb300-4" title="4"><span class="op">&lt;</span>Surf<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Surf<span class="op">&gt;</span>.subsurface(<span class="op">&lt;</span>Rect<span class="op">&gt;</span>)              <span class="co"># Returns a subsurface.</span></a></code></pre></div>
<div class="sourceCode" id="cb301"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb301-1" title="1"><span class="op">&lt;</span>Surf<span class="op">&gt;</span>.fill(color)                              <span class="co"># Fills the whole surface.</span></a>
<a class="sourceLine" id="cb301-2" title="2"><span class="op">&lt;</span>Surf<span class="op">&gt;</span>.set_at((x, y), color)                    <span class="co"># Updates pixel.</span></a>
<a class="sourceLine" id="cb301-3" title="3"><span class="op">&lt;</span>Surf<span class="op">&gt;</span>.blit(<span class="op">&lt;</span>Surface<span class="op">&gt;</span>, (x, y))                  <span class="co"># Draws passed surface to the surface.</span></a></code></pre></div>
<div class="sourceCode" id="cb302"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb302-1" title="1"><span class="op">&lt;</span>Surf<span class="op">&gt;</span> <span class="op">=</span> pg.transform.flip(<span class="op">&lt;</span>Surf<span class="op">&gt;</span>, xbool, ybool)</a>
<a class="sourceLine" id="cb302-2" title="2"><span class="op">&lt;</span>Surf<span class="op">&gt;</span> <span class="op">=</span> pg.transform.rotate(<span class="op">&lt;</span>Surf<span class="op">&gt;</span>, degrees)</a>
<a class="sourceLine" id="cb302-3" title="3"><span class="op">&lt;</span>Surf<span class="op">&gt;</span> <span class="op">=</span> pg.transform.scale(<span class="op">&lt;</span>Surf<span class="op">&gt;</span>, (width, height))</a></code></pre></div>
<div class="sourceCode" id="cb303"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb303-1" title="1">pg.draw.line(<span class="op">&lt;</span>Surf<span class="op">&gt;</span>, color, (x1, y1), (x2, y2), width)</a>
<a class="sourceLine" id="cb303-2" title="2">pg.draw.arc(<span class="op">&lt;</span>Surf<span class="op">&gt;</span>, color, <span class="op">&lt;</span>Rect<span class="op">&gt;</span>, from_radians, to_radians)</a>
<a class="sourceLine" id="cb303-3" title="3">pg.draw.rect(<span class="op">&lt;</span>Surf<span class="op">&gt;</span>, color, <span class="op">&lt;</span>Rect<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb303-4" title="4">pg.draw.polygon(<span class="op">&lt;</span>Surf<span class="op">&gt;</span>, color, points)</a>
<a class="sourceLine" id="cb303-5" title="5">pg.draw.ellipse(<span class="op">&lt;</span>Surf<span class="op">&gt;</span>, color, <span class="op">&lt;</span>Rect<span class="op">&gt;</span>)</a></code></pre></div>
<h3 id="font">Font</h3>
<div class="sourceCode" id="cb304"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb304-1" title="1"><span class="op">&lt;</span>Font<span class="op">&gt;</span> <span class="op">=</span> pg.font.SysFont(<span class="st">&#39;&lt;name&gt;&#39;</span>, size, bold<span class="op">=</span><span class="va">False</span>, italic<span class="op">=</span><span class="va">False</span>)</a>
<a class="sourceLine" id="cb304-2" title="2"><span class="op">&lt;</span>Font<span class="op">&gt;</span> <span class="op">=</span> pg.font.Font(<span class="st">&#39;&lt;path&gt;&#39;</span>, size)</a>
<a class="sourceLine" id="cb304-3" title="3"><span class="op">&lt;</span>Surf<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Font<span class="op">&gt;</span>.render(text, antialias, color [, background])</a></code></pre></div>
<h3 id="sound">Sound</h3>
<div class="sourceCode" id="cb305"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb305-1" title="1"><span class="op">&lt;</span>Sound<span class="op">&gt;</span> <span class="op">=</span> pg.mixer.Sound(<span class="st">&#39;&lt;path&gt;&#39;</span>)              <span class="co"># Loads the WAV file.</span></a>
<a class="sourceLine" id="cb305-2" title="2"><span class="op">&lt;</span>Sound<span class="op">&gt;</span>.play()                                  <span class="co"># Starts playing the sound.</span></a></code></pre></div>
<h3 id="basic-mario-brothers-example">Basic Mario Brothers Example</h3>
<div class="sourceCode" id="cb306"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb306-1" title="1"><span class="im">import</span> collections, dataclasses, enum, io, pygame, urllib.request, itertools <span class="im">as</span> it</a>
<a class="sourceLine" id="cb306-2" title="2"><span class="im">from</span> random <span class="im">import</span> randint</a>
<a class="sourceLine" id="cb306-3" title="3"></a>
<a class="sourceLine" id="cb306-4" title="4">P <span class="op">=</span> collections.namedtuple(<span class="st">&#39;P&#39;</span>, <span class="st">&#39;x y&#39;</span>)          <span class="co"># Position</span></a>
<a class="sourceLine" id="cb306-5" title="5">D <span class="op">=</span> enum.Enum(<span class="st">&#39;D&#39;</span>, <span class="st">&#39;n e s w&#39;</span>)                   <span class="co"># Direction</span></a>
<a class="sourceLine" id="cb306-6" title="6">SIZE, MAX_SPEED <span class="op">=</span> <span class="dv">50</span>, P(<span class="dv">5</span>, <span class="dv">10</span>)                  <span class="co"># Screen size, Speed limit</span></a>
<a class="sourceLine" id="cb306-7" title="7"></a>
<a class="sourceLine" id="cb306-8" title="8"><span class="kw">def</span> main():</a>
<a class="sourceLine" id="cb306-9" title="9">    <span class="kw">def</span> get_screen():</a>
<a class="sourceLine" id="cb306-10" title="10">        pygame.init()</a>
<a class="sourceLine" id="cb306-11" title="11">        <span class="cf">return</span> pygame.display.set_mode(<span class="dv">2</span> <span class="op">*</span> [SIZE<span class="op">*</span><span class="dv">16</span>])</a>
<a class="sourceLine" id="cb306-12" title="12">    <span class="kw">def</span> get_images():</a>
<a class="sourceLine" id="cb306-13" title="13">        url <span class="op">=</span> <span class="st">&#39;https://gto76.github.io/python-cheatsheet/web/mario_bros.png&#39;</span></a>
<a class="sourceLine" id="cb306-14" title="14">        img <span class="op">=</span> pygame.image.load(io.BytesIO(urllib.request.urlopen(url).read()))</a>
<a class="sourceLine" id="cb306-15" title="15">        <span class="cf">return</span> [img.subsurface(get_rect(x, <span class="dv">0</span>)) <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(img.get_width() <span class="op">//</span> <span class="dv">16</span>)]</a>
<a class="sourceLine" id="cb306-16" title="16">    <span class="kw">def</span> get_mario():</a>
<a class="sourceLine" id="cb306-17" title="17">        Mario <span class="op">=</span> dataclasses.make_dataclass(<span class="st">&#39;Mario&#39;</span>, <span class="st">&#39;rect spd facing_left frame_cycle&#39;</span>.split())</a>
<a class="sourceLine" id="cb306-18" title="18">        <span class="cf">return</span> Mario(get_rect(<span class="dv">1</span>, <span class="dv">1</span>), P(<span class="dv">0</span>, <span class="dv">0</span>), <span class="va">False</span>, it.cycle(<span class="bu">range</span>(<span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb306-19" title="19">    <span class="kw">def</span> get_tiles():</a>
<a class="sourceLine" id="cb306-20" title="20">        positions <span class="op">=</span> [p <span class="cf">for</span> p <span class="kw">in</span> it.product(<span class="bu">range</span>(SIZE), repeat<span class="op">=</span><span class="dv">2</span>) <span class="cf">if</span> {<span class="op">*</span>p} <span class="op">&amp;</span> {<span class="dv">0</span>, SIZE<span class="dv">-1</span>}] <span class="op">+</span> <span class="op">\</span></a>
<a class="sourceLine" id="cb306-21" title="21">            [(randint(<span class="dv">1</span>, SIZE<span class="dv">-2</span>), randint(<span class="dv">2</span>, SIZE<span class="dv">-2</span>)) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(SIZE<span class="op">**</span><span class="dv">2</span> <span class="op">//</span> <span class="dv">10</span>)]</a>
<a class="sourceLine" id="cb306-22" title="22">        <span class="cf">return</span> [get_rect(<span class="op">*</span>p) <span class="cf">for</span> p <span class="kw">in</span> positions]</a>
<a class="sourceLine" id="cb306-23" title="23">    <span class="kw">def</span> get_rect(x, y):</a>
<a class="sourceLine" id="cb306-24" title="24">        <span class="cf">return</span> pygame.Rect(x<span class="op">*</span><span class="dv">16</span>, y<span class="op">*</span><span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb306-25" title="25">    run(get_screen(), get_images(), get_mario(), get_tiles())</a>
<a class="sourceLine" id="cb306-26" title="26"></a>
<a class="sourceLine" id="cb306-27" title="27"><span class="kw">def</span> run(screen, images, mario, tiles):</a>
<a class="sourceLine" id="cb306-28" title="28">    clock <span class="op">=</span> pygame.time.Clock()</a>
<a class="sourceLine" id="cb306-29" title="29">    <span class="cf">while</span> <span class="bu">all</span>(event.<span class="bu">type</span> <span class="op">!=</span> pygame.QUIT <span class="cf">for</span> event <span class="kw">in</span> pygame.event.get()):</a>
<a class="sourceLine" id="cb306-30" title="30">        keys <span class="op">=</span> {pygame.K_UP: D.n, pygame.K_RIGHT: D.e, pygame.K_DOWN: D.s, pygame.K_LEFT: D.w}</a>
<a class="sourceLine" id="cb306-31" title="31">        pressed <span class="op">=</span> {keys.get(i) <span class="cf">for</span> i, on <span class="kw">in</span> <span class="bu">enumerate</span>(pygame.key.get_pressed()) <span class="cf">if</span> on}</a>
<a class="sourceLine" id="cb306-32" title="32">        update_speed(mario, tiles, pressed)</a>
<a class="sourceLine" id="cb306-33" title="33">        update_position(mario, tiles)</a>
<a class="sourceLine" id="cb306-34" title="34">        draw(screen, images, mario, tiles, pressed)</a>
<a class="sourceLine" id="cb306-35" title="35">        clock.tick(<span class="dv">28</span>)</a>
<a class="sourceLine" id="cb306-36" title="36"></a>
<a class="sourceLine" id="cb306-37" title="37"><span class="kw">def</span> update_speed(mario, tiles, pressed):</a>
<a class="sourceLine" id="cb306-38" title="38">    x, y <span class="op">=</span> mario.spd</a>
<a class="sourceLine" id="cb306-39" title="39">    x <span class="op">+=</span> <span class="dv">2</span> <span class="op">*</span> ((D.e <span class="kw">in</span> pressed) <span class="op">-</span> (D.w <span class="kw">in</span> pressed))</a>
<a class="sourceLine" id="cb306-40" title="40">    x <span class="op">-=</span> x <span class="op">//</span> <span class="bu">abs</span>(x) <span class="cf">if</span> x <span class="cf">else</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb306-41" title="41">    y <span class="op">+=</span> <span class="dv">1</span> <span class="cf">if</span> D.s <span class="kw">not</span> <span class="kw">in</span> get_boundaries(mario.rect, tiles) <span class="cf">else</span> (D.n <span class="kw">in</span> pressed) <span class="op">*</span> <span class="dv">-10</span></a>
<a class="sourceLine" id="cb306-42" title="42">    mario.spd <span class="op">=</span> P(<span class="op">*</span>[<span class="bu">max</span>(<span class="op">-</span>limit, <span class="bu">min</span>(limit, s)) <span class="cf">for</span> limit, s <span class="kw">in</span> <span class="bu">zip</span>(MAX_SPEED, P(x, y))])</a>
<a class="sourceLine" id="cb306-43" title="43"></a>
<a class="sourceLine" id="cb306-44" title="44"><span class="kw">def</span> update_position(mario, tiles):</a>
<a class="sourceLine" id="cb306-45" title="45">    new_p <span class="op">=</span> mario.rect.topleft</a>
<a class="sourceLine" id="cb306-46" title="46">    larger_speed <span class="op">=</span> <span class="bu">max</span>(<span class="bu">abs</span>(s) <span class="cf">for</span> s <span class="kw">in</span> mario.spd)</a>
<a class="sourceLine" id="cb306-47" title="47">    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(larger_speed):</a>
<a class="sourceLine" id="cb306-48" title="48">        mario.spd <span class="op">=</span> stop_on_collision(mario.spd, get_boundaries(mario.rect, tiles))</a>
<a class="sourceLine" id="cb306-49" title="49">        new_p <span class="op">=</span> P(<span class="op">*</span>[a <span class="op">+</span> s<span class="op">/</span>larger_speed <span class="cf">for</span> a, s <span class="kw">in</span> <span class="bu">zip</span>(new_p, mario.spd)])</a>
<a class="sourceLine" id="cb306-50" title="50">        mario.rect.topleft <span class="op">=</span> new_p</a>
<a class="sourceLine" id="cb306-51" title="51"></a>
<a class="sourceLine" id="cb306-52" title="52"><span class="kw">def</span> get_boundaries(rect, tiles):</a>
<a class="sourceLine" id="cb306-53" title="53">    deltas <span class="op">=</span> {D.n: P(<span class="dv">0</span>, <span class="dv">-1</span>), D.e: P(<span class="dv">1</span>, <span class="dv">0</span>), D.s: P(<span class="dv">0</span>, <span class="dv">1</span>), D.w: P(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>)}</a>
<a class="sourceLine" id="cb306-54" title="54">    <span class="cf">return</span> {d <span class="cf">for</span> d, delta <span class="kw">in</span> deltas.items() <span class="cf">if</span> rect.move(delta).collidelist(tiles) <span class="op">!=</span> <span class="dv">-1</span>}</a>
<a class="sourceLine" id="cb306-55" title="55"></a>
<a class="sourceLine" id="cb306-56" title="56"><span class="kw">def</span> stop_on_collision(spd, bounds):</a>
<a class="sourceLine" id="cb306-57" title="57">    <span class="cf">return</span> P(x<span class="op">=</span><span class="dv">0</span> <span class="cf">if</span> (D.w <span class="kw">in</span> bounds <span class="kw">and</span> spd.x <span class="op">&lt;</span> <span class="dv">0</span>) <span class="kw">or</span> (D.e <span class="kw">in</span> bounds <span class="kw">and</span> spd.x <span class="op">&gt;</span> <span class="dv">0</span>) <span class="cf">else</span> spd.x,</a>
<a class="sourceLine" id="cb306-58" title="58">             y<span class="op">=</span><span class="dv">0</span> <span class="cf">if</span> (D.n <span class="kw">in</span> bounds <span class="kw">and</span> spd.y <span class="op">&lt;</span> <span class="dv">0</span>) <span class="kw">or</span> (D.s <span class="kw">in</span> bounds <span class="kw">and</span> spd.y <span class="op">&gt;</span> <span class="dv">0</span>) <span class="cf">else</span> spd.y)</a>
<a class="sourceLine" id="cb306-59" title="59"></a>
<a class="sourceLine" id="cb306-60" title="60"><span class="kw">def</span> draw(screen, images, mario, tiles, pressed):</a>
<a class="sourceLine" id="cb306-61" title="61">    <span class="kw">def</span> get_frame_index():</a>
<a class="sourceLine" id="cb306-62" title="62">        <span class="cf">if</span> D.s <span class="kw">not</span> <span class="kw">in</span> get_boundaries(mario.rect, tiles):</a>
<a class="sourceLine" id="cb306-63" title="63">            <span class="cf">return</span> <span class="dv">4</span></a>
<a class="sourceLine" id="cb306-64" title="64">        <span class="cf">return</span> <span class="bu">next</span>(mario.frame_cycle) <span class="cf">if</span> {D.w, D.e} <span class="op">&amp;</span> pressed <span class="cf">else</span> <span class="dv">6</span></a>
<a class="sourceLine" id="cb306-65" title="65">    screen.fill((<span class="dv">85</span>, <span class="dv">168</span>, <span class="dv">255</span>))</a>
<a class="sourceLine" id="cb306-66" title="66">    mario.facing_left <span class="op">=</span> (D.w <span class="kw">in</span> pressed) <span class="cf">if</span> {D.w, D.e} <span class="op">&amp;</span> pressed <span class="cf">else</span> mario.facing_left</a>
<a class="sourceLine" id="cb306-67" title="67">    screen.blit(images[get_frame_index() <span class="op">+</span> mario.facing_left <span class="op">*</span> <span class="dv">9</span>], mario.rect)</a>
<a class="sourceLine" id="cb306-68" title="68">    <span class="cf">for</span> rect <span class="kw">in</span> tiles:</a>
<a class="sourceLine" id="cb306-69" title="69">        screen.blit(images[<span class="dv">18</span> <span class="cf">if</span> {<span class="op">*</span>rect.topleft} <span class="op">&amp;</span> {<span class="dv">0</span>, (SIZE<span class="dv">-1</span>)<span class="op">*</span><span class="dv">16</span>} <span class="cf">else</span> <span class="dv">19</span>], rect)</a>
<a class="sourceLine" id="cb306-70" title="70">    pygame.display.flip()</a>
<a class="sourceLine" id="cb306-71" title="71"></a>
<a class="sourceLine" id="cb306-72" title="72"><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</a>
<a class="sourceLine" id="cb306-73" title="73">    main()</a></code></pre></div>
<h2 id="pandas">Pandas</h2>
<div class="sourceCode" id="cb307"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb307-1" title="1"><span class="co"># $ pip3 install pandas</span></a>
<a class="sourceLine" id="cb307-2" title="2"><span class="im">import</span> pandas <span class="im">as</span> pd</a>
<a class="sourceLine" id="cb307-3" title="3"><span class="im">from</span> pandas <span class="im">import</span> Series, DataFrame</a></code></pre></div>
<h3 id="series">Series</h3>
<p><strong>Ordered dictionary with a name.</strong></p>
<div class="sourceCode" id="cb308"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb308-1" title="1"><span class="op">&gt;&gt;&gt;</span> Series([<span class="dv">1</span>, <span class="dv">2</span>], index<span class="op">=</span>[<span class="st">&#39;x&#39;</span>, <span class="st">&#39;y&#39;</span>], name<span class="op">=</span><span class="st">&#39;a&#39;</span>)</a>
<a class="sourceLine" id="cb308-2" title="2">x    <span class="dv">1</span></a>
<a class="sourceLine" id="cb308-3" title="3">y    <span class="dv">2</span></a>
<a class="sourceLine" id="cb308-4" title="4">Name: a, dtype: int64</a></code></pre></div>
<div class="sourceCode" id="cb309"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb309-1" title="1"><span class="op">&lt;</span>Sr<span class="op">&gt;</span> <span class="op">=</span> Series(<span class="op">&lt;</span><span class="bu">list</span><span class="op">&gt;</span>)                         <span class="co"># Assigns RangeIndex starting at 0.</span></a>
<a class="sourceLine" id="cb309-2" title="2"><span class="op">&lt;</span>Sr<span class="op">&gt;</span> <span class="op">=</span> Series(<span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span>)                         <span class="co"># Takes dictionary&#39;s keys for index.</span></a>
<a class="sourceLine" id="cb309-3" title="3"><span class="op">&lt;</span>Sr<span class="op">&gt;</span> <span class="op">=</span> Series(<span class="op">&lt;</span><span class="bu">dict</span><span class="op">/</span>Series<span class="op">&gt;</span>, index<span class="op">=&lt;</span><span class="bu">list</span><span class="op">&gt;</span>)    <span class="co"># Only keeps items with keys specified in index.</span></a></code></pre></div>
<div class="sourceCode" id="cb310"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb310-1" title="1"><span class="op">&lt;</span>el<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Sr<span class="op">&gt;</span>.loc[key]                          <span class="co"># Or: &lt;Sr&gt;.iloc[index]</span></a>
<a class="sourceLine" id="cb310-2" title="2"><span class="op">&lt;</span>Sr<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Sr<span class="op">&gt;</span>.loc[keys]                         <span class="co"># Or: &lt;Sr&gt;.iloc[indexes]</span></a>
<a class="sourceLine" id="cb310-3" title="3"><span class="op">&lt;</span>Sr<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Sr<span class="op">&gt;</span>.loc[from_key : to_key_inclusive]  <span class="co"># Or: &lt;Sr&gt;.iloc[from_i : to_i_exclusive]</span></a></code></pre></div>
<div class="sourceCode" id="cb311"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb311-1" title="1"><span class="op">&lt;</span>el<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Sr<span class="op">&gt;</span>[key<span class="op">/</span>index]                        <span class="co"># Or: &lt;Sr&gt;.key</span></a>
<a class="sourceLine" id="cb311-2" title="2"><span class="op">&lt;</span>Sr<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Sr<span class="op">&gt;</span>[keys<span class="op">/</span>indexes]                     <span class="co"># Or: &lt;Sr&gt;[&lt;key_range/range&gt;]</span></a>
<a class="sourceLine" id="cb311-3" title="3"><span class="op">&lt;</span>Sr<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Sr<span class="op">&gt;</span>[bools]                            <span class="co"># Or: &lt;Sr&gt;.i/loc[bools]</span></a></code></pre></div>
<div class="sourceCode" id="cb312"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb312-1" title="1"><span class="op">&lt;</span>Sr<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Sr<span class="op">&gt;</span> <span class="op">&gt;&lt;==</span> <span class="op">&lt;</span>el<span class="op">/</span>Sr<span class="op">&gt;</span>                      <span class="co"># Returns a Series of bools.</span></a>
<a class="sourceLine" id="cb312-2" title="2"><span class="op">&lt;</span>Sr<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Sr<span class="op">&gt;</span> <span class="op">+-*/</span> <span class="op">&lt;</span>el<span class="op">/</span>Sr<span class="op">&gt;</span>                      <span class="co"># Non-matching keys get value NaN.</span></a></code></pre></div>
<div class="sourceCode" id="cb313"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb313-1" title="1"><span class="op">&lt;</span>Sr<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Sr<span class="op">&gt;</span>.append(<span class="op">&lt;</span>Sr<span class="op">&gt;</span>)                      <span class="co"># Or: pd.concat(&lt;coll_of_Sr&gt;)</span></a>
<a class="sourceLine" id="cb313-2" title="2"><span class="op">&lt;</span>Sr<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Sr<span class="op">&gt;</span>.combine_first(<span class="op">&lt;</span>Sr<span class="op">&gt;</span>)               <span class="co"># Adds items that are not yet present.</span></a>
<a class="sourceLine" id="cb313-3" title="3"><span class="op">&lt;</span>Sr<span class="op">&gt;</span>.update(<span class="op">&lt;</span>Sr<span class="op">&gt;</span>)                             <span class="co"># Updates items that are already present.</span></a></code></pre></div>
<h4 id="aggregate-transform-map">Aggregate, Transform, Map:</h4>
<div class="sourceCode" id="cb314"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb314-1" title="1"><span class="op">&lt;</span>el<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Sr<span class="op">&gt;</span>.<span class="bu">sum</span><span class="op">/</span><span class="bu">max</span><span class="op">/</span>mean<span class="op">/</span>idxmax<span class="op">/</span><span class="bu">all</span>()         <span class="co"># Or: &lt;Sr&gt;.aggregate(&lt;agg_func&gt;)</span></a>
<a class="sourceLine" id="cb314-2" title="2"><span class="op">&lt;</span>Sr<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Sr<span class="op">&gt;</span>.rank<span class="op">/</span>diff<span class="op">/</span>cumsum<span class="op">/</span>ffill<span class="op">/</span>interpl()  <span class="co"># Or: &lt;Sr&gt;.agg/transform(&lt;trans_func&gt;)</span></a>
<a class="sourceLine" id="cb314-3" title="3"><span class="op">&lt;</span>Sr<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Sr<span class="op">&gt;</span>.fillna(<span class="op">&lt;</span>el<span class="op">&gt;</span>)                      <span class="co"># Or: &lt;Sr&gt;.apply/agg/transform/map(&lt;map_func&gt;)</span></a></code></pre></div>
<ul>
<li><strong>The way <code>'aggregate()'</code> and <code>'transform()'</code> find out whether the passed function accepts an element or the whole Series is by passing it a single value at first and if it raises an error, then they pass it the whole Series.</strong></li>
</ul>
<div class="sourceCode" id="cb315"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb315-1" title="1"><span class="op">&gt;&gt;&gt;</span> sr <span class="op">=</span> Series([<span class="dv">1</span>, <span class="dv">2</span>], index<span class="op">=</span>[<span class="st">&#39;x&#39;</span>, <span class="st">&#39;y&#39;</span>])</a>
<a class="sourceLine" id="cb315-2" title="2">x    <span class="dv">1</span></a>
<a class="sourceLine" id="cb315-3" title="3">y    <span class="dv">2</span></a></code></pre></div>
<pre class="text"><code>+-------------+-------------+-------------+---------------+
|             |    &#39;sum&#39;    |   [&#39;sum&#39;]   | {&#39;s&#39;: &#39;sum&#39;}  |
+-------------+-------------+-------------+---------------+
| sr.apply(…) |      3      |    sum  3   |     s  3      |
| sr.agg(…)   |             |             |               |
+-------------+-------------+-------------+---------------+</code></pre>
<pre class="text"><code>+-------------+-------------+-------------+---------------+
|             |    &#39;rank&#39;   |   [&#39;rank&#39;]  | {&#39;r&#39;: &#39;rank&#39;} |
+-------------+-------------+-------------+---------------+
| sr.apply(…) |             |      rank   |               |
| sr.agg(…)   |     x  1    |   x     1   |    r  x  1    |
| sr.trans(…) |     y  2    |   y     2   |       y  2    |
+-------------+-------------+-------------+---------------+</code></pre>
<ul>
<li><strong>Last result has a hierarchical index. Use <code>'&lt;Sr&gt;[key_1, key_2]'</code> to get its values.</strong></li>
</ul>
<h3 id="dataframe">DataFrame</h3>
<p><strong>Table with labeled rows and columns.</strong></p>
<div class="sourceCode" id="cb318"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb318-1" title="1"><span class="op">&gt;&gt;&gt;</span> DataFrame([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]], index<span class="op">=</span>[<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>], columns<span class="op">=</span>[<span class="st">&#39;x&#39;</span>, <span class="st">&#39;y&#39;</span>])</a>
<a class="sourceLine" id="cb318-2" title="2">   x  y</a>
<a class="sourceLine" id="cb318-3" title="3">a  <span class="dv">1</span>  <span class="dv">2</span></a>
<a class="sourceLine" id="cb318-4" title="4">b  <span class="dv">3</span>  <span class="dv">4</span></a></code></pre></div>
<div class="sourceCode" id="cb319"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb319-1" title="1"><span class="op">&lt;</span>DF<span class="op">&gt;</span>    <span class="op">=</span> DataFrame(<span class="op">&lt;</span>list_of_rows<span class="op">&gt;</span>)           <span class="co"># Rows can be either lists, dicts or series.</span></a>
<a class="sourceLine" id="cb319-2" title="2"><span class="op">&lt;</span>DF<span class="op">&gt;</span>    <span class="op">=</span> DataFrame(<span class="op">&lt;</span>dict_of_columns<span class="op">&gt;</span>)        <span class="co"># Columns can be either lists, dicts or series.</span></a></code></pre></div>
<div class="sourceCode" id="cb320"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb320-1" title="1"><span class="op">&lt;</span>el<span class="op">&gt;</span>    <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span>.loc[row_key, column_key]       <span class="co"># Or: &lt;DF&gt;.iloc[row_index, column_index]</span></a>
<a class="sourceLine" id="cb320-2" title="2"><span class="op">&lt;</span>Sr<span class="op">/</span>DF<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span>.loc[row_key<span class="op">/</span>s]                 <span class="co"># Or: &lt;DF&gt;.iloc[row_index/es]</span></a>
<a class="sourceLine" id="cb320-3" title="3"><span class="op">&lt;</span>Sr<span class="op">/</span>DF<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span>.loc[:, column_key<span class="op">/</span>s]           <span class="co"># Or: &lt;DF&gt;.iloc[:, column_index/es]</span></a>
<a class="sourceLine" id="cb320-4" title="4"><span class="op">&lt;</span>DF<span class="op">&gt;</span>    <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span>.loc[row_bools, column_bools]   <span class="co"># Or: &lt;DF&gt;.iloc[row_bools, column_bools]</span></a></code></pre></div>
<div class="sourceCode" id="cb321"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb321-1" title="1"><span class="op">&lt;</span>Sr<span class="op">/</span>DF<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span>[column_key<span class="op">/</span>s]                  <span class="co"># Or: &lt;DF&gt;.column_key</span></a>
<a class="sourceLine" id="cb321-2" title="2"><span class="op">&lt;</span>DF<span class="op">&gt;</span>    <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span>[row_bools]                     <span class="co"># Keeps rows as specified by bools.</span></a>
<a class="sourceLine" id="cb321-3" title="3"><span class="op">&lt;</span>DF<span class="op">&gt;</span>    <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span>[<span class="op">&lt;</span>DF_of_bools<span class="op">&gt;</span>]                 <span class="co"># Assigns NaN to False values.</span></a></code></pre></div>
<div class="sourceCode" id="cb322"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb322-1" title="1"><span class="op">&lt;</span>DF<span class="op">&gt;</span>    <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span> <span class="op">&gt;&lt;==</span> <span class="op">&lt;</span>el<span class="op">/</span>Sr<span class="op">/</span>DF<span class="op">&gt;</span>                <span class="co"># Returns DataFrame of bools.</span></a>
<a class="sourceLine" id="cb322-2" title="2"><span class="op">&lt;</span>DF<span class="op">&gt;</span>    <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span> <span class="op">+-*/</span> <span class="op">&lt;</span>el<span class="op">/</span>Sr<span class="op">/</span>DF<span class="op">&gt;</span>                <span class="co"># Non-matching keys get value NaN.</span></a></code></pre></div>
<div class="sourceCode" id="cb323"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb323-1" title="1"><span class="op">&lt;</span>DF<span class="op">&gt;</span>    <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span>.set_index(column_key)          <span class="co"># Replaces row keys with values from a column.</span></a>
<a class="sourceLine" id="cb323-2" title="2"><span class="op">&lt;</span>DF<span class="op">&gt;</span>    <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span>.reset_index()                  <span class="co"># Moves row keys to their own column.</span></a>
<a class="sourceLine" id="cb323-3" title="3"><span class="op">&lt;</span>DF<span class="op">&gt;</span>    <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span>.<span class="bu">filter</span>(<span class="st">&#39;&lt;regex&gt;&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)      <span class="co"># Only keeps columns whose key matches the regex.</span></a>
<a class="sourceLine" id="cb323-4" title="4"><span class="op">&lt;</span>DF<span class="op">&gt;</span>    <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span>.melt(id_vars<span class="op">=</span>column_key<span class="op">/</span>s)     <span class="co"># Converts DF from wide to long format.</span></a></code></pre></div>
<h4 id="merge-join-concat">Merge, Join, Concat:</h4>
<div class="sourceCode" id="cb324"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb324-1" title="1"><span class="op">&gt;&gt;&gt;</span> l <span class="op">=</span> DataFrame([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]], index<span class="op">=</span>[<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>], columns<span class="op">=</span>[<span class="st">&#39;x&#39;</span>, <span class="st">&#39;y&#39;</span>])</a>
<a class="sourceLine" id="cb324-2" title="2">   x  y </a>
<a class="sourceLine" id="cb324-3" title="3">a  <span class="dv">1</span>  <span class="dv">2</span> </a>
<a class="sourceLine" id="cb324-4" title="4">b  <span class="dv">3</span>  <span class="dv">4</span> </a>
<a class="sourceLine" id="cb324-5" title="5"><span class="op">&gt;&gt;&gt;</span> r <span class="op">=</span> DataFrame([[<span class="dv">4</span>, <span class="dv">5</span>], [<span class="dv">6</span>, <span class="dv">7</span>]], index<span class="op">=</span>[<span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>], columns<span class="op">=</span>[<span class="st">&#39;y&#39;</span>, <span class="st">&#39;z&#39;</span>])</a>
<a class="sourceLine" id="cb324-6" title="6">   y  z</a>
<a class="sourceLine" id="cb324-7" title="7">b  <span class="dv">4</span>  <span class="dv">5</span></a>
<a class="sourceLine" id="cb324-8" title="8">c  <span class="dv">6</span>  <span class="dv">7</span></a></code></pre></div>
<pre class="text"><code>+------------------------+---------------+------------+------------+--------------------------+
|                        |    &#39;outer&#39;    |   &#39;inner&#39;  |   &#39;left&#39;   |       Description        |
+------------------------+---------------+------------+------------+--------------------------+
| l.merge(r, on=&#39;y&#39;,     |    x   y   z  | x   y   z  | x   y   z  | Joins/merges on column.  |
|            how=…)      | 0  1   2   .  | 3   4   5  | 1   2   .  | Also accepts left_on and |
|                        | 1  3   4   5  |            | 3   4   5  | right_on parameters.     |
|                        | 2  .   6   7  |            |            | Uses &#39;inner&#39; by default. |
+------------------------+---------------+------------+------------+--------------------------+
| l.join(r, lsuffix=&#39;l&#39;, |    x yl yr  z |            | x yl yr  z | Joins/merges on row keys.|
|           rsuffix=&#39;r&#39;, | a  1  2  .  . | x yl yr  z | 1  2  .  . | Uses &#39;left&#39; by default.  |
|           how=…)       | b  3  4  4  5 | 3  4  4  5 | 3  4  4  5 |                          |
|                        | c  .  .  6  7 |            |            |                          |
+------------------------+---------------+------------+------------+--------------------------+
| pd.concat([l, r],      |    x   y   z  |     y      |            | Adds rows at the bottom. |
|           axis=0,      | a  1   2   .  |     2      |            | Uses &#39;outer&#39; by default. |
|           join=…)      | b  3   4   .  |     4      |            | By default works the     |
|                        | b  .   4   5  |     4      |            | same as `l.append(r)`.   |
|                        | c  .   6   7  |     6      |            |                          |
+------------------------+---------------+------------+------------+--------------------------+
| pd.concat([l, r],      |    x  y  y  z |            |            | Adds columns at the      |
|           axis=1,      | a  1  2  .  . | x  y  y  z |            | right end.               |
|           join=…)      | b  3  4  4  5 | 3  4  4  5 |            | Uses &#39;outer&#39; by default. |
|                        | c  .  .  6  7 |            |            |                          |
+------------------------+---------------+------------+------------+--------------------------+
| l.combine_first(r)     |    x   y   z  |            |            | Adds missing rows and    |
|                        | a  1   2   .  |            |            | columns.                 |
|                        | b  3   4   5  |            |            |                          |
|                        | c  .   6   7  |            |            |                          |
+------------------------+---------------+------------+------------+--------------------------+</code></pre>
<h4 id="aggregate-transform-map-1">Aggregate, Transform, Map:</h4>
<div class="sourceCode" id="cb326"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb326-1" title="1"><span class="op">&lt;</span>Sr<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span>.<span class="bu">sum</span><span class="op">/</span><span class="bu">max</span><span class="op">/</span>mean<span class="op">/</span>idxmax<span class="op">/</span><span class="bu">all</span>()         <span class="co"># Or: &lt;DF&gt;.apply/agg/transform(&lt;agg_func&gt;)</span></a>
<a class="sourceLine" id="cb326-2" title="2"><span class="op">&lt;</span>DF<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span>.rank<span class="op">/</span>diff<span class="op">/</span>cumsum<span class="op">/</span>ffill<span class="op">/</span>interpl()  <span class="co"># Or: &lt;DF&gt;.apply/agg/transform(&lt;trans_func&gt;)</span></a>
<a class="sourceLine" id="cb326-3" title="3"><span class="op">&lt;</span>DF<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span>.fillna(<span class="op">&lt;</span>el<span class="op">&gt;</span>)                      <span class="co"># Or: &lt;DF&gt;.applymap(&lt;map_func&gt;)</span></a></code></pre></div>
<ul>
<li><strong>All operations operate on columns by default. Use <code>'axis=1'</code> parameter to process the rows instead.</strong></li>
</ul>
<div class="sourceCode" id="cb327"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb327-1" title="1"><span class="op">&gt;&gt;&gt;</span> df <span class="op">=</span> DataFrame([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]], index<span class="op">=</span>[<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>], columns<span class="op">=</span>[<span class="st">&#39;x&#39;</span>, <span class="st">&#39;y&#39;</span>])</a>
<a class="sourceLine" id="cb327-2" title="2">   x  y</a>
<a class="sourceLine" id="cb327-3" title="3">a  <span class="dv">1</span>  <span class="dv">2</span></a>
<a class="sourceLine" id="cb327-4" title="4">b  <span class="dv">3</span>  <span class="dv">4</span></a></code></pre></div>
<pre class="text"><code>+-------------+-------------+-------------+---------------+
|             |    &#39;sum&#39;    |   [&#39;sum&#39;]   | {&#39;x&#39;: &#39;sum&#39;}  |
+-------------+-------------+-------------+---------------+
| df.apply(…) |             |       x  y  |               |
| df.agg(…)   |     x  4    |  sum  4  6  |     x  4      |
|             |     y  6    |             |               |
+-------------+-------------+-------------+---------------+</code></pre>
<pre class="text"><code>+-------------+-------------+-------------+---------------+
|             |    &#39;rank&#39;   |   [&#39;rank&#39;]  | {&#39;x&#39;: &#39;rank&#39;} |
+-------------+-------------+-------------+---------------+
| df.apply(…) |      x  y   |      x    y |        x      |
| df.agg(…)   |   a  1  1   |   rank rank |     a  1      |
| df.trans(…) |   b  2  2   | a    1    1 |     b  2      |
|             |             | b    2    2 |               |
+-------------+-------------+-------------+---------------+</code></pre>
<ul>
<li><strong>Use <code>'&lt;DF&gt;[col_key_1, col_key_2][row_key]'</code> to get the fifth result’s values.</strong></li>
</ul>
<h4 id="encode-decode">Encode, Decode:</h4>
<div class="sourceCode" id="cb330"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb330-1" title="1"><span class="op">&lt;</span>DF<span class="op">&gt;</span> <span class="op">=</span> pd.read_json<span class="op">/</span>html(<span class="st">&#39;&lt;str/path/url&gt;&#39;</span>)</a>
<a class="sourceLine" id="cb330-2" title="2"><span class="op">&lt;</span>DF<span class="op">&gt;</span> <span class="op">=</span> pd.read_csv<span class="op">/</span>pickle<span class="op">/</span>excel(<span class="st">&#39;&lt;path/url&gt;&#39;</span>)</a>
<a class="sourceLine" id="cb330-3" title="3"><span class="op">&lt;</span>DF<span class="op">&gt;</span> <span class="op">=</span> pd.read_sql(<span class="st">&#39;&lt;query&gt;&#39;</span>, <span class="op">&lt;</span>connection<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb330-4" title="4"><span class="op">&lt;</span>DF<span class="op">&gt;</span> <span class="op">=</span> pd.read_clipboard()</a></code></pre></div>
<div class="sourceCode" id="cb331"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb331-1" title="1"><span class="op">&lt;</span><span class="bu">dict</span><span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span>.to_dict([<span class="st">&#39;d/l/s/sp/r/i&#39;</span>])</a>
<a class="sourceLine" id="cb331-2" title="2"><span class="op">&lt;</span><span class="bu">str</span><span class="op">&gt;</span>  <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span>.to_json<span class="op">/</span>html<span class="op">/</span>csv<span class="op">/</span>markdown<span class="op">/</span>latex([<span class="op">&lt;</span>path<span class="op">&gt;</span>])</a>
<a class="sourceLine" id="cb331-3" title="3"><span class="op">&lt;</span>DF<span class="op">&gt;</span>.to_pickle<span class="op">/</span>excel(<span class="op">&lt;</span>path<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb331-4" title="4"><span class="op">&lt;</span>DF<span class="op">&gt;</span>.to_sql(<span class="st">&#39;&lt;table_name&gt;&#39;</span>, <span class="op">&lt;</span>connection<span class="op">&gt;</span>)</a></code></pre></div>
<h3 id="groupby">GroupBy</h3>
<p><strong>Object that groups together rows of a dataframe based on the value of the passed column.</strong></p>
<div class="sourceCode" id="cb332"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb332-1" title="1"><span class="op">&gt;&gt;&gt;</span> df <span class="op">=</span> DataFrame([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>]], index<span class="op">=</span><span class="bu">list</span>(<span class="st">&#39;abc&#39;</span>), columns<span class="op">=</span><span class="bu">list</span>(<span class="st">&#39;xyz&#39;</span>))</a>
<a class="sourceLine" id="cb332-2" title="2"><span class="op">&gt;&gt;&gt;</span> df.groupby(<span class="st">&#39;z&#39;</span>).get_group(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb332-3" title="3">   x  y</a>
<a class="sourceLine" id="cb332-4" title="4">a  <span class="dv">1</span>  <span class="dv">2</span></a>
<a class="sourceLine" id="cb332-5" title="5"><span class="op">&gt;&gt;&gt;</span> df.groupby(<span class="st">&#39;z&#39;</span>).get_group(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb332-6" title="6">   x  y</a>
<a class="sourceLine" id="cb332-7" title="7">b  <span class="dv">4</span>  <span class="dv">5</span></a>
<a class="sourceLine" id="cb332-8" title="8">c  <span class="dv">7</span>  <span class="dv">8</span></a></code></pre></div>
<div class="sourceCode" id="cb333"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb333-1" title="1"><span class="op">&lt;</span>GB<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>DF<span class="op">&gt;</span>.groupby(column_key<span class="op">/</span>s)             <span class="co"># DF is split into groups based on passed column.</span></a>
<a class="sourceLine" id="cb333-2" title="2"><span class="op">&lt;</span>DF<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>GB<span class="op">&gt;</span>.get_group(group_key)              <span class="co"># Selects a group by value of grouping column.</span></a></code></pre></div>
<h4 id="aggregate-transform-map-2">Aggregate, Transform, Map:</h4>
<div class="sourceCode" id="cb334"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb334-1" title="1"><span class="op">&lt;</span>DF<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>GB<span class="op">&gt;</span>.<span class="bu">sum</span><span class="op">/</span><span class="bu">max</span><span class="op">/</span>mean<span class="op">/</span>idxmax<span class="op">/</span><span class="bu">all</span>()         <span class="co"># Or: &lt;GB&gt;.apply/agg(&lt;agg_func&gt;)</span></a>
<a class="sourceLine" id="cb334-2" title="2"><span class="op">&lt;</span>DF<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>GB<span class="op">&gt;</span>.rank<span class="op">/</span>diff<span class="op">/</span>cumsum<span class="op">/</span>ffill()          <span class="co"># Or: &lt;GB&gt;.aggregate(&lt;trans_func&gt;)  </span></a>
<a class="sourceLine" id="cb334-3" title="3"><span class="op">&lt;</span>DF<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>GB<span class="op">&gt;</span>.fillna(<span class="op">&lt;</span>el<span class="op">&gt;</span>)                      <span class="co"># Or: &lt;GB&gt;.transform(&lt;map_func&gt;)</span></a></code></pre></div>
<div class="sourceCode" id="cb335"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb335-1" title="1"><span class="op">&gt;&gt;&gt;</span> gb <span class="op">=</span> df.groupby(<span class="st">&#39;z&#39;</span>)</a>
<a class="sourceLine" id="cb335-2" title="2">      x  y  z</a>
<a class="sourceLine" id="cb335-3" title="3"><span class="dv">3</span>: a  <span class="dv">1</span>  <span class="dv">2</span>  <span class="dv">3</span></a>
<a class="sourceLine" id="cb335-4" title="4"><span class="dv">6</span>: b  <span class="dv">4</span>  <span class="dv">5</span>  <span class="dv">6</span></a>
<a class="sourceLine" id="cb335-5" title="5">   c  <span class="dv">7</span>  <span class="dv">8</span>  <span class="dv">6</span></a></code></pre></div>
<pre class="text"><code>+-------------+-------------+-------------+-------------+---------------+
|             |    &#39;sum&#39;    |    &#39;rank&#39;   |   [&#39;rank&#39;]  | {&#39;x&#39;: &#39;rank&#39;} |
+-------------+-------------+-------------+-------------+---------------+
| gb.agg(…)   |      x   y  |      x  y   |      x    y |        x      |
|             |  z          |   a  1  1   |   rank rank |     a  1      |
|             |  3   1   2  |   b  1  1   | a    1    1 |     b  1      |
|             |  6  11  13  |   c  2  2   | b    1    1 |     c  2      |
|             |             |             | c    2    2 |               |
+-------------+-------------+-------------+-------------+---------------+
| gb.trans(…) |      x   y  |      x  y   |             |               |
|             |  a   1   2  |   a  1  1   |             |               |
|             |  b  11  13  |   b  1  1   |             |               |
|             |  c  11  13  |   c  1  1   |             |               |
+-------------+-------------+-------------+-------------+---------------+</code></pre>
<h3 id="rolling">Rolling</h3>
<p><strong>Object for rolling window calculations.</strong></p>
<div class="sourceCode" id="cb337"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb337-1" title="1"><span class="op">&lt;</span>R_Sr<span class="op">/</span>R_DF<span class="op">/</span>R_GB<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>Sr<span class="op">/</span>DF<span class="op">/</span>GB<span class="op">&gt;</span>.rolling(window_size)  <span class="co"># Also: `min_periods=None, center=False`.</span></a>
<a class="sourceLine" id="cb337-2" title="2"><span class="op">&lt;</span>R_Sr<span class="op">/</span>R_DF<span class="op">&gt;</span>      <span class="op">=</span> <span class="op">&lt;</span>R_DF<span class="op">/</span>R_GB<span class="op">&gt;</span>[column_key<span class="op">/</span>s]        <span class="co"># Or: &lt;R&gt;.column_key</span></a>
<a class="sourceLine" id="cb337-3" title="3"><span class="op">&lt;</span>Sr<span class="op">/</span>DF<span class="op">/</span>DF<span class="op">&gt;</span>       <span class="op">=</span> <span class="op">&lt;</span>R_Sr<span class="op">/</span>R_DF<span class="op">/</span>R_GB<span class="op">&gt;</span>.<span class="bu">sum</span><span class="op">/</span><span class="bu">max</span><span class="op">/</span>mean()  <span class="co"># Or: &lt;R&gt;.apply/agg(&lt;agg_func/str&gt;)</span></a></code></pre></div>
<h2 id="plotly">Plotly</h2>
<h3 id="covid-deaths-by-continent">Covid Deaths by Continent</h3>
<img src="web/covid_deaths.png" alt="Covid Deaths" />
<div id="2a950764-39fc-416d-97fe-0a6226a3095f" class="plotly-graph-div" style="height:400px; width:100%;">

</div>
<div class="sourceCode" id="cb338"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb338-1" title="1"><span class="co"># $ pip3 install pandas plotly</span></a>
<a class="sourceLine" id="cb338-2" title="2"><span class="im">import</span> pandas <span class="im">as</span> pd</a>
<a class="sourceLine" id="cb338-3" title="3"><span class="im">import</span> plotly.express</a>
<a class="sourceLine" id="cb338-4" title="4"></a>
<a class="sourceLine" id="cb338-5" title="5">covid <span class="op">=</span> pd.read_csv(<span class="st">&#39;https://covid.ourworldindata.org/data/owid-covid-data.csv&#39;</span>, </a>
<a class="sourceLine" id="cb338-6" title="6">                    usecols<span class="op">=</span>[<span class="st">&#39;iso_code&#39;</span>, <span class="st">&#39;date&#39;</span>, <span class="st">&#39;total_deaths&#39;</span>, <span class="st">&#39;population&#39;</span>])</a>
<a class="sourceLine" id="cb338-7" title="7">continents <span class="op">=</span> pd.read_csv(<span class="st">&#39;https://datahub.io/JohnSnowLabs/country-and-continent-codes-&#39;</span> <span class="op">+</span> <span class="op">\</span></a>
<a class="sourceLine" id="cb338-8" title="8">                         <span class="st">&#39;list/r/country-and-continent-codes-list-csv.csv&#39;</span>,</a>
<a class="sourceLine" id="cb338-9" title="9">                         usecols<span class="op">=</span>[<span class="st">&#39;Three_Letter_Country_Code&#39;</span>, <span class="st">&#39;Continent_Name&#39;</span>])</a>
<a class="sourceLine" id="cb338-10" title="10">df <span class="op">=</span> pd.merge(covid, continents, left_on<span class="op">=</span><span class="st">&#39;iso_code&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;Three_Letter_Country_Code&#39;</span>)</a>
<a class="sourceLine" id="cb338-11" title="11">df <span class="op">=</span> df.groupby([<span class="st">&#39;Continent_Name&#39;</span>, <span class="st">&#39;date&#39;</span>]).<span class="bu">sum</span>().reset_index()</a>
<a class="sourceLine" id="cb338-12" title="12">df[<span class="st">&#39;Total Deaths per Million&#39;</span>] <span class="op">=</span> df.total_deaths <span class="op">*</span> <span class="fl">1e6</span> <span class="op">/</span> df.population</a>
<a class="sourceLine" id="cb338-13" title="13">df <span class="op">=</span> df[(<span class="st">&#39;2020-03-14&#39;</span> <span class="op">&lt;</span> df.date) <span class="op">&amp;</span> (df.date <span class="op">&lt;</span> <span class="st">&#39;2020-06-25&#39;</span>)]</a>
<a class="sourceLine" id="cb338-14" title="14">df <span class="op">=</span> df.rename({<span class="st">&#39;date&#39;</span>: <span class="st">&#39;Date&#39;</span>, <span class="st">&#39;Continent_Name&#39;</span>: <span class="st">&#39;Continent&#39;</span>}, axis<span class="op">=</span><span class="st">&#39;columns&#39;</span>)</a>
<a class="sourceLine" id="cb338-15" title="15">plotly.express.line(df, x<span class="op">=</span><span class="st">&#39;Date&#39;</span>, y<span class="op">=</span><span class="st">&#39;Total Deaths per Million&#39;</span>, color<span class="op">=</span><span class="st">&#39;Continent&#39;</span>).show()</a></code></pre></div>
<h3 id="confirmed-covid-cases-dow-jones-gold-and-bitcoin-price">Confirmed Covid Cases, Dow Jones, Gold, and Bitcoin Price</h3>
<img src="web/covid_cases.png" alt="Covid Cases" />
<div id="e23ccacc-a456-478b-b467-7282a2165921" class="plotly-graph-div" style="height:400px; width:100%;">

</div>
<div class="sourceCode" id="cb339"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb339-1" title="1"><span class="co"># $ pip3 install pandas plotly</span></a>
<a class="sourceLine" id="cb339-2" title="2"><span class="im">import</span> pandas <span class="im">as</span> pd</a>
<a class="sourceLine" id="cb339-3" title="3"><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</a>
<a class="sourceLine" id="cb339-4" title="4"><span class="im">import</span> datetime</a>
<a class="sourceLine" id="cb339-5" title="5"></a>
<a class="sourceLine" id="cb339-6" title="6"><span class="kw">def</span> main():</a>
<a class="sourceLine" id="cb339-7" title="7">    data <span class="op">=</span> scrape_data()</a>
<a class="sourceLine" id="cb339-8" title="8">    df <span class="op">=</span> wrangle_data(<span class="op">*</span>data)</a>
<a class="sourceLine" id="cb339-9" title="9">    display_data(df)</a>
<a class="sourceLine" id="cb339-10" title="10"></a>
<a class="sourceLine" id="cb339-11" title="11"><span class="kw">def</span> scrape_data():</a>
<a class="sourceLine" id="cb339-12" title="12">    <span class="kw">def</span> scrape_yahoo(id_):</a>
<a class="sourceLine" id="cb339-13" title="13">        BASE_URL <span class="op">=</span> <span class="st">&#39;https://query1.finance.yahoo.com/v7/finance/download/&#39;</span></a>
<a class="sourceLine" id="cb339-14" title="14">        now <span class="op">=</span> <span class="bu">int</span>(datetime.datetime.now().timestamp())</a>
<a class="sourceLine" id="cb339-15" title="15">        url <span class="op">=</span> <span class="ss">f&#39;</span><span class="sc">{</span>BASE_URL<span class="sc">}{</span>id_<span class="sc">}</span><span class="ss">?period1=1579651200&amp;period2=</span><span class="sc">{</span>now<span class="sc">}</span><span class="ss">&amp;interval=1d&amp;events=history&#39;</span></a>
<a class="sourceLine" id="cb339-16" title="16">        <span class="cf">return</span> pd.read_csv(url, usecols<span class="op">=</span>[<span class="st">&#39;Date&#39;</span>, <span class="st">&#39;Close&#39;</span>]).set_index(<span class="st">&#39;Date&#39;</span>).Close</a>
<a class="sourceLine" id="cb339-17" title="17">    covid <span class="op">=</span> pd.read_csv(<span class="st">&#39;https://covid.ourworldindata.org/data/owid-covid-data.csv&#39;</span>,</a>
<a class="sourceLine" id="cb339-18" title="18">                        usecols<span class="op">=</span>[<span class="st">&#39;date&#39;</span>, <span class="st">&#39;total_cases&#39;</span>])</a>
<a class="sourceLine" id="cb339-19" title="19">    covid <span class="op">=</span> covid.groupby(<span class="st">&#39;date&#39;</span>).<span class="bu">sum</span>()</a>
<a class="sourceLine" id="cb339-20" title="20">    dow, gold, bitcoin <span class="op">=</span> [scrape_yahoo(id_) <span class="cf">for</span> id_ <span class="kw">in</span> (<span class="st">&#39;^DJI&#39;</span>, <span class="st">&#39;GC=F&#39;</span>, <span class="st">&#39;BTC-USD&#39;</span>)]</a>
<a class="sourceLine" id="cb339-21" title="21">    dow.name, gold.name, bitcoin.name <span class="op">=</span> <span class="st">&#39;Dow Jones&#39;</span>, <span class="st">&#39;Gold&#39;</span>, <span class="st">&#39;Bitcoin&#39;</span></a>
<a class="sourceLine" id="cb339-22" title="22">    <span class="cf">return</span> covid, dow, gold, bitcoin</a>
<a class="sourceLine" id="cb339-23" title="23"></a>
<a class="sourceLine" id="cb339-24" title="24"><span class="kw">def</span> wrangle_data(covid, dow, gold, bitcoin):</a>
<a class="sourceLine" id="cb339-25" title="25">    df <span class="op">=</span> pd.concat([dow, gold, bitcoin], axis<span class="op">=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb339-26" title="26">    df <span class="op">=</span> df.sort_index().interpolate()</a>
<a class="sourceLine" id="cb339-27" title="27">    df <span class="op">=</span> df.rolling(<span class="dv">10</span>, min_periods<span class="op">=</span><span class="dv">1</span>, center<span class="op">=</span><span class="va">True</span>).mean()</a>
<a class="sourceLine" id="cb339-28" title="28">    df <span class="op">=</span> df.loc[<span class="st">&#39;2020-02-23&#39;</span>:].iloc[:<span class="op">-</span><span class="dv">2</span>]</a>
<a class="sourceLine" id="cb339-29" title="29">    df <span class="op">=</span> (df <span class="op">/</span> df.iloc[<span class="dv">0</span>]) <span class="op">*</span> <span class="dv">100</span></a>
<a class="sourceLine" id="cb339-30" title="30">    <span class="cf">return</span> pd.concat([covid, df], axis<span class="op">=</span><span class="dv">1</span>, join<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</a>
<a class="sourceLine" id="cb339-31" title="31"></a>
<a class="sourceLine" id="cb339-32" title="32"><span class="kw">def</span> display_data(df):</a>
<a class="sourceLine" id="cb339-33" title="33">    <span class="kw">def</span> get_trace(col_name):</a>
<a class="sourceLine" id="cb339-34" title="34">        <span class="cf">return</span> go.Scatter(x<span class="op">=</span>df.index, y<span class="op">=</span>df[col_name], name<span class="op">=</span>col_name, yaxis<span class="op">=</span><span class="st">&#39;y2&#39;</span>)</a>
<a class="sourceLine" id="cb339-35" title="35">    traces <span class="op">=</span> [get_trace(col_name) <span class="cf">for</span> col_name <span class="kw">in</span> df.columns[<span class="dv">1</span>:]]</a>
<a class="sourceLine" id="cb339-36" title="36">    traces.append(go.Scatter(x<span class="op">=</span>df.index, y<span class="op">=</span>df.total_cases, name<span class="op">=</span><span class="st">&#39;Total Cases&#39;</span>, yaxis<span class="op">=</span><span class="st">&#39;y1&#39;</span>))</a>
<a class="sourceLine" id="cb339-37" title="37">    figure <span class="op">=</span> go.Figure()</a>
<a class="sourceLine" id="cb339-38" title="38">    figure.add_traces(traces)</a>
<a class="sourceLine" id="cb339-39" title="39">    figure.update_layout(</a>
<a class="sourceLine" id="cb339-40" title="40">        yaxis1<span class="op">=</span><span class="bu">dict</span>(title<span class="op">=</span><span class="st">&#39;Total Cases&#39;</span>, rangemode<span class="op">=</span><span class="st">&#39;tozero&#39;</span>),</a>
<a class="sourceLine" id="cb339-41" title="41">        yaxis2<span class="op">=</span><span class="bu">dict</span>(title<span class="op">=</span><span class="st">&#39;%&#39;</span>, rangemode<span class="op">=</span><span class="st">&#39;tozero&#39;</span>, overlaying<span class="op">=</span><span class="st">&#39;y&#39;</span>, side<span class="op">=</span><span class="st">&#39;right&#39;</span>),</a>
<a class="sourceLine" id="cb339-42" title="42">        legend<span class="op">=</span><span class="bu">dict</span>(x<span class="op">=</span><span class="fl">1.1</span>)</a>
<a class="sourceLine" id="cb339-43" title="43">    ).show()</a>
<a class="sourceLine" id="cb339-44" title="44"></a>
<a class="sourceLine" id="cb339-45" title="45"><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</a>
<a class="sourceLine" id="cb339-46" title="46">    main()</a></code></pre></div>
<h2 id="cython">Cython</h2>
<p><strong>Library that compiles Python code into C.</strong></p>
<div class="sourceCode" id="cb340"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb340-1" title="1"><span class="co"># $ pip3 install cython</span></a>
<a class="sourceLine" id="cb340-2" title="2"><span class="im">import</span> pyximport<span class="op">;</span> pyximport.install()</a>
<a class="sourceLine" id="cb340-3" title="3"><span class="im">import</span> <span class="op">&lt;</span>cython_script<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb340-4" title="4"><span class="op">&lt;</span>cython_script<span class="op">&gt;</span>.main()</a></code></pre></div>
<h3 id="definitions">Definitions</h3>
<ul>
<li><strong>All <code>'cdef'</code> definitions are optional, but they contribute to the speed-up.</strong></li>
<li><strong>Script needs to be saved with a <code>'pyx'</code> extension.</strong></li>
</ul>
<div class="sourceCode" id="cb341"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb341-1" title="1">cdef <span class="op">&lt;</span><span class="bu">type</span><span class="op">&gt;</span> <span class="op">&lt;</span>var_name<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>el<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb341-2" title="2">cdef <span class="op">&lt;</span><span class="bu">type</span><span class="op">&gt;</span>[n_elements] <span class="op">&lt;</span>var_name<span class="op">&gt;</span> <span class="op">=</span> [<span class="op">&lt;</span>el_1<span class="op">&gt;</span>, <span class="op">&lt;</span>el_2<span class="op">&gt;</span>, ...]</a>
<a class="sourceLine" id="cb341-3" title="3">cdef <span class="op">&lt;</span><span class="bu">type</span><span class="op">/</span>void<span class="op">&gt;</span> <span class="op">&lt;</span>func_name<span class="op">&gt;</span>(<span class="op">&lt;</span><span class="bu">type</span><span class="op">&gt;</span> <span class="op">&lt;</span>arg_name_1<span class="op">&gt;</span>, ...):</a></code></pre></div>
<div class="sourceCode" id="cb342"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb342-1" title="1">cdef <span class="kw">class</span> <span class="op">&lt;</span>class_name<span class="op">&gt;</span>:</a>
<a class="sourceLine" id="cb342-2" title="2">    cdef public <span class="op">&lt;</span><span class="bu">type</span><span class="op">&gt;</span> <span class="op">&lt;</span>attr_name<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb342-3" title="3">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="op">&lt;</span><span class="bu">type</span><span class="op">&gt;</span> <span class="op">&lt;</span>arg_name<span class="op">&gt;</span>):</a>
<a class="sourceLine" id="cb342-4" title="4">        <span class="va">self</span>.<span class="op">&lt;</span>attr_name<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>arg_name<span class="op">&gt;</span></a></code></pre></div>
<div class="sourceCode" id="cb343"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb343-1" title="1">cdef enum <span class="op">&lt;</span>enum_name<span class="op">&gt;</span>: <span class="op">&lt;</span>member_name_1<span class="op">&gt;</span>, <span class="op">&lt;</span>member_name_2<span class="op">&gt;</span>, ...</a></code></pre></div>
<h2 id="appendix">Appendix</h2>
<h3 id="pyinstaller">PyInstaller</h3>
<div class="sourceCode" id="cb344"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb344-1" title="1">$ <span class="ex">pip3</span> install pyinstaller</a>
<a class="sourceLine" id="cb344-2" title="2">$ <span class="ex">pyinstaller</span> script.py                        <span class="co"># Compiles into &#39;./dist/script&#39; directory.</span></a>
<a class="sourceLine" id="cb344-3" title="3">$ <span class="ex">pyinstaller</span> script.py --onefile              <span class="co"># Compiles into &#39;./dist/script&#39; console app.</span></a>
<a class="sourceLine" id="cb344-4" title="4">$ <span class="ex">pyinstaller</span> script.py --windowed             <span class="co"># Compiles into &#39;./dist/script&#39; windowed app.</span></a>
<a class="sourceLine" id="cb344-5" title="5">$ <span class="ex">pyinstaller</span> script.py --add-data <span class="st">&#39;&lt;path&gt;:.&#39;</span>  <span class="co"># Adds file to the root of the executable.</span></a></code></pre></div>
<ul>
<li><strong>File paths need to be updated to <code>'os.path.join(sys._MEIPASS, &lt;path&gt;)'</code>.</strong></li>
</ul>
<h3 id="basic-script-template">Basic Script Template</h3>
<div class="sourceCode" id="cb345"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb345-1" title="1"><span class="co">#!/usr/bin/env python3</span></a>
<a class="sourceLine" id="cb345-2" title="2"><span class="co">#</span></a>
<a class="sourceLine" id="cb345-3" title="3"><span class="co"># Usage: .py</span></a>
<a class="sourceLine" id="cb345-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb345-5" title="5"></a>
<a class="sourceLine" id="cb345-6" title="6"><span class="im">from</span> collections <span class="im">import</span> namedtuple</a>
<a class="sourceLine" id="cb345-7" title="7"><span class="im">from</span> dataclasses <span class="im">import</span> make_dataclass</a>
<a class="sourceLine" id="cb345-8" title="8"><span class="im">from</span> enum <span class="im">import</span> Enum</a>
<a class="sourceLine" id="cb345-9" title="9"><span class="im">from</span> sys <span class="im">import</span> argv, exit</a>
<a class="sourceLine" id="cb345-10" title="10"><span class="im">import</span> re</a>
<a class="sourceLine" id="cb345-11" title="11"></a>
<a class="sourceLine" id="cb345-12" title="12"></a>
<a class="sourceLine" id="cb345-13" title="13"><span class="kw">def</span> main():</a>
<a class="sourceLine" id="cb345-14" title="14">    <span class="cf">pass</span></a>
<a class="sourceLine" id="cb345-15" title="15"></a>
<a class="sourceLine" id="cb345-16" title="16"></a>
<a class="sourceLine" id="cb345-17" title="17"><span class="co">###</span></a>
<a class="sourceLine" id="cb345-18" title="18"><span class="co">##  UTIL</span></a>
<a class="sourceLine" id="cb345-19" title="19"><span class="co">#</span></a>
<a class="sourceLine" id="cb345-20" title="20"></a>
<a class="sourceLine" id="cb345-21" title="21"><span class="kw">def</span> read_file(filename):</a>
<a class="sourceLine" id="cb345-22" title="22">    <span class="cf">with</span> <span class="bu">open</span>(filename, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</a>
<a class="sourceLine" id="cb345-23" title="23">        <span class="cf">return</span> <span class="bu">file</span>.readlines()</a>
<a class="sourceLine" id="cb345-24" title="24"></a>
<a class="sourceLine" id="cb345-25" title="25"></a>
<a class="sourceLine" id="cb345-26" title="26"><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</a>
<a class="sourceLine" id="cb345-27" title="27">    main()</a></code></pre></div>
</body>
</html>
