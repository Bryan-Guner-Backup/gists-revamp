traversing a directed acyclic dependency graph to sort and group
